<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bewerbungsmanager - Dashboard</title>
    <meta name="description" content="Ihr pers√∂nliches Bewerbungs-Dashboard. KI-Anschreiben in 60 Sekunden, Lebenslauf-Editor, Tracking und Interview-Vorbereitung.">
    
    <!-- CSS -->
    <link rel="stylesheet" href="../styles.css">
    <link rel="stylesheet" href="css/applications-main.css">
    <link rel="stylesheet" href="css/dashboard.css?v=glass20260111">
    <link rel="stylesheet" href="css/landing.css?v=20260110">
    
    <!-- Critical Mobile Navbar Override - Wie Hauptseite -->
    <style>
        /* Mobile: Nur Hamburger sichtbar, kein wei√üer Balken */
        @media (max-width: 768px) {
            /* Navbar transparent auf Mobile */
            .navbar {
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                right: 0 !important;
                background: transparent !important;
                border: none !important;
                box-shadow: none !important;
                z-index: 1000 !important;
                pointer-events: none !important;
            }
            
            /* Desktop Nav verstecken */
            .navbar .desktop-nav {
                display: none !important;
            }
            
            /* Hamburger rechts mit Milchglas-Kreis wie Hauptseite */
            .navbar .mobile-hamburger {
                display: flex !important;
                position: fixed !important;
                top: 16px !important;
                right: 16px !important;
                width: 48px !important;
                height: 48px !important;
                border-radius: 50% !important;
                background: rgba(255, 255, 255, 0.95) !important;
                backdrop-filter: blur(10px) !important;
                -webkit-backdrop-filter: blur(10px) !important;
                border: 1px solid rgba(255, 255, 255, 0.5) !important;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
                z-index: 10000 !important;
                cursor: pointer !important;
                pointer-events: auto !important;
                flex-direction: column !important;
                justify-content: center !important;
                align-items: center !important;
                gap: 5px !important;
            }
            
            .navbar .mobile-hamburger span {
                width: 22px !important;
                height: 2px !important;
                background: #1e3a8a !important;
                border-radius: 2px !important;
                transition: all 0.3s ease !important;
            }
            
            /* Mobile Fullscreen Menu */
            .mobile-menu-fullscreen {
                position: fixed !important;
                top: 0 !important;
                left: -100% !important;
                width: 100% !important;
                height: 100vh !important;
                background: linear-gradient(135deg, #1e3a8a 0%, #3730a3 50%, #7c3aed 100%) !important;
                z-index: 9999 !important;
                transition: left 0.3s ease !important;
                display: flex !important;
                flex-direction: column !important;
                justify-content: center !important;
                align-items: center !important;
                visibility: visible !important;
            }
            
            .mobile-menu-fullscreen.active {
                left: 0 !important;
            }
            
            /* Hamburger verstecken wenn Men√º aktiv */
            .mobile-hamburger.active {
                display: none !important;
                visibility: hidden !important;
                opacity: 0 !important;
            }
            
            /* Close Button f√ºr Mobile Menu */
            .mobile-menu-close {
                position: absolute !important;
                top: 20px !important;
                right: 20px !important;
                width: 48px !important;
                height: 48px !important;
                border-radius: 50% !important;
                background: rgba(255, 255, 255, 0.2) !important;
                border: none !important;
                color: white !important;
                font-size: 24px !important;
                cursor: pointer !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                transition: all 0.3s ease !important;
            }
            
            .mobile-menu-close:hover {
                background: rgba(255, 255, 255, 0.3) !important;
                transform: scale(1.1) !important;
            }
            
            .mobile-menu-overlay {
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                background: rgba(0, 0, 0, 0.5) !important;
                opacity: 0 !important;
                visibility: hidden !important;
                z-index: 9998 !important;
                transition: opacity 0.3s ease, visibility 0.3s ease !important;
            }
            
            .mobile-menu-overlay.active {
                opacity: 1 !important;
                visibility: visible !important;
            }
            
            /* Mobile Menu Content */
            .mobile-menu-content {
                display: flex !important;
                flex-direction: column !important;
                align-items: center !important;
                gap: 16px !important;
                width: 85% !important;
                max-width: 320px !important;
                padding: 0 20px !important;
            }
            
            .mobile-menu-link {
                color: white !important;
                font-size: 1.25rem !important;
                font-weight: 600 !important;
                text-decoration: none !important;
                padding: 18px 28px !important;
                border-radius: 16px !important;
                transition: all 0.3s ease !important;
                background: rgba(255, 255, 255, 0.12) !important;
                backdrop-filter: blur(10px) !important;
                -webkit-backdrop-filter: blur(10px) !important;
                border: 1px solid rgba(255, 255, 255, 0.2) !important;
                width: 100% !important;
                text-align: center !important;
                box-sizing: border-box !important;
                /* Mehrzeilig erlauben */
                white-space: normal !important;
                line-height: 1.3 !important;
                word-wrap: break-word !important;
                hyphens: auto !important;
            }
            
            .mobile-menu-link:hover,
            .mobile-menu-link.active {
                background: rgba(255, 255, 255, 0.25) !important;
                transform: scale(1.02) !important;
            }
            
            /* Profil bearbeiten Link - Spezielle Hervorhebung */
            .mobile-profile-link {
                background: linear-gradient(135deg, rgba(16, 185, 129, 0.3), rgba(5, 150, 105, 0.2)) !important;
                border: 1px solid rgba(16, 185, 129, 0.4) !important;
            }
            
            .mobile-profile-link:hover {
                background: linear-gradient(135deg, rgba(16, 185, 129, 0.5), rgba(5, 150, 105, 0.3)) !important;
            }
            
            .mobile-profile-link i {
                margin-right: 8px !important;
            }
            
            .mobile-auth-btn {
                margin-top: 20px !important;
                padding: 14px 28px !important;
                background: rgba(255, 255, 255, 0.2) !important;
                border: 2px solid white !important;
                border-radius: 12px !important;
                color: white !important;
                font-size: 1.1rem !important;
                font-weight: 600 !important;
                cursor: pointer !important;
                display: flex !important;
                align-items: center !important;
                gap: 10px !important;
            }
            
            .mobile-language-switcher {
                display: flex !important;
                gap: 12px !important;
                margin-top: 10px !important;
            }
            
            .mobile-language-switcher button {
                font-size: 1.5rem !important;
                background: transparent !important;
                border: none !important;
                cursor: pointer !important;
            }
        }
    </style>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation - Wie auf Hauptseite: Nur Hamburger auf Mobile, transparent -->
    <nav class="navbar">
        <!-- Mobile: Nur Hamburger-Icon (rechts positioniert wie Hauptseite) -->
        <button class="mobile-hamburger" id="mobileHamburger" aria-label="Men√º √∂ffnen">
            <span></span>
            <span></span>
            <span></span>
        </button>
        
        <!-- Desktop Navigation -->
        <div class="desktop-nav">
            <div class="nav-container">
                <div class="nav-menu" id="navMenu">
                    <a href="../index.html" class="nav-link">Start</a>
                    <a href="../persoenlichkeitsentwicklung-uebersicht.html" class="nav-link">Pers√∂nlichkeitsentwicklung</a>
                    <a href="index.html" class="nav-link">Bewerbungsmanager</a>
                    <a href="coaching.html" class="nav-link">Coaching</a>
                    <div class="nav-divider"></div>
                    <button class="lang-link-compact" data-lang="de" title="Deutsch">üá©üá™</button>
                    <button class="lang-link-compact" data-lang="en" title="English">üá¨üáß</button>
                    <div class="auth-container">
                        <button id="authButton" class="nav-login-btn">
                            <i class="fas fa-user"></i>
                            <span id="authButtonText">Anmelden</span>
                        </button>
                        <!-- User Dropdown -->
                        <div id="userDropdown" class="user-dropdown" style="display: none;">
                            <div class="dropdown-header">
                                <img id="userAvatarImg" src="../images/default-avatar.png" alt="Avatar" class="dropdown-avatar">
                                <div class="dropdown-user-info">
                                    <span id="userName" class="dropdown-name">Benutzer</span>
                                    <span id="userEmail" class="dropdown-email">email@example.com</span>
                                </div>
                            </div>
                            <div class="dropdown-divider"></div>
                            <a href="../user-profile.html" class="dropdown-item">
                                <i class="fas fa-user-edit"></i>
                                Profil bearbeiten
                            </a>
                            <a href="../user-profile.html#settings" class="dropdown-item">
                                <i class="fas fa-cog"></i>
                                Einstellungen
                            </a>
                            <div class="dropdown-divider"></div>
                            <button onclick="logout()" class="dropdown-item dropdown-logout">
                                <i class="fas fa-sign-out-alt"></i>
                                Abmelden
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Mobile Fullscreen Menu -->
        <div class="mobile-menu-overlay" id="mobileMenuOverlay"></div>
        <div class="mobile-menu-fullscreen" id="mobileMenuFullscreen">
            <!-- Close Button -->
            <button class="mobile-menu-close" id="mobileMenuClose" aria-label="Men√º schlie√üen">
                <i class="fas fa-times"></i>
            </button>
            <div class="mobile-menu-content">
                <a href="../index.html" class="mobile-menu-link">Start</a>
                <a href="../persoenlichkeitsentwicklung-uebersicht.html" class="mobile-menu-link">Pers√∂nlichkeits-<br>entwicklung</a>
                <a href="index.html" class="mobile-menu-link active">Bewerbungs-<br>manager</a>
                <a href="coaching.html" class="mobile-menu-link">Coaching</a>
                <!-- Profil bearbeiten - Nur sichtbar wenn eingeloggt -->
                <a href="../user-profile.html?source=dashboard#personal" class="mobile-menu-link mobile-profile-link" id="mobileProfileLink" style="display: none;">
                    <i class="fas fa-user-edit"></i> Profil<br>bearbeiten
                </a>
                <div class="mobile-language-switcher">
                    <button class="lang-link-compact" data-lang="de" title="Deutsch">üá©üá™</button>
                    <button class="lang-link-compact" data-lang="en" title="English">üá¨üáß</button>
                </div>
                <button id="mobileAuthButton" class="mobile-auth-btn">
                    <i class="fas fa-user"></i>
                    <span id="mobileAuthButtonText">Anmelden</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- MAIN DASHBOARD -->
    <main class="dashboard-main">
        <!-- Hero Stats Bar -->
        <div class="dashboard-stats-bar">
            <div class="stat-item">
                <i class="fas fa-paper-plane"></i>
                <div class="stat-content">
                    <span class="stat-number" id="statTotal">0</span>
                    <span class="stat-label">Bewerbungen</span>
                </div>
            </div>
            <div class="stat-item">
                <i class="fas fa-hourglass-half"></i>
                <div class="stat-content">
                    <span class="stat-number" id="statPending">0</span>
                    <span class="stat-label">Offen</span>
                </div>
            </div>
            <div class="stat-item">
                <i class="fas fa-comments"></i>
                <div class="stat-content">
                    <span class="stat-number" id="statInterviews">0</span>
                    <span class="stat-label">Interviews</span>
                </div>
            </div>
            <div class="stat-item highlight">
                <i class="fas fa-trophy"></i>
                <div class="stat-content">
                    <span class="stat-number" id="statSuccess">0%</span>
                    <span class="stat-label">Erfolg</span>
                </div>
            </div>
        </div>

        <!-- Tab Navigation -->
        <div class="dashboard-tabs">
            <button class="tab-btn active" data-tab="quick" onclick="showTab('quick')">
                <i class="fas fa-bolt"></i>
                <span>Quick Apply</span>
                <span class="tab-badge new">NEU</span>
            </button>
            <button class="tab-btn" data-tab="cover" onclick="showTab('cover')">
                <i class="fas fa-file-alt"></i>
                <span>Anschreiben</span>
            </button>
            <button class="tab-btn" data-tab="resume" onclick="showTab('resume')">
                <i class="fas fa-id-card"></i>
                <span>Lebenslauf</span>
            </button>
            <button class="tab-btn" data-tab="tracking" onclick="showTab('tracking')">
                <i class="fas fa-tasks"></i>
                <span>Tracking</span>
            </button>
            <button class="tab-btn" data-tab="interview" onclick="showTab('interview')">
                <i class="fas fa-microphone"></i>
                <span>Interview</span>
            </button>
            <button class="tab-btn" data-tab="profile" onclick="showTab('profile')">
                <i class="fas fa-user-cog"></i>
                <span>Profil</span>
            </button>
        </div>

        <!-- Tab Content Container -->
        <div class="dashboard-content">
            
            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <!-- TAB 1: QUICK APPLY - Der Star des Dashboards -->
            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <div id="tab-quick" class="tab-content active">
                <div class="quick-apply-container">
                    <div class="quick-apply-hero">
                        <div class="hero-icon">
                            <i class="fas fa-magic"></i>
                        </div>
                        <h1>Bewerbung in <span class="highlight-text">60 Sekunden</span></h1>
                        <p>Stellenanzeige einf√ºgen ‚Üí KI generiert Anschreiben ‚Üí Fertig!</p>
                    </div>

                    <!-- Step 1: Job Input -->
                    <div class="quick-step" id="quickStep1">
                        <div class="step-header">
                            <span class="step-number">1</span>
                            <h2>Stellenanzeige einf√ºgen</h2>
                        </div>
                        
                        <div class="input-toggle">
                            <button class="toggle-btn active" data-input="url" onclick="toggleInputType('url')">
                                <i class="fas fa-link"></i> URL einf√ºgen
                            </button>
                            <button class="toggle-btn" data-input="text" onclick="toggleInputType('text')">
                                <i class="fas fa-paste"></i> Text einf√ºgen
                            </button>
                        </div>

                        <div class="input-area" id="inputUrl">
                            <div class="url-input-wrapper">
                                <i class="fas fa-globe"></i>
                                <input type="url" id="jobUrl" placeholder="https://www.stepstone.de/stellenangebote/..." 
                                       onpaste="handleUrlPaste(event)" onkeyup="handleUrlInput(event)">
                                <button class="btn-parse" id="parseUrlBtn" onclick="parseJobUrl()" disabled>
                                    <i class="fas fa-search"></i> Analysieren
                                </button>
                            </div>
                            <div class="url-hints">
                                <span><i class="fas fa-check"></i> StepStone</span>
                                <span><i class="fas fa-check"></i> Indeed</span>
                                <span><i class="fas fa-check"></i> LinkedIn</span>
                                <span><i class="fas fa-check"></i> XING</span>
                                <span><i class="fas fa-check"></i> Jede URL</span>
                            </div>
                        </div>

                        <div class="input-area hidden" id="inputText">
                            <textarea id="jobText" rows="8" 
                                      placeholder="Kopieren Sie hier die komplette Stellenanzeige ein...

Beispiel:
Senior Softwareentwickler (m/w/d)
Firma XYZ GmbH, M√ºnchen
Vollzeit | Ab sofort

Ihre Aufgaben:
- Entwicklung von...
- ..."
                                      oninput="handleTextInput()"></textarea>
                            <div class="char-counter">
                                <span id="charCount">0</span> Zeichen
                            </div>
                        </div>

                        <!-- Parsed Job Preview -->
                        <div class="parsed-job hidden" id="parsedJobPreview">
                            <div class="parsed-header">
                                <i class="fas fa-check-circle"></i>
                                <span>Stellenanzeige erkannt!</span>
                                <button class="btn-edit" onclick="editParsedJob()">
                                    <i class="fas fa-edit"></i> Bearbeiten
                                </button>
                            </div>
                            <div class="parsed-content">
                                <div class="parsed-field">
                                    <label>Position</label>
                                    <input type="text" id="parsedTitle" placeholder="Jobtitel">
                                </div>
                                <div class="parsed-field">
                                    <label>Unternehmen</label>
                                    <input type="text" id="parsedCompany" placeholder="Firmenname">
                                </div>
                                <div class="parsed-field">
                                    <label>Standort</label>
                                    <input type="text" id="parsedLocation" placeholder="Stadt">
                                </div>
                                <div class="parsed-field full-width">
                                    <label>Anforderungen (erkannt)</label>
                                    <div class="requirements-tags" id="parsedRequirements">
                                        <!-- Wird dynamisch gef√ºllt -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Quick Profile (falls nicht vorhanden) -->
                    <div class="quick-step" id="quickStep2">
                        <div class="step-header">
                            <span class="step-number">2</span>
                            <h2>Kurz √ºber Sie <span class="optional-badge">Nur 5 Felder</span></h2>
                        </div>
                        
                        <div class="quick-profile-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label><i class="fas fa-user"></i> Ihr Name *</label>
                                    <input type="text" id="quickName" placeholder="Max Mustermann" required>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-briefcase"></i> Aktuelle Position</label>
                                    <input type="text" id="quickCurrentJob" placeholder="z.B. Softwareentwickler">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label><i class="fas fa-calendar"></i> Berufserfahrung *</label>
                                    <select id="quickExperience" required>
                                        <option value="">Bitte w√§hlen...</option>
                                        <option value="0-1">Berufseinsteiger (0-1 Jahre)</option>
                                        <option value="1-3">Junior (1-3 Jahre)</option>
                                        <option value="3-5">Mid-Level (3-5 Jahre)</option>
                                        <option value="5-10">Senior (5-10 Jahre)</option>
                                        <option value="10+">Expert (10+ Jahre)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-map-marker-alt"></i> Ihr Standort</label>
                                    <input type="text" id="quickLocation" placeholder="z.B. Berlin">
                                </div>
                            </div>
                            <div class="form-group full-width">
                                <label><i class="fas fa-star"></i> Ihre Top-3 St√§rken *</label>
                                <input type="text" id="quickSkills" placeholder="z.B. JavaScript, Projektmanagement, Teamf√ºhrung" required>
                                <small>Kommagetrennt eingeben</small>
                            </div>
                            <div class="form-group full-width">
                                <label><i class="fas fa-heart"></i> Was motiviert Sie bei dieser Stelle?</label>
                                <textarea id="quickMotivation" rows="3" placeholder="Optional: 1-2 S√§tze warum diese Stelle Sie interessiert..."></textarea>
                            </div>
                        </div>

                        <div class="profile-save-hint">
                            <label class="checkbox-label">
                                <input type="checkbox" id="saveQuickProfile" checked>
                                <span>Diese Daten f√ºr zuk√ºnftige Bewerbungen speichern</span>
                            </label>
                        </div>
                    </div>

                    <!-- Step 3: Generate -->
                    <div class="quick-step" id="quickStep3">
                        <div class="generation-options">
                            <div class="option-group">
                                <label>Tonalit√§t</label>
                                <div class="option-buttons">
                                    <button class="option-btn active" data-tone="formal" onclick="selectTone('formal')">
                                        <i class="fas fa-user-tie"></i> Formal
                                    </button>
                                    <button class="option-btn" data-tone="modern" onclick="selectTone('modern')">
                                        <i class="fas fa-rocket"></i> Modern
                                    </button>
                                    <button class="option-btn" data-tone="creative" onclick="selectTone('creative')">
                                        <i class="fas fa-paint-brush"></i> Kreativ
                                    </button>
                                </div>
                            </div>
                            <div class="option-group">
                                <label>L√§nge</label>
                                <div class="option-buttons">
                                    <button class="option-btn" data-length="short" onclick="selectLength('short')">
                                        <i class="fas fa-compress-alt"></i> Kurz
                                    </button>
                                    <button class="option-btn active" data-length="medium" onclick="selectLength('medium')">
                                        <i class="fas fa-align-left"></i> Mittel
                                    </button>
                                    <button class="option-btn" data-length="long" onclick="selectLength('long')">
                                        <i class="fas fa-expand-alt"></i> Lang
                                    </button>
                                </div>
                            </div>
                        </div>

                        <button class="btn-generate" id="generateBtn" onclick="generateQuickApplication()" disabled>
                            <div class="btn-content">
                                <i class="fas fa-magic"></i>
                                <span>Anschreiben generieren</span>
                            </div>
                            <div class="btn-loading hidden">
                                <div class="spinner"></div>
                                <span>KI arbeitet...</span>
                            </div>
                        </button>

                        <div class="generation-info" id="generationInfo">
                            <i class="fas fa-info-circle"></i>
                            <span id="apiStatusText">Pr√ºfe API-Konfiguration...</span>
                        </div>
                        <div class="api-hint hidden" id="apiHint">
                            <i class="fas fa-key"></i>
                            <span>Kein API-Key? <a href="../admin.html#api-keys" target="_blank">Im Admin Panel konfigurieren</a></span>
                        </div>
                    </div>

                    <!-- Result Section (dynamisch gef√ºllt) -->
                    <div class="quick-step hidden" id="resultSection"></div>

                    <!-- Job Data Display (versteckt bis analysiert) -->
                    <div id="jobDataDisplay" class="hidden"></div>

                    <!-- Legacy Step 4 - f√ºr R√ºckw√§rtskompatibilit√§t -->
                    <div class="quick-step hidden" id="quickStep4">
                        <div class="step-header success">
                            <i class="fas fa-check-circle"></i>
                            <h2>Ihr Anschreiben ist fertig!</h2>
                        </div>

                        <div class="result-container">
                            <div class="result-header">
                                <div class="result-meta">
                                    <span class="job-title" id="resultJobTitle">Senior Developer</span>
                                    <span class="company-name" id="resultCompany">@ Firma XYZ</span>
                                </div>
                                <div class="result-actions">
                                    <button class="btn-action" onclick="copyToClipboard()">
                                        <i class="fas fa-copy"></i> Kopieren
                                    </button>
                                    <button class="btn-action" onclick="downloadAsPdf()">
                                        <i class="fas fa-file-pdf"></i> PDF
                                    </button>
                                    <button class="btn-action" onclick="downloadAsDocx()">
                                        <i class="fas fa-file-word"></i> Word
                                    </button>
                                    <button class="btn-action primary" onclick="sendViaEmail()">
                                        <i class="fas fa-envelope"></i> Per E-Mail
                                    </button>
                                </div>
                            </div>

                            <div class="result-editor">
                                <textarea id="resultText" rows="20"></textarea>
                                <div class="editor-toolbar">
                                    <button onclick="regenerateCoverLetter()" title="Neu generieren">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                    <button onclick="improveText('formal')" title="Formaler">
                                        <i class="fas fa-user-tie"></i>
                                    </button>
                                    <button onclick="improveText('shorter')" title="K√ºrzen">
                                        <i class="fas fa-compress"></i>
                                    </button>
                                    <button onclick="improveText('stronger')" title="√úberzeugender">
                                        <i class="fas fa-bolt"></i>
                                    </button>
                                </div>
                            </div>

                            <div class="result-footer">
                                <button class="btn-secondary" onclick="startNewApplication()">
                                    <i class="fas fa-plus"></i> Neue Bewerbung
                                </button>
                                <button class="btn-primary" onclick="addToTracking()">
                                    <i class="fas fa-tasks"></i> Zum Tracking hinzuf√ºgen
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <!-- TAB 2: ANSCHREIBEN (Voller Editor) -->
            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <div id="tab-cover" class="tab-content">
                <div class="tab-placeholder">
                    <i class="fas fa-file-alt"></i>
                    <h2>Anschreiben-Generator</h2>
                    <p>Nutzen Sie den Quick Apply Tab f√ºr die schnelle Anschreiben-Generierung!</p>
                    <button onclick="showTab('quick')" class="btn-primary">
                        <i class="fas fa-rocket"></i> Zum Quick Apply
                    </button>
                    <span class="migration-hint">Alle Funktionen sind jetzt im Quick Apply Tab vereint</span>
                </div>
            </div>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <!-- TAB 3: LEBENSLAUF -->
            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <div id="tab-resume" class="tab-content">
                <div class="resume-container">
                    <div class="resume-header">
                        <h2><i class="fas fa-id-card"></i> Lebenslauf-Manager</h2>
                        <div class="resume-actions">
                            <button class="btn-secondary" onclick="uploadResumePdf()">
                                <i class="fas fa-file-upload"></i> PDF hochladen
                            </button>
                            <button class="btn-secondary" onclick="importFromLinkedIn()">
                                <i class="fab fa-linkedin"></i> LinkedIn Import
                            </button>
                            <a href="resume-editor.html" class="btn-primary">
                                <i class="fas fa-edit"></i> Vollst√§ndiger Editor
                            </a>
                        </div>
                    </div>

                    <!-- Quick Resume Form -->
                    <div class="resume-quick-form">
                        <div class="resume-section">
                            <h3><i class="fas fa-user"></i> Pers√∂nliche Daten</h3>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>Vorname</label>
                                    <input type="text" id="resumeFirstName" placeholder="Max">
                                </div>
                                <div class="form-group">
                                    <label>Nachname</label>
                                    <input type="text" id="resumeLastName" placeholder="Mustermann">
                                </div>
                                <div class="form-group">
                                    <label>Berufsbezeichnung</label>
                                    <input type="text" id="resumeTitle" placeholder="z.B. Senior Software Engineer">
                                </div>
                                <div class="form-group">
                                    <label>E-Mail</label>
                                    <input type="email" id="resumeEmail" placeholder="max@example.de">
                                </div>
                                <div class="form-group">
                                    <label>Telefon</label>
                                    <input type="tel" id="resumePhone" placeholder="+49 123 456789">
                                </div>
                                <div class="form-group">
                                    <label>Standort</label>
                                    <input type="text" id="resumeLocation" placeholder="M√ºnchen, Deutschland">
                                </div>
                            </div>
                        </div>

                        <div class="resume-section">
                            <h3><i class="fas fa-align-left"></i> Kurzprofil</h3>
                            <div class="form-group full-width">
                                <textarea id="resumeSummary" rows="4" placeholder="2-3 S√§tze √ºber Sie: Ihre aktuelle Rolle, Jahre Erfahrung, und wichtigste St√§rken..."></textarea>
                                <small>Wichtig f√ºr ATS-Systeme! Nennen Sie Ihren Jobtitel und 3-5 zentrale Skills.</small>
                            </div>
                        </div>

                        <div class="resume-section">
                            <h3><i class="fas fa-briefcase"></i> Berufserfahrung</h3>
                            <div id="experienceList" class="experience-list">
                                <!-- Wird dynamisch gef√ºllt -->
                            </div>
                            <button class="btn-add" onclick="addExperienceEntry()">
                                <i class="fas fa-plus"></i> Position hinzuf√ºgen
                            </button>
                        </div>

                        <div class="resume-section">
                            <h3><i class="fas fa-graduation-cap"></i> Ausbildung</h3>
                            <div id="educationList" class="education-list">
                                <!-- Wird dynamisch gef√ºllt -->
                            </div>
                            <button class="btn-add" onclick="addEducationEntry()">
                                <i class="fas fa-plus"></i> Ausbildung hinzuf√ºgen
                            </button>
                        </div>

                        <div class="resume-section">
                            <h3><i class="fas fa-tools"></i> Skills</h3>
                            <div class="form-group full-width">
                                <input type="text" id="resumeSkills" placeholder="JavaScript, React, Python, Projektmanagement, Agile...">
                                <small>Kommagetrennt eingeben</small>
                            </div>
                            <div class="skills-preview" id="skillsPreview">
                                <!-- Skill-Tags werden hier angezeigt -->
                            </div>
                        </div>

                        <div class="resume-section">
                            <h3><i class="fas fa-globe"></i> Sprachen</h3>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>Sprache</label>
                                    <input type="text" id="resumeLang1" placeholder="Deutsch" value="Deutsch">
                                </div>
                                <div class="form-group">
                                    <label>Niveau</label>
                                    <select id="resumeLang1Level">
                                        <option value="Muttersprache">Muttersprache</option>
                                        <option value="C2">C2 - Verhandlungssicher</option>
                                        <option value="C1">C1 - Flie√üend</option>
                                        <option value="B2">B2 - Gut</option>
                                        <option value="B1">B1 - Grundlagen</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Sprache</label>
                                    <input type="text" id="resumeLang2" placeholder="Englisch" value="Englisch">
                                </div>
                                <div class="form-group">
                                    <label>Niveau</label>
                                    <select id="resumeLang2Level">
                                        <option value="Muttersprache">Muttersprache</option>
                                        <option value="C2">C2 - Verhandlungssicher</option>
                                        <option value="C1" selected>C1 - Flie√üend</option>
                                        <option value="B2">B2 - Gut</option>
                                        <option value="B1">B1 - Grundlagen</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="resume-footer">
                            <button class="btn-secondary" onclick="clearResumeForm()">
                                <i class="fas fa-undo"></i> Zur√ºcksetzen
                            </button>
                            <button class="btn-primary" onclick="saveResume()">
                                <i class="fas fa-save"></i> Lebenslauf speichern
                            </button>
                        </div>
                    </div>

                    <!-- LinkedIn Import Modal Hint -->
                    <div class="linkedin-hint" id="linkedinHint">
                        <i class="fab fa-linkedin"></i>
                        <div>
                            <strong>LinkedIn-Import</strong>
                            <p>Exportieren Sie Ihr LinkedIn-Profil als PDF und laden Sie es hier hoch.</p>
                            <a href="https://www.linkedin.com/help/linkedin/answer/50191" target="_blank">Anleitung ‚Üí</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <!-- TAB 4: TRACKING -->
            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <div id="tab-tracking" class="tab-content">
                <div class="tracking-container">
                    <div class="tracking-header">
                        <h2><i class="fas fa-tasks"></i> Meine Bewerbungen</h2>
                        <button class="btn-primary" onclick="showAddApplicationModal()">
                            <i class="fas fa-plus"></i> Neue Bewerbung
                        </button>
                    </div>

                    <!-- Simple List View (statt komplexem Kanban) -->
                    <div class="tracking-filters">
                        <button class="filter-btn active" data-filter="all" onclick="filterApplications('all')">
                            Alle <span class="count" id="filterAll">0</span>
                        </button>
                        <button class="filter-btn" data-filter="pending" onclick="filterApplications('pending')">
                            <i class="fas fa-clock"></i> Offen <span class="count" id="filterPending">0</span>
                        </button>
                        <button class="filter-btn" data-filter="interview" onclick="filterApplications('interview')">
                            <i class="fas fa-comments"></i> Interview <span class="count" id="filterInterview">0</span>
                        </button>
                        <button class="filter-btn" data-filter="offer" onclick="filterApplications('offer')">
                            <i class="fas fa-star"></i> Angebot <span class="count" id="filterOffer">0</span>
                        </button>
                        <button class="filter-btn" data-filter="rejected" onclick="filterApplications('rejected')">
                            <i class="fas fa-times"></i> Absage <span class="count" id="filterRejected">0</span>
                        </button>
                    </div>

                    <div class="applications-list" id="applicationsList">
                        <!-- Wird dynamisch gef√ºllt -->
                        <div class="empty-state" id="emptyState">
                            <i class="fas fa-inbox"></i>
                            <h3>Noch keine Bewerbungen</h3>
                            <p>Erstellen Sie Ihre erste Bewerbung mit dem Quick Apply!</p>
                            <button class="btn-primary" onclick="showTab('quick')">
                                <i class="fas fa-bolt"></i> Quick Apply starten
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <!-- TAB 5: INTERVIEW -->
            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <div id="tab-interview" class="tab-content">
                <div class="tab-placeholder">
                    <i class="fas fa-microphone"></i>
                    <h2>Interview-Vorbereitung</h2>
                    <p>KI-generierte Fragen und Musterantworten</p>
                    <a href="interview-prep.html" class="btn-primary">
                        <i class="fas fa-play"></i> Interview-Training starten
                    </a>
                    <span class="migration-hint">Wird in n√§chster Phase hier integriert</span>
                </div>
            </div>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <!-- TAB 6: PROFIL -->
            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <div id="tab-profile" class="tab-content">
                <div class="profile-container">
                    <div class="profile-header">
                        <h2><i class="fas fa-user-cog"></i> Mein Bewerbungsprofil</h2>
                        <p>Diese Daten werden f√ºr alle Bewerbungen verwendet</p>
                    </div>

                    <form id="profileForm" class="profile-form-compact">
                        <!-- Pers√∂nliche Daten -->
                        <section class="profile-section">
                            <h3><i class="fas fa-user"></i> Pers√∂nliche Daten</h3>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>Vorname *</label>
                                    <input type="text" id="profileFirstName" required>
                                </div>
                                <div class="form-group">
                                    <label>Nachname *</label>
                                    <input type="text" id="profileLastName" required>
                                </div>
                                <div class="form-group">
                                    <label>E-Mail *</label>
                                    <input type="email" id="profileEmail" required>
                                </div>
                                <div class="form-group">
                                    <label>Telefon</label>
                                    <input type="tel" id="profilePhone">
                                </div>
                                <div class="form-group">
                                    <label>Wohnort</label>
                                    <input type="text" id="profileLocation">
                                </div>
                                <div class="form-group">
                                    <label>Aktuelle Position</label>
                                    <input type="text" id="profileCurrentJob">
                                </div>
                            </div>
                        </section>

                        <!-- Berufserfahrung -->
                        <section class="profile-section">
                            <h3><i class="fas fa-briefcase"></i> Berufserfahrung</h3>
                            <div class="form-group full-width">
                                <label>Jahre Berufserfahrung</label>
                                <select id="profileExperience">
                                    <option value="">Bitte w√§hlen...</option>
                                    <option value="0-1">Berufseinsteiger (0-1 Jahre)</option>
                                    <option value="1-3">Junior (1-3 Jahre)</option>
                                    <option value="3-5">Mid-Level (3-5 Jahre)</option>
                                    <option value="5-10">Senior (5-10 Jahre)</option>
                                    <option value="10+">Expert (10+ Jahre)</option>
                                </select>
                            </div>
                            <div class="form-group full-width">
                                <label>Kurzes Profil / Summary</label>
                                <textarea id="profileSummary" rows="4" placeholder="2-3 S√§tze √ºber Sie und Ihre wichtigsten Qualifikationen..."></textarea>
                            </div>
                        </section>

                        <!-- Skills -->
                        <section class="profile-section">
                            <h3><i class="fas fa-star"></i> F√§higkeiten & St√§rken</h3>
                            <div class="form-group full-width">
                                <label>Ihre Top-Skills (kommagetrennt)</label>
                                <input type="text" id="profileSkills" placeholder="z.B. JavaScript, Projektmanagement, Teamf√ºhrung, Excel">
                            </div>
                            <div class="skills-tags" id="skillsTags">
                                <!-- Wird dynamisch gef√ºllt -->
                            </div>
                        </section>

                        <div class="profile-actions">
                            <button type="button" class="btn-secondary" onclick="resetProfile()">
                                <i class="fas fa-undo"></i> Zur√ºcksetzen
                            </button>
                            <button type="submit" class="btn-primary" onclick="saveProfile(event)">
                                <i class="fas fa-save"></i> Profil speichern
                            </button>
                        </div>
                    </form>

                    <!-- Daten-Status -->
                    <div class="profile-status">
                        <div class="status-item">
                            <i class="fas fa-database"></i>
                            <span>Daten werden lokal in Ihrem Browser gespeichert</span>
                        </div>
                        <div class="status-item">
                            <i class="fas fa-shield-alt"></i>
                            <span>Keine Weitergabe an Dritte</span>
                        </div>
                    </div>
                </div>
            </div>

        </div><!-- End dashboard-content -->
    </main>

    <!-- Modal: Neue Bewerbung hinzuf√ºgen -->
    <div class="modal-overlay hidden" id="addApplicationModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-plus"></i> Bewerbung hinzuf√ºgen</h3>
                <button class="modal-close" onclick="closeModal('addApplicationModal')">&times;</button>
            </div>
            <form id="addApplicationForm" onsubmit="addApplication(event)">
                <div class="form-group">
                    <label>Position *</label>
                    <input type="text" id="newAppPosition" required>
                </div>
                <div class="form-group">
                    <label>Unternehmen *</label>
                    <input type="text" id="newAppCompany" required>
                </div>
                <div class="form-group">
                    <label>Standort</label>
                    <input type="text" id="newAppLocation" placeholder="z.B. M√ºnchen, Remote">
                </div>
                <div class="form-group">
                    <label>Bewerbungsdatum</label>
                    <input type="date" id="newAppDate" value="">
                </div>
                <div class="form-group">
                    <label>Status</label>
                    <select id="newAppStatus">
                        <option value="pending">Gesendet / Offen</option>
                        <option value="interview">Interview eingeladen</option>
                        <option value="offer">Angebot erhalten</option>
                        <option value="rejected">Absage</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Job-URL</label>
                    <input type="url" id="newAppUrl" placeholder="https://...">
                </div>
                <div class="form-group">
                    <label>Notizen</label>
                    <textarea id="newAppNotes" rows="3"></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('addApplicationModal')">Abbrechen</button>
                    <button type="submit" class="btn-primary">Hinzuf√ºgen</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal: Bewerbung bearbeiten -->
    <div class="modal-overlay hidden" id="editApplicationModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-edit"></i> Bewerbung bearbeiten</h3>
                <button class="modal-close" onclick="closeModal('editApplicationModal')">&times;</button>
            </div>
            <form id="editApplicationForm" onsubmit="updateApplication(event)">
                <input type="hidden" id="editAppId">
                <div class="form-group">
                    <label>Position *</label>
                    <input type="text" id="editAppPosition" required>
                </div>
                <div class="form-group">
                    <label>Unternehmen *</label>
                    <input type="text" id="editAppCompany" required>
                </div>
                <div class="form-group">
                    <label>Standort</label>
                    <input type="text" id="editAppLocation">
                </div>
                <div class="form-group">
                    <label>Bewerbungsdatum</label>
                    <input type="date" id="editAppDate">
                </div>
                <div class="form-group">
                    <label>Status</label>
                    <select id="editAppStatus">
                        <option value="pending">Gesendet / Offen</option>
                        <option value="interview">Interview eingeladen</option>
                        <option value="offer">Angebot erhalten</option>
                        <option value="rejected">Absage</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Job-URL</label>
                    <input type="url" id="editAppUrl">
                </div>
                <div class="form-group">
                    <label>Notizen</label>
                    <textarea id="editAppNotes" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Anschreiben</label>
                    <textarea id="editAppCoverLetter" rows="5" placeholder="Gespeichertes Anschreiben..."></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('editApplicationModal')">Abbrechen</button>
                    <button type="submit" class="btn-primary">Speichern</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Scripts -->
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1490.0.min.js"></script>
    <script src="../js/success-checkmark.js?v=20260112"></script>
    <script src="../js/unified-aws-auth.js?v=20260112"></script>
    <script src="../js/unified-auth-modals.js?v=20260112"></script>
    <script src="../js/global-api-manager.js"></script>
    <script src="../js/aws-api-settings.js"></script>
    <script src="js/utils.js?v=20260111"></script>
    <script src="js/dashboard-core.js?v=20260112"></script>
    <script src="js/quick-apply.js?v=20260111"></script>
    
    <script>
        // Initialize Global API Manager
        if (!window.globalAPIManager) {
            window.globalAPIManager = new GlobalAPIManager();
        }
        
        // Wait for AWS Auth System
        function waitForAuthSystem() {
            return new Promise(resolve => {
                if (window.awsAuth && window.awsAuth.isInitialized) {
                    resolve();
                } else {
                    const checkInterval = setInterval(() => {
                        if (window.awsAuth && window.awsAuth.isInitialized) {
                            clearInterval(checkInterval);
                            resolve();
                        }
                    }, 100);
                    setTimeout(() => {
                        clearInterval(checkInterval);
                        resolve(); // Resolve anyway after timeout
                    }, 5000);
                }
            });
        }
        
        // Setup Auth UI
        function setupAuthUI() {
            const authButton = document.getElementById('authButton');
            const authButtonText = document.getElementById('authButtonText');
            const mobileAuthButton = document.getElementById('mobileAuthButton');
            const userDropdown = document.getElementById('userDropdown');
            
            if (!authButton) return;
            
            // Update UI based on login state
            async function updateAuthState() {
                const isLoggedIn = window.awsAuth && window.awsAuth.isLoggedIn();
                const userData = isLoggedIn ? window.awsAuth.getUserDataFromToken() : null;
                
                if (isLoggedIn && userData) {
                    // Versuche Name aus dem Profil zu laden (falls verf√ºgbar)
                    let displayName = userData.name;
                    
                    // Wenn kein Name im Token, versuche AWS-Profil zu laden
                    if (!displayName && window.awsProfileAPI) {
                        try {
                            // Warte auf awsProfileAPI Initialisierung
                            if (!window.awsProfileAPI.isInitialized) {
                                console.log('‚è≥ Warte auf awsProfileAPI...');
                                await new Promise((resolve) => {
                                    let attempts = 0;
                                    const check = setInterval(() => {
                                        attempts++;
                                        if (window.awsProfileAPI?.isInitialized || attempts > 20) {
                                            clearInterval(check);
                                            resolve();
                                        }
                                    }, 100);
                                });
                            }
                            
                            console.log('üì° Lade Profil f√ºr Auth-Button...');
                            const profile = await window.awsProfileAPI.loadProfile();
                            console.log('üìã Geladenes Profil:', profile);
                            
                            if (profile) {
                                // Unterst√ºtze verschiedene Profil-Formate
                                const firstName = profile.firstName || profile.personal?.firstName || '';
                                const lastName = profile.lastName || profile.personal?.lastName || '';
                                
                                if (firstName) {
                                    displayName = firstName + (lastName ? ' ' + lastName : '');
                                    console.log('‚úÖ Name aus Profil:', displayName);
                                }
                            }
                        } catch (e) {
                            console.log('‚ÑπÔ∏è Profil nicht verf√ºgbar:', e.message);
                        }
                    }
                    
                    // Fallback: Email-Vorname (nur wenn l√§nger als 3 Zeichen, sonst "Profil")
                    if (!displayName && userData.email) {
                        const emailName = userData.email.split('@')[0];
                        displayName = emailName.length > 3 ? emailName : 'Profil';
                        console.log('‚ÑπÔ∏è Verwende Email-Fallback:', displayName);
                    }
                    
                    // Logged in
                    authButton.innerHTML = `
                        <img src="${userData.picture || '../images/default-avatar.png'}" alt="User" class="nav-user-avatar">
                        <span>${displayName || 'Profil'}</span>
                        <i class="fas fa-chevron-down"></i>
                    `;
                    authButton.classList.add('logged-in');
                    
                    // Update dropdown
                    if (document.getElementById('userName')) {
                        document.getElementById('userName').textContent = displayName || 'Benutzer';
                    }
                    if (document.getElementById('userEmail')) {
                        document.getElementById('userEmail').textContent = userData.email || '';
                    }
                    if (document.getElementById('userAvatarImg')) {
                        document.getElementById('userAvatarImg').src = userData.picture || '../images/default-avatar.png';
                    }
                    
                    // Mobile
                    if (mobileAuthButton) {
                        mobileAuthButton.innerHTML = `<i class="fas fa-sign-out-alt"></i> Abmelden`;
                        mobileAuthButton.onclick = () => window.awsAuth.logout();
                    }
                    
                    // Mobile Profil-Link anzeigen
                    const mobileProfileLink = document.getElementById('mobileProfileLink');
                    if (mobileProfileLink) {
                        mobileProfileLink.style.display = 'block';
                    }
                } else {
                    // Not logged in
                    authButton.innerHTML = `<i class="fas fa-user"></i><span>Anmelden</span>`;
                    authButton.classList.remove('logged-in');
                    if (userDropdown) userDropdown.style.display = 'none';
                    
                    // Mobile
                    if (mobileAuthButton) {
                        mobileAuthButton.innerHTML = `<i class="fas fa-user"></i> Anmelden`;
                        mobileAuthButton.onclick = () => {
                            closeMobileMenu();
                            if (window.authModals) window.authModals.showLogin();
                        };
                    }
                    
                    // Mobile Profil-Link ausblenden
                    const mobileProfileLink = document.getElementById('mobileProfileLink');
                    if (mobileProfileLink) {
                        mobileProfileLink.style.display = 'none';
                    }
                }
                
                // Trigger dashboard update
                if (window.DashboardCore && window.DashboardCore.checkAuthStatus) {
                    window.DashboardCore.checkAuthStatus();
                }
            }
            
            // Auth button click handler
            authButton.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopPropagation();
                
                console.log('üîò Auth button clicked');
                const isLoggedIn = window.awsAuth && window.awsAuth.isLoggedIn();
                console.log('üîê Is logged in:', isLoggedIn);
                
                if (isLoggedIn) {
                    // Toggle dropdown
                    if (userDropdown) {
                        const currentDisplay = getComputedStyle(userDropdown).display;
                        console.log('üìã Current dropdown display:', currentDisplay);
                        const newDisplay = currentDisplay === 'none' ? 'block' : 'none';
                        userDropdown.style.display = newDisplay;
                        console.log('üìã New dropdown display:', newDisplay);
                    } else {
                        console.error('‚ùå userDropdown element not found');
                    }
                } else {
                    // Show login modal
                    if (window.authModals) {
                        window.authModals.showLogin();
                    } else if (window.unifiedAuthModals) {
                        window.unifiedAuthModals.showLogin();
                    } else {
                        console.error('Auth modals not available');
                        showToast('Auth-System wird geladen...', 'info');
                    }
                }
            });
            
            // Close dropdown when clicking outside
            document.addEventListener('click', (e) => {
                if (userDropdown && !authButton.contains(e.target) && !userDropdown.contains(e.target)) {
                    userDropdown.style.display = 'none';
                }
            });
            
            // Listen for auth state changes
            window.addEventListener('authStateChanged', updateAuthState);
            
            // Initial state
            updateAuthState();
        }
        
        // Logout function for dropdown
        window.logout = async function() {
            if (window.awsAuth) {
                await window.awsAuth.logout();
                showToast('Erfolgreich abgemeldet', 'success');
                setTimeout(() => location.reload(), 500);
            }
        };
        
        // Mobile Menu Functions
        function openMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenuFullscreen');
            const overlay = document.getElementById('mobileMenuOverlay');
            const hamburger = document.getElementById('mobileHamburger');
            
            if (mobileMenu) mobileMenu.classList.add('active');
            if (overlay) overlay.classList.add('active');
            if (hamburger) hamburger.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function closeMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenuFullscreen');
            const overlay = document.getElementById('mobileMenuOverlay');
            const hamburger = document.getElementById('mobileHamburger');
            
            if (mobileMenu) mobileMenu.classList.remove('active');
            if (overlay) overlay.classList.remove('active');
            if (hamburger) hamburger.classList.remove('active');
            document.body.style.overflow = '';
        }
        
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenuFullscreen');
            if (mobileMenu && mobileMenu.classList.contains('active')) {
                closeMobileMenu();
            } else {
                openMobileMenu();
            }
        }
        
        // Setup Mobile Menu Event Listeners
        function setupMobileMenu() {
            const hamburger = document.getElementById('mobileHamburger');
            const closeBtn = document.getElementById('mobileMenuClose');
            const overlay = document.getElementById('mobileMenuOverlay');
            const menuLinks = document.querySelectorAll('.mobile-menu-link');
            
            if (hamburger) {
                hamburger.addEventListener('click', toggleMobileMenu);
            }
            
            if (closeBtn) {
                closeBtn.addEventListener('click', closeMobileMenu);
            }
            
            if (overlay) {
                overlay.addEventListener('click', closeMobileMenu);
            }
            
            // Close menu when clicking a link
            menuLinks.forEach(link => {
                link.addEventListener('click', closeMobileMenu);
            });
        }
        
        // Initialize on load
        document.addEventListener('DOMContentLoaded', async () => {
            // Setup mobile menu
            setupMobileMenu();
            
            // Wait for auth system
            await waitForAuthSystem();
            
            // Setup auth UI
            setupAuthUI();
            
            // Initialize auth modals if not already done
            if (!window.authModals && window.UnifiedAuthModals) {
                window.authModals = new UnifiedAuthModals();
            }
            
            // Initialize dashboard
            initDashboard();
        });
    </script>
</body>
</html>

