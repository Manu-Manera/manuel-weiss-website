<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Mein Profil | Manuel Weiss</title>
    <link rel="stylesheet" href="css/user-profile.css?v=20260112k">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>
    <!-- Modern Navigation -->
    <nav class="profile-nav">
        <div class="nav-container">
            <a href="javascript:void(0)" class="nav-back" onclick="goBack()">
                <i class="fas fa-arrow-left"></i>
                <span>Zur√ºck</span>
            </a>
            <div class="nav-title">
                <h1>Mein Profil</h1>
            </div>
            <div class="nav-actions">
                <button id="profileAuthButton" class="btn-auth">
                    <i class="fas fa-user-circle"></i>
                    <span id="profileAuthText">Anmelden</span>
                </button>
                <button class="btn-save" onclick="saveProfile()">
                    <i class="fas fa-save"></i>
                    Speichern
                </button>
            </div>
        </div>
    </nav>

    <!-- Profile Content -->
    <main class="profile-main">
        <div class="profile-container">
            <!-- Profile Header -->
            <section class="profile-header">
                <div class="profile-avatar">
                    <div class="avatar-container">
                        <img src="manuel-weiss-photo.svg" alt="Profilbild" id="profileImage">
                        <button class="avatar-upload" onclick="uploadAvatar()">
                            <i class="fas fa-camera"></i>
                        </button>
                    </div>
                </div>
                <div class="profile-info">
                    <h2 id="userName">Manuel Weiss</h2>
                    <p id="userEmail">manuel.weiss@example.com</p>
                    <div class="profile-stats">
                        <div class="stat-item">
                            <span class="stat-number" id="completedMethods">0</span>
                            <span class="stat-label">Abgeschlossene Methoden</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number" id="totalProgress">0%</span>
                            <span class="stat-label">Gesamtfortschritt</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number" id="streakDays">0</span>
                            <span class="stat-label">Tage in Folge</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Profile Tabs -->
            <section class="profile-tabs">
                <div class="tab-nav">
                    <button class="tab-btn active" data-tab="personal">
                        <i class="fas fa-user"></i>
                        Pers√∂nliche Daten
                    </button>
                    <button class="tab-btn" data-tab="applications">
                        <i class="fas fa-briefcase"></i>
                        Bewerbungsmanager
                    </button>
                    <button class="tab-btn" data-tab="settings">
                        <i class="fas fa-cog"></i>
                        Einstellungen
                    </button>
                    <button class="tab-btn" data-tab="progress">
                        <i class="fas fa-chart-line"></i>
                        Fortschritt
                    </button>
                    <button class="tab-btn" data-tab="achievements">
                        <i class="fas fa-trophy"></i>
                        Erfolge
                    </button>
                    <button class="tab-btn" data-tab="training">
                        <i class="fas fa-dumbbell"></i>
                        Training
                    </button>
                    <button class="tab-btn" data-tab="nutrition">
                        <i class="fas fa-utensils"></i>
                        Ern√§hrung
                    </button>
                    <button class="tab-btn" data-tab="coach">
                        <i class="fas fa-user-tie"></i>
                        Coach
                    </button>
                    <button class="tab-btn" data-tab="journal">
                        <i class="fas fa-book"></i>
                        Tagebuch
                    </button>
                </div>
            </section>

            <!-- Tab Content -->
            <div class="tab-content">
                <!-- Personal Data Tab -->
                <div class="tab-panel active" id="personal">
                    <div class="form-section">
                        <h3><i class="fas fa-user"></i> Pers√∂nliche Informationen</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="firstName">Vorname</label>
                                <input type="text" id="firstName" value="Manuel" placeholder="Dein Vorname">
                            </div>
                            <div class="form-group">
                                <label for="lastName">Nachname</label>
                                <input type="text" id="lastName" value="Weiss" placeholder="Dein Nachname">
                            </div>
                            <div class="form-group">
                                <label for="email">E-Mail</label>
                                <input type="email" id="email" value="manuel.weiss@example.com" placeholder="Deine E-Mail">
                            </div>
                            <div class="form-group">
                                <label for="phone">Telefon</label>
                                <input type="tel" id="phone" placeholder="Deine Telefonnummer">
                            </div>
                            <div class="form-group">
                                <label for="birthDate">Geburtsdatum</label>
                                <input type="date" id="birthDate">
                            </div>
                            <div class="form-group">
                                <label for="location">Standort</label>
                                <input type="text" id="location" placeholder="Dein Standort">
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3><i class="fas fa-briefcase"></i> Berufliche Informationen</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="profession">Beruf</label>
                                <input type="text" id="profession" placeholder="Dein Beruf">
                            </div>
                            <div class="form-group">
                                <label for="company">Unternehmen</label>
                                <input type="text" id="company" placeholder="Dein Unternehmen">
                            </div>
                            <div class="form-group">
                                <label for="experience">Berufserfahrung</label>
                                <select id="experience">
                                    <option value="">W√§hle deine Erfahrung</option>
                                    <option value="0-2">0-2 Jahre</option>
                                    <option value="3-5">3-5 Jahre</option>
                                    <option value="6-10">6-10 Jahre</option>
                                    <option value="10+">10+ Jahre</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="industry">Branche</label>
                                <input type="text" id="industry" placeholder="Deine Branche">
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3><i class="fas fa-heart"></i> Pers√∂nliche Ziele</h3>
                        <div class="form-group">
                            <label for="goals">Deine Ziele</label>
                            <textarea id="goals" placeholder="Beschreibe deine pers√∂nlichen und beruflichen Ziele..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="interests">Interessen</label>
                            <textarea id="interests" placeholder="Deine Hobbys und Interessen..."></textarea>
                        </div>
                    </div>
                </div>

                <!-- Applications Tab (Bewerbungsmanager) -->
                <div class="tab-panel" id="applications">
                    <div class="applications-dashboard">
                        <!-- Dashboard Header -->
                        <div class="dashboard-header">
                            <div class="dashboard-actions">
                                <button class="btn-primary" id="startNewApplication">
                                    <i class="fas fa-plus"></i>
                                    Neue Bewerbung erstellen
                                </button>
                            </div>
                        </div>

                        <!-- Statistics Overview -->
                        <div class="applications-stats">
                            <div class="stat-card">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                    <i class="fas fa-briefcase"></i>
                                </div>
                                <div class="stat-content">
                                    <h3 id="totalApplications">0</h3>
                                    <p>Gesamt Bewerbungen</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div class="stat-content">
                                    <h3 id="activeApplications">0</h3>
                                    <p>Aktive Bewerbungen</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                                <div class="stat-content">
                                    <h3 id="successRate">0%</h3>
                                    <p>Erfolgsrate</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                                    <i class="fas fa-calendar-check"></i>
                                </div>
                                <div class="stat-content">
                                    <h3 id="interviewsScheduled">0</h3>
                                    <p>Interviews geplant</p>
                                </div>
                            </div>
                        </div>

                        <!-- Applications List -->
                        <div class="applications-section">
                            <div class="section-header">
                                <h3><i class="fas fa-list"></i> Meine Bewerbungen</h3>
                                <div class="filter-controls">
                                    <select id="statusFilter" class="filter-select">
                                        <option value="all">Alle Status</option>
                                        <option value="preparation">Vorbereitung</option>
                                        <option value="sent">Versendet</option>
                                        <option value="confirmed">Best√§tigt</option>
                                        <option value="interview">Interview</option>
                                        <option value="offer">Angebot</option>
                                        <option value="rejected">Abgelehnt</option>
                                    </select>
                                </div>
                            </div>
                            <div id="applicationsList" class="applications-list">
                                <!-- Wird dynamisch gef√ºllt -->
                                <div class="empty-state">
                                    <i class="fas fa-briefcase"></i>
                                    <h4>Noch keine Bewerbungen</h4>
                                    <p>Erstelle deine erste Bewerbung mit dem Smart Workflow</p>
                                    <button class="btn-primary" onclick="document.getElementById('startNewApplication').click()">
                                        <i class="fas fa-plus"></i>
                                        Neue Bewerbung erstellen
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Cover Letters Section -->
                        <div class="applications-section">
                            <div class="section-header">
                                <h3><i class="fas fa-envelope"></i> Meine Anschreiben</h3>
                                <div class="filter-controls">
                                    <button class="btn-secondary" onclick="window.userProfile.createNewCoverLetter()">
                                        <i class="fas fa-plus"></i>
                                        Neues Anschreiben
                                    </button>
                                </div>
                            </div>
                            <div id="coverLettersList" class="applications-list">
                                <!-- Wird dynamisch gef√ºllt -->
                                <div id="coverLettersEmpty" class="empty-state">
                                    <i class="fas fa-envelope"></i>
                                    <h4>Noch keine Anschreiben</h4>
                                    <p>Erstelle dein erstes Anschreiben mit KI-Unterst√ºtzung</p>
                                    <button class="btn-primary" onclick="window.userProfile.createNewCoverLetter()">
                                        <i class="fas fa-plus"></i>
                                        Neues Anschreiben erstellen
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Resumes Section -->
                        <div class="applications-section">
                            <div class="section-header">
                                <h3><i class="fas fa-file-alt"></i> Meine Lebensl√§ufe</h3>
                                <div class="filter-controls">
                                    <a href="applications/resume-editor.html" class="btn-secondary">
                                        <i class="fas fa-plus"></i>
                                        Neuer Lebenslauf
                                    </a>
                                </div>
                            </div>
                            <div id="resumesList" class="applications-list">
                                <!-- Wird dynamisch gef√ºllt -->
                                <div class="empty-state">
                                    <i class="fas fa-file-alt"></i>
                                    <h4>Noch keine Lebensl√§ufe</h4>
                                    <p>Erstelle deinen ersten Lebenslauf manuell oder lade eine PDF hoch</p>
                                    <a href="applications/resume-editor.html" class="btn-primary">
                                        <i class="fas fa-plus"></i>
                                        Neuen Lebenslauf erstellen
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Tab -->
                <div class="tab-panel" id="settings">
                    <div class="form-section">
                        <h3><i class="fas fa-bell"></i> Benachrichtigungen</h3>
                        <div class="settings-grid">
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h4>E-Mail Benachrichtigungen</h4>
                                    <p>Erhalte Updates zu deinem Fortschritt</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="emailNotifications" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h4>W√∂chentliche Zusammenfassung</h4>
                                    <p>W√∂chentlicher Fortschrittsbericht</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="weeklySummary" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h4>Erinnerungen</h4>
                                    <p>Erinnerungen f√ºr t√§gliche √úbungen</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="reminders">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3><i class="fas fa-palette"></i> Design-Einstellungen</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="theme">Design-Theme</label>
                                <select id="theme">
                                    <option value="light">Hell</option>
                                    <option value="dark">Dunkel</option>
                                    <option value="auto">Automatisch</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="language">Sprache</label>
                                <select id="language">
                                    <option value="de">Deutsch</option>
                                    <option value="en">English</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3><i class="fas fa-shield-alt"></i> Datenschutz</h3>
                        <div class="settings-grid">
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h4>Daten teilen</h4>
                                    <p>Anonymisierte Daten f√ºr Verbesserungen teilen</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="dataSharing">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Progress Tab -->
                <div class="tab-panel" id="progress">
                    <div class="progress-dashboard">
                        <div class="dashboard-header">
                            <h3><i class="fas fa-chart-line"></i> Dein Fortschritt</h3>
                            <p>Verfolge deine Entwicklung in der Pers√∂nlichkeitsentwicklung</p>
                        </div>

                        <!-- Overall Progress -->
                        <div class="progress-overview">
                            <div class="overview-card">
                                <div class="card-header">
                                    <h4>Gesamtfortschritt</h4>
                                    <span class="progress-percentage" id="overallProgress">0%</span>
                                </div>
                                <div class="progress-ring">
                                    <svg class="progress-ring-svg" width="120" height="120">
                                        <circle class="progress-ring-circle" cx="60" cy="60" r="54" fill="transparent" stroke="#e5e7eb" stroke-width="8"/>
                                        <circle class="progress-ring-circle progress-ring-fill" cx="60" cy="60" r="54" fill="transparent" stroke="#6366f1" stroke-width="8" stroke-linecap="round"/>
                                    </svg>
                                    <div class="progress-text">
                                        <span class="progress-number" id="overallProgressNumber">0</span>
                                        <span class="progress-label">von 29 Methoden</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Method Categories -->
                        <div class="categories-grid">
                            <div class="category-card">
                                <div class="category-header">
                                    <div class="category-icon">
                                        <i class="fas fa-heart"></i>
                                    </div>
                                    <div class="category-info">
                                        <h4>Selbstfindung</h4>
                                        <p>5 Methoden</p>
                                    </div>
                                </div>
                                <div class="category-progress">
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 60%"></div>
                                    </div>
                                    <span class="progress-text">3/5 abgeschlossen</span>
                                </div>
                            </div>

                            <div class="category-card">
                                <div class="category-header">
                                    <div class="category-icon">
                                        <i class="fas fa-brain"></i>
                                    </div>
                                    <div class="category-info">
                                        <h4>Entwicklung</h4>
                                        <p>8 Methoden</p>
                                    </div>
                                </div>
                                <div class="category-progress">
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 25%"></div>
                                    </div>
                                    <span class="progress-text">2/8 abgeschlossen</span>
                                </div>
                            </div>

                            <div class="category-card">
                                <div class="category-header">
                                    <div class="category-icon">
                                        <i class="fas fa-users"></i>
                                    </div>
                                    <div class="category-info">
                                        <h4>Beziehungen</h4>
                                        <p>6 Methoden</p>
                                    </div>
                                </div>
                                <div class="category-progress">
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 0%"></div>
                                    </div>
                                    <span class="progress-text">0/6 abgeschlossen</span>
                                </div>
                            </div>

                            <div class="category-card">
                                <div class="category-header">
                                    <div class="category-icon">
                                        <i class="fas fa-briefcase"></i>
                                    </div>
                                    <div class="category-info">
                                        <h4>Karriere</h4>
                                        <p>4 Methoden</p>
                                    </div>
                                </div>
                                <div class="category-progress">
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 75%"></div>
                                    </div>
                                    <span class="progress-text">3/4 abgeschlossen</span>
                                </div>
                            </div>
                        </div>

                        <!-- Recent Activity -->
                        <div class="activity-section">
                            <h4><i class="fas fa-clock"></i> Letzte Aktivit√§ten</h4>
                            <div class="activity-list">
                                <div class="activity-item">
                                    <div class="activity-icon">
                                        <i class="fas fa-check-circle"></i>
                                    </div>
                                    <div class="activity-content">
                                        <h5>Werte-Kl√§rung abgeschlossen</h5>
                                        <p>vor 2 Tagen</p>
                                    </div>
                                </div>
                                <div class="activity-item">
                                    <div class="activity-icon">
                                        <i class="fas fa-check-circle"></i>
                                    </div>
                                    <div class="activity-content">
                                        <h5>Ikigai-Methode abgeschlossen</h5>
                                        <p>vor 1 Woche</p>
                                    </div>
                                </div>
                                <div class="activity-item">
                                    <div class="activity-icon">
                                        <i class="fas fa-play-circle"></i>
                                    </div>
                                    <div class="activity-content">
                                        <h5>Emotionale Intelligenz gestartet</h5>
                                        <p>vor 3 Tagen</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Achievements Tab -->
                <div class="tab-panel" id="achievements">
                    <div class="achievements-dashboard">
                        <div class="dashboard-header">
                            <h3><i class="fas fa-trophy"></i> Deine Erfolge</h3>
                            <p>Feiere deine Fortschritte und erreiche neue Meilensteine</p>
                        </div>

                        <div class="achievements-grid">
                            <div class="achievement-card earned">
                                <div class="achievement-icon">
                                    <i class="fas fa-star"></i>
                                </div>
                                <div class="achievement-info">
                                    <h4>Erste Schritte</h4>
                                    <p>Erste Methode abgeschlossen</p>
                                </div>
                                <div class="achievement-date">
                                    <i class="fas fa-calendar"></i>
                                    <span>vor 2 Tagen</span>
                                </div>
                            </div>

                            <div class="achievement-card earned">
                                <div class="achievement-icon">
                                    <i class="fas fa-heart"></i>
                                </div>
                                <div class="achievement-info">
                                    <h4>Werte-Entdecker</h4>
                                    <p>Werte-Kl√§rung abgeschlossen</p>
                                </div>
                                <div class="achievement-date">
                                    <i class="fas fa-calendar"></i>
                                    <span>vor 2 Tagen</span>
                                </div>
                            </div>

                            <div class="achievement-card locked">
                                <div class="achievement-icon">
                                    <i class="fas fa-fire"></i>
                                </div>
                                <div class="achievement-info">
                                    <h4>Streak-Master</h4>
                                    <p>7 Tage in Folge aktiv</p>
                                </div>
                                <div class="achievement-progress">
                                    <span>3/7 Tage</span>
                                </div>
                            </div>

                            <div class="achievement-card locked">
                                <div class="achievement-icon">
                                    <i class="fas fa-graduation-cap"></i>
                                </div>
                                <div class="achievement-info">
                                    <h4>Entwicklungs-Experte</h4>
                                    <p>10 Methoden abgeschlossen</p>
                                </div>
                                <div class="achievement-progress">
                                    <span>5/10 Methoden</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Training Tab -->
                <div class="tab-panel" id="training">
                    <div class="training-dashboard">
                        <div class="dashboard-header">
                            <h3><i class="fas fa-dumbbell"></i> Dein Trainingsplan</h3>
                            <p>Erstelle und verfolge deinen personalisierten Trainingsplan</p>
                        </div>

                        <!-- Training Stats -->
                        <div class="training-stats-grid">
                            <div class="stat-card training-stat">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                                    <i class="fas fa-calendar-check"></i>
                                </div>
                                <div class="stat-content">
                                    <h3 id="trainingTotalWorkouts">0</h3>
                                    <p>Workouts gesamt</p>
                                </div>
                            </div>
                            <div class="stat-card training-stat">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">
                                    <i class="fas fa-fire"></i>
                                </div>
                                <div class="stat-content">
                                    <h3 id="trainingCurrentStreak">0</h3>
                                    <p>Tage Streak</p>
                                </div>
                            </div>
                            <div class="stat-card training-stat">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div class="stat-content">
                                    <h3 id="trainingTotalMinutes">0</h3>
                                    <p>Minuten trainiert</p>
                                </div>
                            </div>
                            <div class="stat-card training-stat">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #ec4899 0%, #db2777 100%);">
                                    <i class="fas fa-trophy"></i>
                                </div>
                                <div class="stat-content">
                                    <h3 id="trainingLongestStreak">0</h3>
                                    <p>L√§ngster Streak</p>
                                </div>
                            </div>
                        </div>

                        <!-- Current Plan -->
                        <div class="current-plan-section">
                            <h4><i class="fas fa-clipboard-list"></i> Aktueller Trainingsplan</h4>
                            <div id="currentTrainingPlan" class="plan-container">
                                <div class="empty-state">
                                    <div class="empty-state-icon">üèãÔ∏è</div>
                                    <h4>Noch kein Trainingsplan</h4>
                                    <p>Erstelle deinen ersten personalisierten Trainingsplan</p>
                                    <a href="personal-training.html" class="btn-primary">
                                        <i class="fas fa-plus"></i>
                                        Trainingsplan erstellen
                                    </a>
                                </div>
                            </div>
                        </div>

                        <!-- Recent Workouts -->
                        <div class="recent-workouts-section">
                            <h4><i class="fas fa-history"></i> Letzte Workouts</h4>
                            <div id="recentWorkouts" class="workouts-list">
                                <div class="empty-state small">
                                    <p>Noch keine Workouts protokolliert</p>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Actions -->
                        <div class="training-actions">
                            <a href="personal-training.html" class="action-btn primary">
                                <i class="fas fa-plus"></i>
                                Neuer Trainingsplan
                            </a>
                            <button class="action-btn secondary" onclick="logWorkout()">
                                <i class="fas fa-check"></i>
                                Workout protokollieren
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Nutrition Tab -->
                <div class="tab-panel" id="nutrition">
                    <div class="nutrition-dashboard">
                        <div class="dashboard-header">
                            <h3><i class="fas fa-utensils"></i> Dein Ern√§hrungsplan</h3>
                            <p>Plane und tracke deine Ern√§hrung f√ºr optimale Ergebnisse</p>
                        </div>

                        <!-- Today's Summary -->
                        <div class="today-summary">
                            <h4><i class="fas fa-calendar-day"></i> Heute</h4>
                            <div class="calories-overview">
                                <div class="calories-ring">
                                    <svg class="calories-ring-svg" width="150" height="150">
                                        <circle cx="75" cy="75" r="65" fill="transparent" stroke="#e5e7eb" stroke-width="10"/>
                                        <circle id="caloriesRingFill" cx="75" cy="75" r="65" fill="transparent" stroke="#10b981" stroke-width="10" stroke-linecap="round" stroke-dasharray="408" stroke-dashoffset="408"/>
                                    </svg>
                                    <div class="calories-text">
                                        <span id="todaysCalories" class="calories-number">0</span>
                                        <span class="calories-label">/ <span id="calorieGoal">2000</span> kcal</span>
                                    </div>
                                </div>
                                <div class="macros-breakdown">
                                    <div class="macro-item">
                                        <div class="macro-bar protein">
                                            <div class="macro-fill" id="proteinFill" style="width: 0%"></div>
                                        </div>
                                        <span class="macro-label">Protein</span>
                                        <span id="todaysProtein" class="macro-value">0g</span>
                                    </div>
                                    <div class="macro-item">
                                        <div class="macro-bar carbs">
                                            <div class="macro-fill" id="carbsFill" style="width: 0%"></div>
                                        </div>
                                        <span class="macro-label">Kohlenhydrate</span>
                                        <span id="todaysCarbs" class="macro-value">0g</span>
                                    </div>
                                    <div class="macro-item">
                                        <div class="macro-bar fat">
                                            <div class="macro-fill" id="fatFill" style="width: 0%"></div>
                                        </div>
                                        <span class="macro-label">Fett</span>
                                        <span id="todaysFat" class="macro-value">0g</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Nutrition Stats -->
                        <div class="nutrition-stats-grid">
                            <div class="stat-card nutrition-stat">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                                    <i class="fas fa-utensils"></i>
                                </div>
                                <div class="stat-content">
                                    <h3 id="nutritionMealsLogged">0</h3>
                                    <p>Mahlzeiten geloggt</p>
                                </div>
                            </div>
                            <div class="stat-card nutrition-stat">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">
                                    <i class="fas fa-fire"></i>
                                </div>
                                <div class="stat-content">
                                    <h3 id="nutritionAvgCalories">0</h3>
                                    <p>√ò Kalorien/Tag</p>
                                </div>
                            </div>
                        </div>

                        <!-- Current Meal Plan -->
                        <div class="current-plan-section">
                            <h4><i class="fas fa-clipboard-list"></i> Aktueller Ern√§hrungsplan</h4>
                            <div id="currentNutritionPlan" class="plan-container">
                                <div class="empty-state">
                                    <div class="empty-state-icon">ü•ó</div>
                                    <h4>Noch kein Ern√§hrungsplan</h4>
                                    <p>Erstelle deinen ersten personalisierten Ern√§hrungsplan</p>
                                    <a href="ernaehrungsberatung.html" class="btn-primary">
                                        <i class="fas fa-plus"></i>
                                        Ern√§hrungsplan erstellen
                                    </a>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Actions -->
                        <div class="nutrition-actions">
                            <button class="action-btn primary" onclick="logMeal()">
                                <i class="fas fa-plus"></i>
                                Mahlzeit loggen
                            </button>
                            <a href="ernaehrungsberatung.html" class="action-btn secondary">
                                <i class="fas fa-calendar-alt"></i>
                                Plan erstellen
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Coach Tab -->
                <div class="tab-panel" id="coach">
                    <div class="coach-dashboard">
                        <div class="dashboard-header">
                            <h3><i class="fas fa-user-tie"></i> Dein Coach-Bereich</h3>
                            <p>Deine aggregierten Erfolge und Coaching-Empfehlungen</p>
                        </div>

                        <!-- Level & Points -->
                        <div class="level-section">
                            <div class="level-card">
                                <div class="level-badge">
                                    <span id="userLevel">1</span>
                                </div>
                                <div class="level-info">
                                    <h4>Level <span id="userLevelText">1</span></h4>
                                    <div class="level-progress">
                                        <div class="level-bar">
                                            <div id="levelProgressFill" class="level-fill" style="width: 0%"></div>
                                        </div>
                                        <span class="level-text"><span id="currentLevelPoints">0</span> / 100 Punkte</span>
                                    </div>
                                </div>
                                <div class="total-points">
                                    <span id="totalPoints">0</span>
                                    <span class="points-label">Gesamtpunkte</span>
                                </div>
                            </div>
                        </div>

                        <!-- Success Categories -->
                        <div class="success-categories">
                            <h4><i class="fas fa-chart-pie"></i> Erfolge nach Kategorie</h4>
                            <div class="categories-grid">
                                <div class="success-category" data-category="personality">
                                    <div class="category-icon">üß†</div>
                                    <div class="category-name">Pers√∂nlichkeit</div>
                                    <div class="category-stats">
                                        <span id="personalityAchievements">0</span> / 20
                                    </div>
                                </div>
                                <div class="success-category" data-category="training">
                                    <div class="category-icon">üí™</div>
                                    <div class="category-name">Training</div>
                                    <div class="category-stats">
                                        <span id="trainingAchievements">0</span> / 15
                                    </div>
                                </div>
                                <div class="success-category" data-category="nutrition">
                                    <div class="category-icon">ü•ó</div>
                                    <div class="category-name">Ern√§hrung</div>
                                    <div class="category-stats">
                                        <span id="nutritionAchievements">0</span> / 15
                                    </div>
                                </div>
                                <div class="success-category" data-category="applications">
                                    <div class="category-icon">üìù</div>
                                    <div class="category-name">Bewerbungen</div>
                                    <div class="category-stats">
                                        <span id="applicationsAchievements">0</span> / 10
                                    </div>
                                </div>
                                <div class="success-category" data-category="snowflakes">
                                    <div class="category-icon">‚ùÑÔ∏è</div>
                                    <div class="category-name">Schneeflocken</div>
                                    <div class="category-stats">
                                        <span id="snowflakesAchievements">0</span> / 10
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Recent Achievements -->
                        <div class="recent-achievements-section">
                            <h4><i class="fas fa-medal"></i> Neueste Erfolge</h4>
                            <div id="recentAchievementsList" class="achievements-list">
                                <div class="empty-state small">
                                    <p>Noch keine Erfolge freigeschaltet</p>
                                    <span>Starte deine Reise und sammle Erfolge!</span>
                                </div>
                            </div>
                        </div>

                        <!-- Coach Recommendations -->
                        <div class="recommendations-section">
                            <h4><i class="fas fa-lightbulb"></i> Empfehlungen f√ºr dich</h4>
                            <div id="coachRecommendations" class="recommendations-list">
                                <div class="recommendation-card">
                                    <div class="rec-icon">üéØ</div>
                                    <div class="rec-content">
                                        <h5>Starte mit Ikigai</h5>
                                        <p>Entdecke deine Leidenschaft und deinen Lebenszweck</p>
                                    </div>
                                    <a href="methods/ikigai/index-ikigai.html" class="rec-action">
                                        <i class="fas fa-arrow-right"></i>
                                    </a>
                                </div>
                                <div class="recommendation-card">
                                    <div class="rec-icon">üí™</div>
                                    <div class="rec-content">
                                        <h5>Erstelle einen Trainingsplan</h5>
                                        <p>Personalisiertes Training f√ºr deine Ziele</p>
                                    </div>
                                    <a href="personal-training.html" class="rec-action">
                                        <i class="fas fa-arrow-right"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Journal/Tagebuch Tab -->
                <div class="tab-panel" id="journal">
                    <div class="journal-dashboard">
                        <div class="dashboard-header">
                            <h3><i class="fas fa-book"></i> Dein Tagebuch</h3>
                            <p>Tracke deine Aktivit√§ten, Trainings und Gedanken</p>
                        </div>

                        <!-- Journal Stats -->
                        <div class="journal-stats-bar">
                            <div class="stat-item">
                                <i class="fas fa-calendar-check"></i>
                                <div class="stat-content">
                                    <h3 id="journalTotalEntries">0</h3>
                                    <p>Eintr√§ge gesamt</p>
                                </div>
                            </div>
                            <div class="stat-item">
                                <i class="fas fa-fire"></i>
                                <div class="stat-content">
                                    <h3 id="journalStreak">0</h3>
                                    <p>Tage Streak</p>
                                </div>
                            </div>
                            <div class="stat-item">
                                <i class="fas fa-calendar-day"></i>
                                <div class="stat-content">
                                    <h3 id="journalThisMonth">0</h3>
                                    <p>Diesen Monat</p>
                                </div>
                            </div>
                            <div class="stat-item">
                                <i class="fas fa-smile"></i>
                                <div class="stat-content">
                                    <h3 id="journalAvgMood">-</h3>
                                    <p>√ò Stimmung</p>
                                </div>
                            </div>
                        </div>

                        <!-- Activity Heatmap -->
                        <div class="journal-heatmap-section">
                            <div class="section-header">
                                <h4><i class="fas fa-th"></i> Aktivit√§ts-Heatmap</h4>
                                <div class="heatmap-legend">
                                    <span class="legend-label">Weniger</span>
                                    <div class="legend-colors">
                                        <span class="heat-0"></span>
                                        <span class="heat-1"></span>
                                        <span class="heat-2"></span>
                                        <span class="heat-3"></span>
                                        <span class="heat-4"></span>
                                    </div>
                                    <span class="legend-label">Mehr</span>
                                </div>
                            </div>
                            <div id="journalHeatmap" class="heatmap-container">
                                <!-- Wird dynamisch generiert -->
                            </div>
                        </div>

                        <!-- Selected Day View -->
                        <div class="journal-day-view">
                            <div class="day-header">
                                <button id="journalPrevDay" class="day-nav-btn"><i class="fas fa-chevron-left"></i></button>
                                <h4 id="journalSelectedDate">Heute</h4>
                                <button id="journalNextDay" class="day-nav-btn"><i class="fas fa-chevron-right"></i></button>
                            </div>
                            <div id="journalDayEntries" class="day-entries">
                                <div class="empty-state small">
                                    <i class="fas fa-calendar-times"></i>
                                    <p>Keine Eintr√§ge f√ºr diesen Tag</p>
                                    <span>F√ºge einen neuen Eintrag hinzu!</span>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Entry Section -->
                        <div class="journal-quick-entry">
                            <h4><i class="fas fa-plus-circle"></i> Schnelleintrag</h4>
                            <div class="quick-entry-types">
                                <button class="entry-type-btn active" data-type="journal" onclick="window.userProfile.setJournalEntryType('journal')">
                                    <i class="fas fa-pen"></i>
                                    <span>Journal</span>
                                </button>
                                <button class="entry-type-btn" data-type="training" onclick="window.userProfile.setJournalEntryType('training')">
                                    <i class="fas fa-dumbbell"></i>
                                    <span>Training</span>
                                </button>
                                <button class="entry-type-btn" data-type="sleep" onclick="window.userProfile.setJournalEntryType('sleep')">
                                    <i class="fas fa-bed"></i>
                                    <span>Schlaf</span>
                                </button>
                                <button class="entry-type-btn" data-type="meal" onclick="window.userProfile.setJournalEntryType('meal')">
                                    <i class="fas fa-utensils"></i>
                                    <span>Ern√§hrung</span>
                                </button>
                                <button class="entry-type-btn" data-type="mood" onclick="window.userProfile.setJournalEntryType('mood')">
                                    <i class="fas fa-smile"></i>
                                    <span>Stimmung</span>
                                </button>
                                <button class="entry-type-btn" data-type="note" onclick="window.userProfile.setJournalEntryType('note')">
                                    <i class="fas fa-sticky-note"></i>
                                    <span>Notiz</span>
                                </button>
                            </div>

                            <!-- Journal Entry Form -->
                            <div id="journalEntryForm" class="entry-form" data-type="journal">
                                <div class="form-group">
                                    <label for="journalTitle">Titel</label>
                                    <input type="text" id="journalTitle" placeholder="Was besch√§ftigt dich heute?">
                                </div>
                                <div class="form-group">
                                    <label for="journalContent">Inhalt</label>
                                    <textarea id="journalContent" rows="4" placeholder="Schreibe deine Gedanken..."></textarea>
                                </div>
                                
                                <!-- Mood Selector (f√ºr Journal & Mood Typ) -->
                                <div id="moodSelector" class="mood-selector">
                                    <label>Wie f√ºhlst du dich?</label>
                                    <div class="mood-options">
                                        <button type="button" class="mood-btn" data-mood="1" onclick="window.userProfile.selectMood(1)">üòû</button>
                                        <button type="button" class="mood-btn" data-mood="2" onclick="window.userProfile.selectMood(2)">üòï</button>
                                        <button type="button" class="mood-btn" data-mood="3" onclick="window.userProfile.selectMood(3)">üòê</button>
                                        <button type="button" class="mood-btn" data-mood="4" onclick="window.userProfile.selectMood(4)">üôÇ</button>
                                        <button type="button" class="mood-btn" data-mood="5" onclick="window.userProfile.selectMood(5)">üòÑ</button>
                                    </div>
                                </div>

                                <!-- Training Fields (f√ºr Training Typ) -->
                                <div id="trainingFields" class="training-fields" style="display: none;">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="trainingType">Art des Trainings</label>
                                            <select id="trainingType">
                                                <option value="strength">Krafttraining</option>
                                                <option value="cardio">Cardio</option>
                                                <option value="flexibility">Mobility/Yoga</option>
                                                <option value="hiit">HIIT</option>
                                                <option value="sport">Sport</option>
                                                <option value="other">Sonstiges</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label for="trainingDuration">Dauer (Min)</label>
                                            <input type="number" id="trainingDuration" placeholder="30" min="1">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="trainingIntensity">Intensit√§t</label>
                                        <div class="intensity-slider">
                                            <input type="range" id="trainingIntensity" min="1" max="10" value="5">
                                            <span id="intensityValue">5/10</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Sleep Fields (f√ºr Schlaf Typ) -->
                                <div id="sleepFields" class="sleep-fields" style="display: none;">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="sleepBedtime">Bettzeit</label>
                                            <input type="time" id="sleepBedtime" value="22:30">
                                        </div>
                                        <div class="form-group">
                                            <label for="sleepWakeup">Aufstehzeit</label>
                                            <input type="time" id="sleepWakeup" value="06:30">
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="sleepLastScreen">Letztes Bildschirm/Handy</label>
                                            <input type="time" id="sleepLastScreen" value="22:00">
                                        </div>
                                        <div class="form-group">
                                            <label for="sleepLastLight">Letztes Licht aus</label>
                                            <input type="time" id="sleepLastLight" value="22:30">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="sleepQuality">Schlafqualit√§t</label>
                                        <div class="quality-selector">
                                            <button type="button" class="quality-btn" data-quality="1" onclick="window.userProfile.selectSleepQuality(1)">üò¥ Schlecht</button>
                                            <button type="button" class="quality-btn" data-quality="2" onclick="window.userProfile.selectSleepQuality(2)">üòê Okay</button>
                                            <button type="button" class="quality-btn" data-quality="3" onclick="window.userProfile.selectSleepQuality(3)">üòä Gut</button>
                                            <button type="button" class="quality-btn" data-quality="4" onclick="window.userProfile.selectSleepQuality(4)">üåü Sehr gut</button>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="sleepInterruptions">Unterbrechungen</label>
                                        <select id="sleepInterruptions">
                                            <option value="0">Keine</option>
                                            <option value="1">1x aufgewacht</option>
                                            <option value="2">2x aufgewacht</option>
                                            <option value="3">3+ mal aufgewacht</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Meal Fields (f√ºr Ern√§hrung Typ) -->
                                <div id="mealFields" class="meal-fields" style="display: none;">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="mealType">Mahlzeit</label>
                                            <select id="mealType">
                                                <option value="breakfast">Fr√ºhst√ºck</option>
                                                <option value="lunch">Mittagessen</option>
                                                <option value="dinner">Abendessen</option>
                                                <option value="snack">Snack</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label for="mealTime">Uhrzeit</label>
                                            <input type="time" id="mealTime" value="12:00">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="mealDescription">Was hast du gegessen?</label>
                                        <textarea id="mealDescription" rows="2" placeholder="z.B. Haferflocken mit Obst und N√ºssen"></textarea>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="mealCalories">Gesch√§tzte Kalorien</label>
                                            <input type="number" id="mealCalories" placeholder="500" min="0">
                                        </div>
                                        <div class="form-group">
                                            <label for="mealProtein">Protein (g)</label>
                                            <input type="number" id="mealProtein" placeholder="30" min="0">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>Zufriedenheit mit der Mahlzeit</label>
                                        <div class="satisfaction-selector">
                                            <button type="button" class="satisfaction-btn" data-satisfaction="1" onclick="window.userProfile.selectMealSatisfaction(1)">üëé</button>
                                            <button type="button" class="satisfaction-btn" data-satisfaction="2" onclick="window.userProfile.selectMealSatisfaction(2)">üòê</button>
                                            <button type="button" class="satisfaction-btn" data-satisfaction="3" onclick="window.userProfile.selectMealSatisfaction(3)">üëç</button>
                                            <button type="button" class="satisfaction-btn" data-satisfaction="4" onclick="window.userProfile.selectMealSatisfaction(4)">ü§©</button>
                                        </div>
                                    </div>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="mealSyncToNutrition" checked>
                                        <span class="checkmark"></span>
                                        Automatisch zum Ern√§hrungs-Tab hinzuf√ºgen
                                    </label>
                                </div>

                                <div class="form-group">
                                    <label for="journalTags">Tags (kommagetrennt)</label>
                                    <input type="text" id="journalTags" placeholder="meditation, morgenroutine">
                                </div>

                                <button type="button" class="btn-primary" onclick="window.userProfile.saveJournalEntry()">
                                    <i class="fas fa-save"></i>
                                    Eintrag speichern
                                </button>
                            </div>
                        </div>

                        <!-- Recent Entries -->
                        <div class="journal-recent-section">
                            <h4><i class="fas fa-history"></i> Letzte Eintr√§ge</h4>
                            <div id="journalRecentEntries" class="recent-entries-list">
                                <div class="empty-state small">
                                    <i class="fas fa-book-open"></i>
                                    <p>Noch keine Eintr√§ge</p>
                                    <span>Starte mit deinem ersten Tagebucheintrag!</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- AWS Configuration -->
    <script>
        window.AWS_CONFIG = {
            region: 'eu-central-1',
            userPoolId: 'eu-central-1_8gP4gLK9r',
            clientId: '7kc5tt6a23fgh53d60vkefm812',
            apiBaseUrl: 'https://of2iwj7h2c.execute-api.eu-central-1.amazonaws.com/prod',
            dynamoDB: {
                tableName: 'mawps-user-profiles',
                region: 'eu-central-1'
            }
        };
        
        // Initialize AWS with configuration
        if (typeof AWS !== 'undefined') {
            AWS.config.update({
                region: window.AWS_CONFIG.region
            });
            window.AWS_COGNITO_CONFIG = {
                UserPoolId: window.AWS_CONFIG.userPoolId,
                ClientId: window.AWS_CONFIG.clientId
            };
        }
    </script>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1490.0.min.js"></script>
    <script src="js/unified-aws-auth.js?v=20260112k"></script>
    <script src="js/unified-auth-modals.js?v=20260112"></script>
    <script src="js/real-user-auth-system.js?v=20250116"></script>
    <script src="js/aws-profile-api.js"></script>
    <script src="js/aws-training-api.js"></script>
    <script src="js/aws-nutrition-api.js"></script>
    <script src="js/aws-achievements-api.js"></script>
    <script src="js/aws-applications-api.js"></script>
    <script src="js/aws-journal-api.js?v=20260112"></script>
    <script src="js/success-checkmark.js?v=20260112"></script>
    <script src="js/user-profile.js?v=20260112o"></script>
    <script>
        // Tab Data Loading Functions
        async function loadTrainingTabData() {
            if (!window.awsTrainingAPI) return;
            try {
                const data = await window.awsTrainingAPI.loadTraining();
                
                // Update stats
                document.getElementById('trainingTotalWorkouts').textContent = data.stats?.totalWorkouts || 0;
                document.getElementById('trainingCurrentStreak').textContent = data.stats?.currentStreak || 0;
                document.getElementById('trainingTotalMinutes').textContent = data.stats?.totalMinutes || 0;
                document.getElementById('trainingLongestStreak').textContent = data.stats?.longestStreak || 0;
                
                // Update current plan
                if (data.currentPlan) {
                    const planContainer = document.getElementById('currentTrainingPlan');
                    planContainer.innerHTML = `
                        <div class="plan-card">
                            <h5>${data.currentPlan.title || 'Mein Trainingsplan'}</h5>
                            <p>${data.currentPlan.frequency || '3x'} pro Woche, ${data.currentPlan.timePerSession || '45'} Min</p>
                            <a href="personal-training.html?view=current" class="btn-link">Plan ansehen</a>
                        </div>
                    `;
                }
                
                // Update recent workouts
                if (data.workouts && data.workouts.length > 0) {
                    const workoutsList = document.getElementById('recentWorkouts');
                    workoutsList.innerHTML = data.workouts.slice(0, 5).map(w => `
                        <div class="workout-item">
                            <div class="workout-icon"><i class="fas fa-dumbbell"></i></div>
                            <div class="workout-info">
                                <h5>${w.planId || 'Workout'}</h5>
                                <span>${w.duration || 0} Min</span>
                            </div>
                            <div class="workout-date">${new Date(w.date).toLocaleDateString('de-DE')}</div>
                        </div>
                    `).join('');
                }
            } catch (error) {
                console.error('Error loading training data:', error);
            }
        }
        
        async function loadNutritionTabData() {
            if (!window.awsNutritionAPI) return;
            try {
                const summary = await window.awsNutritionAPI.getTodaysSummary();
                const stats = await window.awsNutritionAPI.getStats();
                
                // Update today's calories
                document.getElementById('todaysCalories').textContent = summary.calories || 0;
                document.getElementById('calorieGoal').textContent = summary.goal || 2000;
                
                // Update macros
                document.getElementById('todaysProtein').textContent = (summary.macros?.protein || 0) + 'g';
                document.getElementById('todaysCarbs').textContent = (summary.macros?.carbs || 0) + 'g';
                document.getElementById('todaysFat').textContent = (summary.macros?.fat || 0) + 'g';
                
                // Update calories ring
                const progress = Math.min((summary.calories / summary.goal) * 100, 100);
                const circumference = 2 * Math.PI * 65;
                const offset = circumference - (progress / 100) * circumference;
                document.getElementById('caloriesRingFill').style.strokeDashoffset = offset;
                
                // Update stats
                document.getElementById('nutritionMealsLogged').textContent = stats.mealsLogged || 0;
                document.getElementById('nutritionAvgCalories').textContent = stats.avgCaloriesPerDay || 0;
            } catch (error) {
                console.error('Error loading nutrition data:', error);
            }
        }
        
        async function loadCoachTabData() {
            if (!window.awsAchievementsAPI) return;
            try {
                const achievements = await window.awsAchievementsAPI.loadAchievements();
                const levelProgress = await window.awsAchievementsAPI.getLevelProgress();
                
                // Update level display
                document.getElementById('userLevel').textContent = levelProgress.level;
                document.getElementById('userLevelText').textContent = levelProgress.level;
                document.getElementById('currentLevelPoints').textContent = levelProgress.currentLevelPoints;
                document.getElementById('totalPoints').textContent = levelProgress.totalPoints;
                document.getElementById('levelProgressFill').style.width = levelProgress.progress + '%';
                
                // Update category stats
                if (achievements.categories) {
                    document.getElementById('personalityAchievements').textContent = achievements.categories.personality?.unlocked || 0;
                    document.getElementById('trainingAchievements').textContent = achievements.categories.training?.unlocked || 0;
                    document.getElementById('nutritionAchievements').textContent = achievements.categories.nutrition?.unlocked || 0;
                    document.getElementById('applicationsAchievements').textContent = achievements.categories.applications?.unlocked || 0;
                    document.getElementById('snowflakesAchievements').textContent = achievements.categories.snowflakes?.unlocked || 0;
                }
                
                // Update recent achievements
                if (achievements.achievements && achievements.achievements.length > 0) {
                    const recentList = document.getElementById('recentAchievementsList');
                    recentList.innerHTML = achievements.achievements.slice(0, 5).map(a => `
                        <div class="achievement-item">
                            <div class="achievement-icon">${a.icon}</div>
                            <div class="achievement-info">
                                <h5>${a.title}</h5>
                                <span>${a.description}</span>
                            </div>
                            <div class="achievement-points">+${a.points}</div>
                        </div>
                    `).join('');
                }
            } catch (error) {
                console.error('Error loading coach data:', error);
            }
        }
        
        // Log workout modal
        function logWorkout() {
            const modal = document.createElement('div');
            modal.className = 'modal-overlay';
            modal.innerHTML = `
                <div class="modal-content">
                    <h3>Workout protokollieren</h3>
                    <div class="form-group">
                        <label>Dauer (Minuten)</label>
                        <input type="number" id="workoutDuration" value="30" min="1">
                    </div>
                    <div class="form-group">
                        <label>Notizen</label>
                        <textarea id="workoutNotes" rows="3"></textarea>
                    </div>
                    <div class="modal-actions">
                        <button class="btn-secondary" onclick="this.closest('.modal-overlay').remove()">Abbrechen</button>
                        <button class="btn-primary" onclick="saveWorkout()">Speichern</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        async function saveWorkout() {
            const duration = parseInt(document.getElementById('workoutDuration').value) || 30;
            const notes = document.getElementById('workoutNotes').value;
            
            try {
                await window.awsTrainingAPI.logWorkout({
                    duration,
                    notes,
                    completed: true
                });
                document.querySelector('.modal-overlay').remove();
                loadTrainingTabData();
                showNotification('Workout erfolgreich protokolliert!', 'success');
            } catch (error) {
                showNotification('Fehler beim Speichern', 'error');
            }
        }
        
        // Log meal modal
        function logMeal() {
            const modal = document.createElement('div');
            modal.className = 'modal-overlay';
            modal.innerHTML = `
                <div class="modal-content">
                    <h3>Mahlzeit loggen</h3>
                    <div class="form-group">
                        <label>Mahlzeit</label>
                        <select id="mealType">
                            <option value="breakfast">Fr√ºhst√ºck</option>
                            <option value="lunch">Mittagessen</option>
                            <option value="dinner">Abendessen</option>
                            <option value="snack">Snack</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Beschreibung</label>
                        <input type="text" id="mealName" placeholder="Was hast du gegessen?">
                    </div>
                    <div class="form-group">
                        <label>Kalorien (gesch√§tzt)</label>
                        <input type="number" id="mealCalories" value="400" min="1">
                    </div>
                    <div class="modal-actions">
                        <button class="btn-secondary" onclick="this.closest('.modal-overlay').remove()">Abbrechen</button>
                        <button class="btn-primary" onclick="saveMeal()">Speichern</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        async function saveMeal() {
            const type = document.getElementById('mealType').value;
            const name = document.getElementById('mealName').value;
            const calories = parseInt(document.getElementById('mealCalories').value) || 400;
            
            try {
                await window.awsNutritionAPI.logMeal({
                    type,
                    name,
                    calories
                });
                document.querySelector('.modal-overlay').remove();
                loadNutritionTabData();
                showNotification('Mahlzeit erfolgreich geloggt!', 'success');
            } catch (error) {
                showNotification('Fehler beim Speichern', 'error');
            }
        }
        
        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `<span>${message}</span>`;
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 3000);
        }
        
        // Tab change handler
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', async () => {
                    const tab = btn.dataset.tab;
                    
                    // Load tab-specific data
                    if (tab === 'training') loadTrainingTabData();
                    if (tab === 'nutrition') loadNutritionTabData();
                    if (tab === 'coach') loadCoachTabData();
                });
            });
        });
        
        // Auth-Button Funktionen
        function showLoginModal() {
            if (window.authModals) {
                window.authModals.showLogin();
            } else if (window.realUserAuth && window.realUserAuth.showLoginModal) {
                window.realUserAuth.showLoginModal();
            } else {
                console.error('Kein Auth-Modal System verf√ºgbar');
                alert('Bitte nutzen Sie die Anmeldeseite unter Pers√∂nlichkeitsentwicklung');
            }
        }
        
        function updateProfileAuthUI() {
            const authButton = document.getElementById('profileAuthButton');
            const authText = document.getElementById('profileAuthText');
            
            if (!authButton || !authText) return;
            
            let isLoggedIn = false;
            let userName = '';
            
            // Check awsAuth first (main auth system), then fallbacks
            if (window.awsAuth && window.awsAuth.isLoggedIn()) {
                isLoggedIn = true;
                const user = window.awsAuth.getCurrentUser();
                userName = user?.name || user?.firstName || user?.email?.split('@')[0] || 'Profil';
            } else if (window.unifiedAuth && window.unifiedAuth.isLoggedIn()) {
                isLoggedIn = true;
                const user = window.unifiedAuth.getCurrentUser();
                userName = user?.name || user?.firstName || user?.email?.split('@')[0] || 'Profil';
            } else if (window.realUserAuth && window.realUserAuth.isLoggedIn()) {
                isLoggedIn = true;
                const user = window.realUserAuth.getCurrentUser();
                userName = user?.name || user?.firstName || user?.email?.split('@')[0] || 'Profil';
            }
            
            if (isLoggedIn) {
                authButton.classList.add('logged-in');
                authText.textContent = userName.length > 12 ? userName.substring(0, 12) + '...' : userName;
                // Entferne onclick, damit kein Modal erscheint - im Profil ist man bereits
                authButton.onclick = null;
                authButton.style.cursor = 'default';
            } else {
                authButton.classList.remove('logged-in');
                authText.textContent = 'Anmelden';
                authButton.onclick = showLoginModal;
                authButton.style.cursor = 'pointer';
            }
        }
        
        function handleLogout() {
            if (confirm('M√∂chten Sie sich wirklich abmelden?')) {
                if (window.awsAuth) {
                    window.awsAuth.logout();
                } else if (window.unifiedAuth) {
                    window.unifiedAuth.logout();
                } else if (window.realUserAuth) {
                    window.realUserAuth.logout();
                }
                updateProfileAuthUI();
                window.location.reload();
            }
        }
        
        // Update auth UI on page load and after auth events
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(updateProfileAuthUI, 500);
        });
        
        // Listen for auth changes
        window.addEventListener('auth-state-changed', updateProfileAuthUI);
        window.addEventListener('storage', (e) => {
            if (e.key === 'aws_auth_session') {
                updateProfileAuthUI();
                // Reload profile data after login
                if (window.userProfile) {
                    window.userProfile.loadProfileDataFromAWS();
                }
            }
        });
        
        // Intelligente Zur√ºck-Navigation
        function goBack() {
            // Pr√ºfe ob es einen sinnvollen Referrer gibt
            const referrer = document.referrer;
            
            if (referrer) {
                // Wenn von einer internen Seite gekommen
                const isInternal = referrer.includes(window.location.hostname) || 
                                   referrer.includes('manuel-weiss.ch') ||
                                   referrer.includes('localhost');
                
                if (isInternal) {
                    // Zur√ºck zur vorherigen Seite
                    history.back();
                    return;
                }
            }
            
            // Fallback: Pr√ºfe ob von Bewerbungsmanager oder Pers√∂nlichkeitsentwicklung
            const urlParams = new URLSearchParams(window.location.search);
            const source = urlParams.get('source');
            
            if (source === 'dashboard' || source === 'bewerbungsmanager') {
                window.location.href = 'applications/dashboard.html';
            } else if (source === 'coaching') {
                window.location.href = 'applications/coaching.html';
            } else {
                // Standard-Fallback: Pers√∂nlichkeitsentwicklung
                window.location.href = 'persoenlichkeitsentwicklung-uebersicht.html';
            }
        }
    </script>
</body>
</html>
