<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bewerbung - Manuel Weiss</title>
    
    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <style>
        /* Modern HR Application Page - Swiss/German Best Practices */
        :root {
            --primary: #1e40af;
            --primary-light: #3b82f6;
            --secondary: #059669;
            --accent: #dc2626;
            --neutral-50: #f8fafc;
            --neutral-100: #f1f5f9;
            --neutral-200: #e2e8f0;
            --neutral-300: #cbd5e1;
            --neutral-400: #94a3b8;
            --neutral-500: #64748b;
            --neutral-600: #475569;
            --neutral-700: #334155;
            --neutral-800: #1e293b;
            --neutral-900: #0f172a;
            --white: #ffffff;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            --radius-2xl: 1.5rem;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--neutral-800);
            background: var(--neutral-50);
        }

        /* Header with Company Branding */
        .application-header {
            background: var(--white);
            border-bottom: 1px solid var(--neutral-200);
            padding: 2rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow-sm);
        }

        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .company-branding {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .company-logo {
            width: 60px;
            height: 60px;
            border-radius: var(--radius-lg);
            background: var(--neutral-100);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            border: 2px solid var(--neutral-200);
            position: relative;
            overflow: hidden;
        }

        .company-logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .company-logo .fallback-text {
            font-size: 1.2rem;
            font-weight: 800;
        }

        .company-info h1 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--neutral-900);
            margin-bottom: 0.25rem;
        }

        .company-info .position {
            font-size: 1rem;
            color: var(--neutral-600);
            font-weight: 500;
        }

        .application-meta {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--neutral-600);
            font-size: 0.875rem;
        }

        .meta-item i {
            color: var(--primary);
        }

        /* Main Content */
        .application-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 3rem 2rem;
        }

        .content-grid {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 3rem;
            align-items: start;
        }

        /* Left Column - Application Details */
        .application-details {
            background: var(--white);
            border-radius: var(--radius-2xl);
            padding: 2.5rem;
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--neutral-200);
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--neutral-100);
        }

        .section-header h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--neutral-900);
        }

        .section-header i {
            color: var(--primary);
            font-size: 1.25rem;
        }

        /* Cover Letter */
        .cover-letter {
            background: var(--white);
            border-radius: var(--radius-xl);
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--neutral-200);
        }

        .cover-letter-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }

        .cover-letter-header h3 {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--neutral-900);
        }

        .ai-badge {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: var(--white);
            padding: 0.375rem 0.75rem;
            border-radius: var(--radius-lg);
            font-size: 0.75rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.375rem;
        }

        .cover-letter-content {
            line-height: 1.8;
            color: var(--neutral-700);
            font-size: 1rem;
            white-space: pre-wrap;
        }

        /* Right Column - Candidate Profile */
        .candidate-profile {
            background: var(--white);
            border-radius: var(--radius-2xl);
            padding: 2.5rem;
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--neutral-200);
            position: sticky;
            top: 120px;
        }

        .candidate-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .candidate-photo {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin: 0 auto 1rem;
            background: var(--neutral-100);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: var(--neutral-400);
            border: 4px solid var(--white);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
        }

        .candidate-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .candidate-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--neutral-900);
            margin-bottom: 0.5rem;
        }

        .candidate-title {
            color: var(--neutral-600);
            font-size: 1rem;
            font-weight: 500;
        }

        /* Contact Info */
        .contact-info {
            margin-bottom: 2rem;
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--neutral-100);
        }

        .contact-item:last-child {
            border-bottom: none;
        }

        .contact-item i {
            color: var(--primary);
            width: 20px;
            text-align: center;
        }

        .contact-item span {
            color: var(--neutral-700);
            font-size: 0.875rem;
        }

        /* Certificates */
        .certificates-section {
            margin-bottom: 2rem;
        }

        .certificates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .certificate-card {
            background: var(--white);
            border: 1px solid var(--neutral-200);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .certificate-card:hover {
            border-color: var(--primary);
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .certificate-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .certificate-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .certificate-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--neutral-900);
            line-height: 1.4;
        }

        .certificate-download {
            background: var(--primary);
            color: var(--white);
            border: none;
            border-radius: var(--radius-md);
            padding: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
        }

        .certificate-download:hover {
            background: var(--primary-light);
            transform: scale(1.1);
        }

        .certificate-info {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .certificate-info-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: var(--neutral-600);
        }

        .certificate-info-item i {
            color: var(--primary);
            width: 16px;
        }

        .certificate-description {
            font-size: 0.875rem;
            color: var(--neutral-600);
            line-height: 1.5;
            margin-top: 0.5rem;
        }

        .certificate-preview {
            width: 100%;
            height: 120px;
            background: var(--neutral-50);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 1rem;
            border: 1px solid var(--neutral-200);
            overflow: hidden;
            position: relative;
        }

        .certificate-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .certificate-preview .fallback {
            color: var(--neutral-400);
            text-align: center;
        }

        .certificate-preview .fallback i {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            display: block;
        }

        .certificate-preview .overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .certificate-preview:hover .overlay {
            opacity: 1;
        }

        .certificate-preview .overlay button {
            background: var(--white);
            color: var(--neutral-900);
            border: none;
            border-radius: var(--radius-md);
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .certificate-preview .overlay button:hover {
            background: var(--primary);
            color: var(--white);
        }

        /* Upload Sections Responsive */
        @media (max-width: 768px) {
            .upload-sections {
                grid-template-columns: 1fr !important;
                gap: 1rem !important;
            }
            
            .upload-section {
                padding: 1rem !important;
            }
        }

        /* Skills */
        .skills-section {
            margin-bottom: 2rem;
        }

        .skills-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
        }

        .skill-item {
            background: var(--neutral-50);
            padding: 0.75rem 1rem;
            border-radius: var(--radius-md);
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--neutral-700);
            text-align: center;
            border: 1px solid var(--neutral-200);
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 2rem;
        }

        .btn {
            padding: 1rem 1.5rem;
            border-radius: var(--radius-lg);
            font-weight: 600;
            font-size: 0.875rem;
            text-decoration: none;
            text-align: center;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--primary);
            color: var(--white);
        }

        .btn-primary:hover {
            background: var(--primary-light);
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: var(--white);
            color: var(--neutral-700);
            border: 2px solid var(--neutral-200);
        }

        .btn-secondary:hover {
            background: var(--neutral-50);
            border-color: var(--neutral-300);
        }

        .btn-success {
            background: var(--secondary);
            color: var(--white);
        }

        .btn-success:hover {
            background: #047857;
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        /* Experience Section */
        .experience-item {
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--neutral-100);
        }

        .experience-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .experience-title {
            font-size: 1.125rem;
            font-weight: 700;
            color: var(--neutral-900);
            margin-bottom: 0.5rem;
        }

        .experience-company {
            color: var(--primary);
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .experience-period {
            color: var(--neutral-500);
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .experience-description {
            color: var(--neutral-700);
            line-height: 1.6;
        }

        /* Education Section */
        .education-item {
            margin-bottom: 1.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--neutral-100);
        }

        .education-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .education-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--neutral-900);
            margin-bottom: 0.25rem;
        }

        .education-institution {
            color: var(--primary);
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .education-period {
            color: var(--neutral-500);
            font-size: 0.875rem;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .content-grid {
                grid-template-columns: 1fr;
                gap: 2rem;
            }

            .candidate-profile {
                position: static;
            }
        }

        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }

            .application-meta {
                flex-direction: column;
                gap: 1rem;
            }

            .application-content {
                padding: 2rem 1rem;
            }

            .application-details,
            .candidate-profile {
                padding: 1.5rem;
            }

            .skills-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Loading States */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            color: var(--neutral-500);
        }

        .loading i {
            animation: spin 1s linear infinite;
            margin-right: 0.5rem;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Error States */
        .error {
            background: #fef2f2;
            border: 1px solid #fecaca;
            color: #dc2626;
            padding: 1rem;
            border-radius: var(--radius-lg);
            margin: 1rem 0;
        }

        /* Success States */
        .success {
            background: #f0fdf4;
            border: 1px solid #bbf7d0;
            color: #059669;
            padding: 1rem;
            border-radius: var(--radius-lg);
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <!-- Header with Company Branding -->
    <header class="application-header">
        <div class="header-container">
            <div class="company-branding">
                <div class="company-logo" id="companyLogo">
                    <div class="fallback-text" id="companyInitials">MW</div>
                </div>
                <div class="company-info">
                    <h1 id="companyName">Manuel Weiss</h1>
                    <div class="position" id="applicationPosition">HR-Tech Consultant</div>
                </div>
            </div>
            <div class="application-meta">
                <div class="meta-item">
                    <i class="fas fa-calendar"></i>
                    <span id="applicationDate">-</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-eye"></i>
                    <span id="viewCount">0 Aufrufe</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-clock"></i>
                    <span id="lastViewed">-</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="application-content">
        <div class="content-grid">
            <!-- Left Column - Application Details -->
            <div class="application-details">
                <!-- Cover Letter Section -->
                <div class="cover-letter">
                    <div class="cover-letter-header">
                        <h3><i class="fas fa-file-alt"></i> Anschreiben</h3>
                        <div class="ai-badge" id="aiBadge" style="display: none;">
                            <i class="fas fa-robot"></i>
                            KI-generiert
                        </div>
                    </div>
                    <div class="cover-letter-content" id="coverLetterContent">
                        <div class="loading">
                            <i class="fas fa-spinner"></i>
                            Lade Anschreiben...
                        </div>
                    </div>
                </div>

                <!-- About Me Section -->
                <div class="section-header">
                    <i class="fas fa-user"></i>
                    <h2>Über mich</h2>
                </div>
                <div class="about-content">
                    <p>Ich bin ein erfahrener HR-Tech Consultant mit über 5 Jahren Berufserfahrung in der digitalen Transformation von HR-Prozessen. Meine Expertise liegt in der Implementierung moderner HR-Technologien, der Optimierung von Recruiting-Prozessen und der Entwicklung innovativer Lösungen für Unternehmen aller Größenordnungen.</p>
                    <p>Durch meine Arbeit habe ich bereits zahlreiche Unternehmen dabei unterstützt, ihre HR-Abteilungen zu digitalisieren und effizienter zu gestalten. Dabei lege ich besonderen Wert auf benutzerfreundliche Lösungen und nachhaltige Implementierungen.</p>
                </div>

                <!-- Skills Section -->
                <div class="section-header">
                    <i class="fas fa-cogs"></i>
                    <h2>Kompetenzen</h2>
                </div>
                <div class="skills-grid">
                    <div class="skill-item">HR-Tech Beratung</div>
                    <div class="skill-item">Prozessoptimierung</div>
                    <div class="skill-item">Digital Transformation</div>
                    <div class="skill-item">Recruiting Automation</div>
                    <div class="skill-item">Change Management</div>
                    <div class="skill-item">Data Analytics</div>
                    <div class="skill-item">Project Management</div>
                    <div class="skill-item">Stakeholder Management</div>
                </div>

                <!-- Experience Section -->
                <div class="section-header">
                    <i class="fas fa-briefcase"></i>
                    <h2>Berufserfahrung</h2>
                </div>
                <div class="experience-item">
                    <div class="experience-title">Senior HR-Tech Consultant</div>
                    <div class="experience-company">TechConsult GmbH</div>
                    <div class="experience-period">2021 - heute</div>
                    <div class="experience-description">
                        Leitung von Digitalisierungsprojekten für HR-Abteilungen mittelständischer Unternehmen. Implementierung von ATS-Systemen, Entwicklung von Recruiting-Strategien und Schulung von HR-Teams.
                    </div>
                </div>
                <div class="experience-item">
                    <div class="experience-title">HR-Tech Consultant</div>
                    <div class="experience-company">InnovateHR AG</div>
                    <div class="experience-period">2019 - 2021</div>
                    <div class="experience-description">
                        Beratung von Unternehmen bei der Auswahl und Implementierung von HR-Software. Spezialisierung auf Recruiting-Tools und Employee Experience Plattformen.
                    </div>
                </div>
                <div class="experience-item">
                    <div class="experience-title">HR Analyst</div>
                    <div class="experience-company">DataDriven HR</div>
                    <div class="experience-period">2018 - 2019</div>
                    <div class="experience-description">
                        Analyse von HR-Daten und Entwicklung von Dashboards für HR-Reporting. Unterstützung bei der Implementierung von HR-Analytics-Tools.
                    </div>
                </div>

                <!-- Education Section -->
                <div class="section-header">
                    <i class="fas fa-graduation-cap"></i>
                    <h2>Ausbildung</h2>
                </div>
                <div class="education-item">
                    <div class="education-title">Bachelor of Science in Wirtschaftsinformatik</div>
                    <div class="education-institution">Universität Zürich</div>
                    <div class="education-period">2014 - 2018</div>
                </div>
                <div class="education-item">
                    <div class="education-title">Zertifikat HR Analytics</div>
                    <div class="education-institution">HR Academy Switzerland</div>
                    <div class="education-period">2020</div>
                </div>
            </div>

            <!-- Right Column - Candidate Profile -->
            <div class="candidate-profile">
                <div class="candidate-header">
                    <div class="candidate-photo" id="candidatePhoto">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="candidate-name">Manuel Weiss</div>
                    <div class="candidate-title">HR-Tech Consultant</div>
                </div>

                <div class="contact-info">
                    <div class="contact-item">
                        <i class="fas fa-envelope"></i>
                        <span>manuel.weiss@email.com</span>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-phone"></i>
                        <span>+41 44 123 45 67</span>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>Zürich, Schweiz</span>
                    </div>
                    <div class="contact-item">
                        <i class="fab fa-linkedin"></i>
                        <span>linkedin.com/in/manuelweiss</span>
                    </div>
                </div>

                <div class="certificates-section">
                    <h3>📜 Zeugnisse & Dokumente</h3>
                    
                    <!-- Upload-Bereiche für verschiedene Dokumenttypen -->
                    <div class="upload-sections" style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem;">
                        <!-- Lebenslauf Upload -->
                        <div class="upload-section" style="background: var(--neutral-50); padding: 1.5rem; border-radius: var(--radius-lg); border: 2px dashed var(--neutral-300);">
                            <h4 style="margin: 0 0 1rem 0; color: var(--neutral-800); display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-file-pdf" style="color: var(--primary);"></i>
                                Lebenslauf hochladen
                            </h4>
                            <input type="file" id="cvUpload" accept=".pdf,.doc,.docx" style="width: 100%; padding: 0.75rem; border: 1px solid var(--neutral-300); border-radius: var(--radius-md); background: white; margin-bottom: 1rem;" />
                            <button id="btnCvUpload" style="background: var(--primary); color: white; border: none; border-radius: var(--radius-md); padding: 0.75rem 1.5rem; cursor: pointer; font-weight: 500; display: flex; align-items: center; gap: 0.5rem; width: 100%; justify-content: center;">
                                <i class="fas fa-upload"></i> Lebenslauf hochladen
                            </button>
                            <p style="font-size: 0.875rem; color: var(--neutral-600); margin: 0.5rem 0 0 0;">PDF, DOC, DOCX bis 10MB</p>
                        </div>
                        
                        <!-- Zeugnisse Upload -->
                        <div class="upload-section" style="background: var(--neutral-50); padding: 1.5rem; border-radius: var(--radius-lg); border: 2px dashed var(--neutral-300);">
                            <h4 style="margin: 0 0 1rem 0; color: var(--neutral-800); display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-certificate" style="color: var(--secondary);"></i>
                                Zeugnisse hochladen
                            </h4>
                            <input type="file" id="certificateUpload" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png" multiple style="width: 100%; padding: 0.75rem; border: 1px solid var(--neutral-300); border-radius: var(--radius-md); background: white; margin-bottom: 1rem;" />
                            <button id="btnCertificateUpload" style="background: var(--secondary); color: white; border: none; border-radius: var(--radius-md); padding: 0.75rem 1.5rem; cursor: pointer; font-weight: 500; display: flex; align-items: center; gap: 0.5rem; width: 100%; justify-content: center;">
                                <i class="fas fa-upload"></i> Zeugnisse hochladen
                            </button>
                            <p style="font-size: 0.875rem; color: var(--neutral-600); margin: 0.5rem 0 0 0;">PDF, DOC, DOCX, JPG, PNG bis 10MB</p>
                        </div>
                    </div>
                    
                    <div class="certificates-grid" id="certificatesGrid">
                        <!-- Wird dynamisch gefüllt -->
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" data-action="schedule-interview">
                        <i class="fas fa-calendar-plus"></i>
                        Interview terminieren
                    </button>
                    <button class="btn btn-success" data-action="accept-application">
                        <i class="fas fa-check"></i>
                        Bewerbung annehmen
                    </button>
                    <button class="btn btn-secondary" data-action="download-c-v">
                        <i class="fas fa-download"></i>
                        Lebenslauf herunterladen
                    </button>
                    <button class="btn btn-secondary" data-action="send-message">
                        <i class="fas fa-envelope"></i>
                        Nachricht senden
                    </button>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Application Viewer Class
        class ApplicationViewer {
            constructor() {
                this.applicationId = this.getApplicationIdFromUrl();
                this.application = null;
                this.init();
            }

            init() {
                this.loadApplicationData();
                this.setupEventListeners();
            }

            getApplicationIdFromUrl() {
                const urlParams = new URLSearchParams(window.location.search);
                return urlParams.get('id');
            }

            async loadApplicationData() {
                if (!this.applicationId) {
                    this.showError('Keine Bewerbungs-ID gefunden.');
                    return;
                }

                try {
                    // Load application data from localStorage
                    const applications = JSON.parse(localStorage.getItem('applications') || '[]');
                    this.application = applications.find(app => app.id == this.applicationId);

                    if (!this.application) {
                        this.showError('Bewerbung nicht gefunden.');
                        return;
                    }

                    this.updateViewCount();
                    this.displayApplication();
                    this.loadCompanyBranding();
                    this.loadCertificates();
                } catch (error) {
                    console.error('Error loading application:', error);
                    this.showError('Fehler beim Laden der Bewerbung.');
                }
            }

            updateViewCount() {
                const key = `application_views_${this.applicationId}`;
                let viewCount = parseInt(localStorage.getItem(key) || '0') + 1;
                localStorage.setItem(key, viewCount);
                localStorage.setItem(`application_last_view_${this.applicationId}`, new Date().toISOString());
                
                document.getElementById('viewCount').textContent = `${viewCount} Aufrufe`;
                document.getElementById('lastViewed').textContent = 'Gerade eben';
                
                console.log(`Application ${this.applicationId} viewed. Total views: ${viewCount}`);
            }

            loadCertificates() {
                const hrDesignData = JSON.parse(localStorage.getItem('hrDesignData') || '{}');
                const certificates = hrDesignData.certificates || [];
                
                const certificatesGrid = document.getElementById('certificatesGrid');
                if (!certificatesGrid) return;
                
                certificatesGrid.innerHTML = '';
                
                certificates.forEach(cert => {
                    const certElement = this.createCertificateElement(cert);
                    certificatesGrid.appendChild(certElement);
                });
            }

            createCertificateElement(cert) {
                const div = document.createElement('div');
                div.className = 'certificate-card';
                div.innerHTML = `
                    <div class="certificate-header">
                        <div class="certificate-title">${cert.title}</div>
                        <button class="certificate-download" data-action="download-certificate" data-param="${cert.id}" title="Download">
                            <i class="fas fa-download"></i>
                        </button>
                    </div>
                    <div class="certificate-info">
                        <div class="certificate-info-item">
                            <i class="fas fa-university"></i>
                            <span>${cert.institution}</span>
                        </div>
                        <div class="certificate-info-item">
                            <i class="fas fa-calendar"></i>
                            <span>${cert.year}</span>
                        </div>
                    </div>
                    ${cert.description ? `<div class="certificate-description">${cert.description}</div>` : ''}
                    <div class="certificate-preview">
                        ${cert.file ? 
                            `<img src="${cert.file}" alt="${cert.title}">
                             <div class="overlay">
                                 <button data-action="download-certificate" data-param="${cert.id}" class="btn btn-primary">
                                     <i class="fas fa-download"></i> Download
                                 </button>
                             </div>` : 
                            `<div class="fallback">
                                <i class="fas fa-file-pdf"></i>
                                <div>${cert.fileName || 'Keine Vorschau verfügbar'}</div>
                            </div>`
                        }
                    </div>
                `;
                return div;
            }

            displayApplication() {
                // Update page title
                document.title = `Bewerbung ${this.application.position} - ${this.application.company} - Manuel Weiss`;
                
                // Update header
                document.getElementById('companyName').textContent = this.application.company;
                document.getElementById('applicationPosition').textContent = this.application.position;
                document.getElementById('applicationDate').textContent = new Date(this.application.date).toLocaleDateString('de-DE');

                // Load cover letter
                this.loadCoverLetter();
            }

            loadCoverLetter() {
                // Try to find a saved cover letter for this application
                const coverLetters = JSON.parse(localStorage.getItem('coverLetters') || '[]');
                let matchingLetter = null;
                
                // First try to find by coverLetterId if available
                if (this.application.coverLetterId) {
                    matchingLetter = coverLetters.find(letter => letter.id == this.application.coverLetterId);
                }
                
                // If not found, try to find by company and position
                if (!matchingLetter) {
                    matchingLetter = coverLetters.find(letter => 
                        letter.company.toLowerCase() === this.application.company.toLowerCase() &&
                        letter.position.toLowerCase() === this.application.position.toLowerCase()
                    );
                }

                if (matchingLetter) {
                    document.getElementById('coverLetterContent').innerHTML = 
                        `<div style="white-space: pre-wrap; line-height: 1.6;">${matchingLetter.content}</div>`;
                    
                    // Show AI badge if applicable
                    if (this.application.source === 'ai-generated') {
                        document.getElementById('aiBadge').style.display = 'flex';
                    }
                } else {
                    // Generate a default cover letter
                    const defaultLetter = this.generateDefaultCoverLetter();
                    document.getElementById('coverLetterContent').innerHTML = 
                        `<div style="white-space: pre-wrap; line-height: 1.6;">${defaultLetter}</div>`;
                }
            }

            generateDefaultCoverLetter() {
                return `Sehr geehrte Damen und Herren,

mit großem Interesse habe ich Ihre Stellenanzeige für ${this.application.position} bei ${this.application.company} gelesen. Als erfahrener HR-Tech Consultant mit über 5 Jahren Berufserfahrung in der digitalen Transformation von HR-Prozessen bin ich überzeugt, dass ich eine wertvolle Bereicherung für Ihr Team darstellen kann.

Meine Expertise umfasst die Implementierung moderner HR-Technologien, die Optimierung von Recruiting-Prozessen und die Entwicklung innovativer Lösungen für Unternehmen aller Größenordnungen. Durch meine bisherige Tätigkeit habe ich bereits zahlreiche Unternehmen dabei unterstützt, ihre HR-Abteilungen zu digitalisieren und effizienter zu gestalten.

Besonders reizt mich an dieser Position die Möglichkeit, meine Leidenschaft für HR-Technologie mit meiner Erfahrung in der Beratung zu verbinden. Ich bringe nicht nur technisches Know-how mit, sondern auch die Fähigkeit, komplexe Sachverhalte verständlich zu vermitteln und Teams bei der Umsetzung zu unterstützen.

Gerne würde ich in einem persönlichen Gespräch erläutern, wie ich Ihr Team bei der Weiterentwicklung der HR-Prozesse unterstützen kann. Ich freue mich auf Ihre Rückmeldung.

Mit freundlichen Grüßen
Manuel Weiss`;
            }

            async loadCompanyBranding() {
                try {
                    // Try to find company logo and branding
                    const companyData = await this.fetchCompanyData(this.application.company);
                    this.applyCompanyBranding(companyData);
                } catch (error) {
                    console.error('Error loading company branding:', error);
                    // Use fallback branding
                    this.applyFallbackBranding();
                }
            }

            async fetchCompanyData(companyName) {
                // Simulate AI-powered company data fetching
                // In a real implementation, this would call an AI service
                return new Promise((resolve) => {
                    setTimeout(() => {
                        // Simulate different company branding based on company name
                        const companyBranding = this.getSimulatedCompanyBranding(companyName);
                        resolve(companyBranding);
                    }, 1000);
                });
            }

            getSimulatedCompanyBranding(companyName) {
                // Simulate different corporate designs based on company name
                const brandingTemplates = {
                    'google': {
                        primary: '#4285f4',
                        secondary: '#34a853',
                        logo: 'G',
                        name: 'Google',
                        style: 'modern'
                    },
                    'microsoft': {
                        primary: '#0078d4',
                        secondary: '#00bcf2',
                        logo: 'M',
                        name: 'Microsoft',
                        style: 'corporate'
                    },
                    'apple': {
                        primary: '#000000',
                        secondary: '#1d1d1f',
                        logo: '🍎',
                        name: 'Apple',
                        style: 'minimal'
                    },
                    'sap': {
                        primary: '#0f7b0f',
                        secondary: '#1e7e34',
                        logo: 'SAP',
                        name: 'SAP',
                        style: 'enterprise'
                    },
                    'siemens': {
                        primary: '#009999',
                        secondary: '#00cccc',
                        logo: 'S',
                        name: 'Siemens',
                        style: 'industrial'
                    }
                };

                // Find matching template or use default
                const lowerName = companyName.toLowerCase();
                for (const [key, branding] of Object.entries(brandingTemplates)) {
                    if (lowerName.includes(key)) {
                        return branding;
                    }
                }

                // Default Swiss/German corporate design
                return {
                    primary: '#1e40af',
                    secondary: '#059669',
                    logo: companyName.substring(0, 2).toUpperCase(),
                    name: companyName,
                    style: 'swiss'
                };
            }

            applyCompanyBranding(branding) {
                // Update CSS variables
                document.documentElement.style.setProperty('--primary', branding.primary);
                document.documentElement.style.setProperty('--secondary', branding.secondary);

                // Update company logo
                const logoElement = document.getElementById('companyLogo');
                const initialsElement = document.getElementById('companyInitials');
                
                if (branding.logo.length === 1) {
                    initialsElement.textContent = branding.logo;
                } else {
                    initialsElement.textContent = branding.logo;
                }

                // Update company name
                document.getElementById('companyName').textContent = branding.name;

                // Apply style-specific adjustments
                this.applyStyleAdjustments(branding.style);
            }

            applyStyleAdjustments(style) {
                const header = document.querySelector('.application-header');
                const logo = document.getElementById('companyLogo');

                switch (style) {
                    case 'modern':
                        header.style.background = 'linear-gradient(135deg, #4285f4 0%, #34a853 100%)';
                        header.style.color = 'white';
                        break;
                    case 'corporate':
                        header.style.background = 'linear-gradient(135deg, #0078d4 0%, #00bcf2 100%)';
                        header.style.color = 'white';
                        break;
                    case 'minimal':
                        header.style.background = '#000000';
                        header.style.color = 'white';
                        logo.style.border = '2px solid white';
                        break;
                    case 'enterprise':
                        header.style.background = 'linear-gradient(135deg, #0f7b0f 0%, #1e7e34 100%)';
                        header.style.color = 'white';
                        break;
                    case 'industrial':
                        header.style.background = 'linear-gradient(135deg, #009999 0%, #00cccc 100%)';
                        header.style.color = 'white';
                        break;
                    case 'swiss':
                    default:
                        // Keep default Swiss design
                        break;
                }
            }

            applyFallbackBranding() {
                // Use default Swiss corporate design
                this.applyCompanyBranding({
                    primary: '#1e40af',
                    secondary: '#059669',
                    logo: this.application.company.substring(0, 2).toUpperCase(),
                    name: this.application.company,
                    style: 'swiss'
                });
            }

            setupEventListeners() {
                // Add any additional event listeners here
            }

            showError(message) {
                document.getElementById('coverLetterContent').innerHTML = 
                    `<div class="error"><i class="fas fa-exclamation-triangle"></i> ${message}</div>`;
            }
        }

        // Action Functions
        function scheduleInterview() {
            alert('Interview-Terminierung wird in einer zukünftigen Version verfügbar sein.');
        }

        function acceptApplication() {
            alert('Bewerbung wurde als angenommen markiert.');
        }

        function downloadCV() {
            // Create a link to download the CV
            const link = document.createElement('a');
            link.href = 'Manuel_Weiss_CV.pdf';
            link.download = 'Manuel_Weiss_CV.pdf';
            link.click();
        }

        function sendMessage() {
            alert('Nachrichtenfunktion wird in einer zukünftigen Version verfügbar sein.');
        }

        function downloadCertificate(id) {
            const hrDesignData = JSON.parse(localStorage.getItem('hrDesignData') || '{}');
            const certificates = hrDesignData.certificates || [];
            const cert = certificates.find(c => c.id === id);
            
            if (!cert) {
                alert('Zeugnis nicht gefunden.');
                return;
            }

            if (cert.file) {
                // Download from stored file data
                const link = document.createElement('a');
                link.href = cert.file;
                link.download = cert.fileName || `${cert.title}.pdf`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } else if (cert.fileName) {
                // Try to download from server
                const link = document.createElement('a');
                link.href = cert.fileName;
                link.download = cert.fileName;
                link.target = '_blank';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } else {
                alert('Keine Datei verfügbar für Download.');
            }
        }

        // Initialize application viewer when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new ApplicationViewer();
        });
    </script>

    <!-- Multi-User File Management System -->
    <script src="./js/base-logger.js"></script>

    <section id="userfiles" style="margin: 3rem auto; max-width: 1200px; padding: 0 1rem;">
      <div style="background: var(--white); border-radius: var(--radius-xl); box-shadow: var(--shadow-lg); padding: 2rem; border: 1px solid var(--neutral-200);">
        <h3 style="color: var(--neutral-800); font-size: 1.5rem; font-weight: 600; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem;">
          <i class="fas fa-cloud-upload-alt" style="color: var(--primary);"></i>
          Meine Dokumente
        </h3>
        
        <div id="authbar" style="margin-bottom: 2rem; padding: 1rem; background: var(--neutral-50); border-radius: var(--radius-lg); border: 1px solid var(--neutral-200);">
          <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem;">
            <div style="display: flex; align-items: center; gap: 1rem;">
              <button id="loginBtn" style="background: var(--primary); color: white; border: none; border-radius: var(--radius-md); padding: 0.75rem 1.5rem; cursor: pointer; font-weight: 500; display: flex; align-items: center; gap: 0.5rem;">
                <i class="fas fa-sign-in-alt"></i> Anmelden
              </button>
              <button id="logoutBtn" style="display:none; background: var(--accent); color: white; border: none; border-radius: var(--radius-md); padding: 0.75rem 1.5rem; cursor: pointer; font-weight: 500; display: flex; align-items: center; gap: 0.5rem;">
                <i class="fas fa-sign-out-alt"></i> Abmelden
              </button>
            </div>
            <span id="whoami" style="color: var(--neutral-600); font-weight: 500;"></span>
          </div>
        </div>

        <div id="uploader" style="display:none; margin-bottom: 2rem; padding: 1.5rem; background: var(--neutral-50); border-radius: var(--radius-lg); border: 2px dashed var(--neutral-300);">
          <div style="display: flex; align-items: center; gap: 1rem; flex-wrap: wrap;">
            <input type="file" id="docFile" style="flex: 1; padding: 0.75rem; border: 1px solid var(--neutral-300); border-radius: var(--radius-md); background: white;" />
            <button id="btnUpload" style="background: var(--secondary); color: white; border: none; border-radius: var(--radius-md); padding: 0.75rem 1.5rem; cursor: pointer; font-weight: 500; display: flex; align-items: center; gap: 0.5rem;">
              <i class="fas fa-upload"></i> Hochladen
            </button>
          </div>
        </div>

        <table id="docTable" style="display:none; width: 100%; border-collapse: collapse; background: white; border-radius: var(--radius-lg); overflow: hidden; box-shadow: var(--shadow-sm);">
          <thead>
            <tr style="background: var(--neutral-100);">
              <th style="padding: 1rem; text-align: left; font-weight: 600; color: var(--neutral-700); border-bottom: 1px solid var(--neutral-200);">Name</th>
              <th style="padding: 1rem; text-align: left; font-weight: 600; color: var(--neutral-700); border-bottom: 1px solid var(--neutral-200);">Typ</th>
              <th style="padding: 1rem; text-align: left; font-weight: 600; color: var(--neutral-700); border-bottom: 1px solid var(--neutral-200);">Größe</th>
              <th style="padding: 1rem; text-align: left; font-weight: 600; color: var(--neutral-700); border-bottom: 1px solid var(--neutral-200);">Aktionen</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        
        <div id="msg" style="margin-top: 1rem; padding: 1rem; border-radius: var(--radius-md); background: var(--neutral-100); color: var(--neutral-700); text-align: center; display: none;"></div>
      </div>
    </section>

    <script type="module">
      import { initAuth, isLoggedIn, getUser } from './js/auth.js';
      import { uploadDocument, listDocuments, deleteDocument, getDownloadUrl } from './js/docs.js';

      const loginBtn = document.getElementById('loginBtn');
      const logoutBtn = document.getElementById('logoutBtn');
      const whoami = document.getElementById('whoami');
      const uploader = document.getElementById('uploader');
      const docTable = document.getElementById('docTable');
      const tbody = docTable.querySelector('tbody');
      const msg = document.getElementById('msg');

      // ✅ Echte Cognito URLs - Live System!
      const LOGIN_URL  = 'https://manuel-weiss-userfiles-auth-038333965110.auth.eu-central-1.amazoncognito.com/login?client_id=7kc5tt6a23fgh53d60vkefm812&response_type=code&scope=email+openid+profile&redirect_uri=https%3A//manuel-weiss.com/bewerbung.html';
      const LOGOUT_URL = 'https://manuel-weiss-userfiles-auth-038333965110.auth.eu-central-1.amazoncognito.com/logout?client_id=7kc5tt6a23fgh53d60vkefm812&logout_uri=https%3A//manuel-weiss.com';

      initAuth();
      refreshUI();

      loginBtn.onclick = () => location.href = LOGIN_URL;
      logoutBtn.onclick = () => location.href = LOGOUT_URL;

      document.getElementById('btnUpload').onclick = async () => {
        const f = document.getElementById('docFile').files[0];
        if (!f) return showMessage('Bitte Datei wählen', 'warning');
        
        const btn = document.getElementById('btnUpload');
        const originalText = btn.textContent;
        
        try {
          btn.textContent = 'Lade hoch...';
          btn.disabled = true;
          showMessage('📤 Dokument wird hochgeladen...', 'info');
          
          const result = await uploadDocument(f);
          
          if (result.storage === 'local') {
            showMessage('✅ Dokument lokal gespeichert (Cloud nicht verfügbar)', 'success');
          } else {
            showMessage('✅ Dokument erfolgreich hochgeladen', 'success');
          }
          
          document.getElementById('docFile').value = '';
          await loadList();
        } catch(e){ 
          console.error(e); 
          showMessage('❌ Upload fehlgeschlagen: ' + e.message, 'error'); 
        } finally {
          btn.textContent = originalText;
          btn.disabled = false;
        }
      };

      // CV Upload Handler
      document.getElementById('btnCvUpload').onclick = async () => {
        const f = document.getElementById('cvUpload').files[0];
        if (!f) return showMessage('Bitte Lebenslauf-Datei wählen', 'warning');
        
        const btn = document.getElementById('btnCvUpload');
        const originalText = btn.textContent;
        
        try {
          btn.textContent = 'Lade hoch...';
          btn.disabled = true;
          showMessage('📤 Lebenslauf wird hochgeladen...', 'info');
          
          const result = await uploadDocument(f);
          
          if (result.storage === 'local') {
            showMessage('✅ Lebenslauf lokal gespeichert', 'success');
            // Add to HR Design data
            addToHRDesignData('cv', f.name, result);
          } else {
            showMessage('✅ Lebenslauf erfolgreich hochgeladen', 'success');
            addToHRDesignData('cv', f.name, result);
          }
          
          document.getElementById('cvUpload').value = '';
        } catch(e){ 
          console.error(e); 
          showMessage('❌ Lebenslauf-Upload fehlgeschlagen: ' + e.message, 'error'); 
        } finally {
          btn.textContent = originalText;
          btn.disabled = false;
        }
      };

      // Certificate Upload Handler
      document.getElementById('btnCertificateUpload').onclick = async () => {
        const files = document.getElementById('certificateUpload').files;
        if (!files || files.length === 0) return showMessage('Bitte Zeugnis-Dateien wählen', 'warning');
        
        const btn = document.getElementById('btnCertificateUpload');
        const originalText = btn.textContent;
        
        try {
          btn.textContent = 'Lade hoch...';
          btn.disabled = true;
          showMessage(`📤 ${files.length} Zeugnis(se) werden hochgeladen...`, 'info');
          
          const uploadPromises = Array.from(files).map(async (file) => {
            const result = await uploadDocument(file);
            return { file, result };
          });
          
          const results = await Promise.all(uploadPromises);
          
          let successCount = 0;
          results.forEach(({ file, result }) => {
            if (result.storage === 'local') {
              addToHRDesignData('certificate', file.name, result);
              successCount++;
            } else {
              addToHRDesignData('certificate', file.name, result);
              successCount++;
            }
          });
          
          if (successCount === files.length) {
            showMessage(`✅ ${successCount} Zeugnis(se) erfolgreich hochgeladen`, 'success');
          } else {
            showMessage(`⚠️ ${successCount} von ${files.length} Zeugnisse hochgeladen`, 'warning');
          }
          
          document.getElementById('certificateUpload').value = '';
        } catch(e){ 
          console.error(e); 
          showMessage('❌ Zeugnis-Upload fehlgeschlagen: ' + e.message, 'error'); 
        } finally {
          btn.textContent = originalText;
          btn.disabled = false;
        }
      };

      // Add to HR Design Data
      function addToHRDesignData(type, fileName, uploadResult) {
        const hrDesignData = JSON.parse(localStorage.getItem('hrDesignData') || '{}');
        
        if (type === 'cv') {
          if (!hrDesignData.documents) hrDesignData.documents = {};
          hrDesignData.documents.cv = {
            name: fileName,
            uploadedAt: new Date().toISOString(),
            storage: uploadResult.storage,
            id: uploadResult.id
          };
        } else if (type === 'certificate') {
          if (!hrDesignData.certificates) hrDesignData.certificates = [];
          hrDesignData.certificates.push({
            id: uploadResult.id,
            title: fileName.replace(/\.[^/.]+$/, ""), // Remove file extension
            fileName: fileName,
            uploadedAt: new Date().toISOString(),
            storage: uploadResult.storage,
            institution: 'Hochgeladenes Zeugnis',
            year: new Date().getFullYear(),
            description: 'Hochgeladenes Zeugnis'
          });
        }
        
        localStorage.setItem('hrDesignData', JSON.stringify(hrDesignData));
        console.log('✅ Added to HR Design Data:', type, fileName);
      }

      async function loadList(){
        try {
          const rows = await listDocuments();
          tbody.innerHTML = '';
          for (const r of rows) {
            const tr = document.createElement('tr');
            tr.style.borderBottom = '1px solid var(--neutral-200)';
            // Determine storage type and display accordingly
            const storageType = r.storage || 'cloud';
            const storageIcon = storageType === 'local' ? '💾' : '☁️';
            const storageText = storageType === 'local' ? ' (Lokal)' : ' (Cloud)';
            
            tr.innerHTML = `
              <td style="padding: 1rem; color: var(--neutral-800);">
                ${storageIcon} ${r.name}${storageText}
              </td>
              <td style="padding: 1rem; color: var(--neutral-600); font-size: 0.875rem;">${r.type||''}</td>
              <td style="padding: 1rem; color: var(--neutral-600); font-size: 0.875rem;">${(r.size/1024).toFixed(1)} KB</td>
              <td style="padding: 1rem;">
                <button data-act="dl" style="background: var(--primary); color: white; border: none; border-radius: var(--radius-sm); padding: 0.5rem 1rem; cursor: pointer; margin-right: 0.5rem; font-size: 0.875rem;">
                  <i class="fas fa-eye"></i> Ansehen
                </button>
                <button data-act="del" style="background: var(--accent); color: white; border: none; border-radius: var(--radius-sm); padding: 0.5rem 1rem; cursor: pointer; font-size: 0.875rem;">
                  <i class="fas fa-trash"></i> Löschen
                </button>
              </td>`;
            tr.querySelector('[data-act="dl"]').onclick = async () => {
              try {
                if (r.storage === 'local' && r.data) {
                  // For local documents, use the data directly
                  const link = document.createElement('a');
                  link.href = r.data;
                  link.download = r.name;
                  link.click();
                } else {
                  // For cloud documents, get download URL
                  const { url } = await getDownloadUrl(r.key || r.id);
                  window.open(url, '_blank');
                }
              } catch(e) {
                showMessage('❌ Download fehlgeschlagen', 'error');
              }
            };
            tr.querySelector('[data-act="del"]').onclick = async () => {
              if (!confirm('Wirklich löschen?')) return;
              try {
                await deleteDocument(r.id);
                showMessage('✅ Gelöscht', 'success');
                await loadList();
              } catch(e) {
                showMessage('❌ Löschen fehlgeschlagen', 'error');
              }
            };
            tbody.appendChild(tr);
          }
          docTable.style.display = rows.length ? '' : 'none';
        } catch(e){ 
          console.error(e); 
          showMessage('❌ Liste konnte nicht geladen werden', 'error'); 
        }
      }

      function refreshUI(){
        const logged = isLoggedIn();
        loginBtn.style.display = logged ? 'none' : '';
        logoutBtn.style.display = logged ? '' : 'none';
        uploader.style.display = logged ? '' : 'none';
        whoami.textContent = logged ? `Eingeloggt als ${getUser().email || getUser().userId}` : '';
        if (logged) loadList();
      }

      function showMessage(text, type = 'info') {
        msg.textContent = text;
        msg.style.display = '';
        
        // Styling based on type
        switch(type) {
          case 'success':
            msg.style.background = '#dcfce7';
            msg.style.color = '#166534';
            msg.style.border = '1px solid #bbf7d0';
            break;
          case 'error':
            msg.style.background = '#fef2f2';
            msg.style.color = '#dc2626';
            msg.style.border = '1px solid #fecaca';
            break;
          case 'warning':
            msg.style.background = '#fef3c7';
            msg.style.color = '#92400e';
            msg.style.border = '1px solid #fde68a';
            break;
          default:
            msg.style.background = 'var(--neutral-100)';
            msg.style.color = 'var(--neutral-700)';
            msg.style.border = '1px solid var(--neutral-200)';
        }

        // Auto-hide after 5 seconds
        setTimeout(() => {
          msg.style.display = 'none';
        }, 5000);
      }
    </script>
</body>
</html>