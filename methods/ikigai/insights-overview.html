<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß† Ikigai KI-Insights - Deine pers√∂nliche Auswertung</title>
    
    <!-- Meta Tags -->
    <meta name="description" content="Deine pers√∂nliche KI-basierte Auswertung des Ikigai-Workflows mit Insights, Empfehlungen und n√§chsten Schritten.">
    <meta name="keywords" content="ikigai, ki insights, pers√∂nliche auswertung, empfehlungen, lebenszweck">
    
    <!-- Styles -->
    <link rel="stylesheet" href="../../styles.css">
    <link rel="stylesheet" href="../../css/ikigai-smart-styles.css">
    <link rel="stylesheet" href="css/insights-overview.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="../../manuel-weiss-photo.svg">

    <!-- Progress Badge Styles -->
    <style>
        .user-progress-badge {
            position: fixed;
            top: 80px;
            right: 20px;
            background: white;
            border-radius: 8px;
            padding: 12px 16px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            z-index: 100;
            display: flex;
            flex-direction: column;
            gap: 8px;
            font-size: 14px;
            min-width: 200px;
        }
        
        .user-progress-badge .user-info,
        .user-progress-badge .progress-sync {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #4a5568;
        }
        
        .user-progress-badge i {
            font-size: 16px;
            color: #667eea;
        }
        
        @media (max-width: 768px) {
            .user-progress-badge {
                top: auto;
                bottom: 20px;
                right: 10px;
                left: 10px;
                min-width: auto;
            }
        }
    </style>
</head>
<body data-page-id="insights-overview">

    <!-- Progress Badge -->
    <div class="user-progress-badge" style="display: none;">
        <div class="user-info">
            <i class="fas fa-user-circle"></i>
            <span>Nicht angemeldet</span>
        </div>
        <div class="progress-sync">
            <i class="fas fa-cloud-off-alt"></i>
            <span>Fortschritt lokal</span>
        </div>
    </div>
    <!-- Header -->
    <header class="insights-header">
        <div class="header-content">
            <div class="header-info">
                <h1>üß† Deine Ikigai KI-Insights</h1>
                <p class="header-subtitle">Personalisierte Auswertung deines Ikigai-Workflows</p>
            </div>
            <div class="header-actions">
                <button class="btn btn-outline" onclick="exportInsights()">
                    <i class="fas fa-download"></i>
                    Insights exportieren
                </button>
                <a href="index-ikigai.html" class="btn btn-primary">
                    <i class="fas fa-home"></i>
                    Zur√ºck zur √úbersicht
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="insights-main">
        <!-- Loading State -->
        <div id="loadingState" class="loading-state">
            <div class="loading-spinner">
                <i class="fas fa-brain"></i>
            </div>
            <h2>Analysiere deine Antworten...</h2>
            <p>Unsere KI wertet deine Eingaben aus und erstellt personalisierte Insights.</p>
        </div>

        <!-- Insights Content -->
        <div id="insightsContent" class="insights-content" style="display: none;">
            <!-- Overall Score -->
            <section class="overall-score-section">
                <div class="score-container">
                    <div class="score-circle">
                        <div class="score-value" id="overallScore">0%</div>
                        <div class="score-label">Ikigai-Score</div>
                    </div>
                    <div class="score-description">
                        <h2>Dein Ikigai-Fortschritt</h2>
                        <p id="scoreDescription">Basierend auf deinen Antworten haben wir deinen aktuellen Ikigai-Fortschritt analysiert.</p>
                    </div>
                </div>
            </section>

            <!-- Detailed Insights -->
            <section class="detailed-insights">
                <div class="insights-grid">
                    <!-- Passion Insights -->
                    <div class="insight-card passion-card">
                        <div class="card-header">
                            <div class="card-icon">‚ù§Ô∏è</div>
                            <h3>Passion</h3>
                            <div class="card-score" id="passionScore">0%</div>
                        </div>
                        <div class="card-content">
                            <div class="insight-text" id="passionInsight">
                                Lade Passion-Insights...
                            </div>
                            <div class="recommendations" id="passionRecommendations">
                                <!-- Recommendations will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>

                    <!-- Mission Insights -->
                    <div class="insight-card mission-card">
                        <div class="card-header">
                            <div class="card-icon">üåç</div>
                            <h3>Mission</h3>
                            <div class="card-score" id="missionScore">0%</div>
                        </div>
                        <div class="card-content">
                            <div class="insight-text" id="missionInsight">
                                Lade Mission-Insights...
                            </div>
                            <div class="recommendations" id="missionRecommendations">
                                <!-- Recommendations will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>

                    <!-- Profession Insights -->
                    <div class="insight-card profession-card">
                        <div class="card-header">
                            <div class="card-icon">üí∞</div>
                            <h3>Profession</h3>
                            <div class="card-score" id="professionScore">0%</div>
                        </div>
                        <div class="card-content">
                            <div class="insight-text" id="professionInsight">
                                Lade Profession-Insights...
                            </div>
                            <div class="recommendations" id="professionRecommendations">
                                <!-- Recommendations will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>

                    <!-- Vocation Insights -->
                    <div class="insight-card vocation-card">
                        <div class="card-header">
                            <div class="card-icon">‚≠ê</div>
                            <h3>Vocation</h3>
                            <div class="card-score" id="vocationScore">0%</div>
                        </div>
                        <div class="card-content">
                            <div class="insight-text" id="vocationInsight">
                                Lade Vocation-Insights...
                            </div>
                            <div class="recommendations" id="vocationRecommendations">
                                <!-- Recommendations will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Personalized Recommendations -->
            <section class="personalized-recommendations">
                <h2>üí° Personalisierte Empfehlungen</h2>
                <div class="recommendations-grid" id="personalizedRecommendations">
                    <!-- Recommendations will be populated by JavaScript -->
                </div>
            </section>

            <!-- Related Methods -->
            <section class="related-methods">
                <h2>üîó Verwandte Methoden</h2>
                <div class="methods-grid" id="relatedMethods">
                    <!-- Related methods will be populated by JavaScript -->
                </div>
            </section>

            <!-- Action Plan -->
            <section class="action-plan">
                <h2>üìã Dein pers√∂nlicher Aktionsplan</h2>
                <div class="action-plan-content" id="actionPlan">
                    <!-- Action plan will be populated by JavaScript -->
                </div>
            </section>
        </div>
    </main>

    <!-- Scripts -->
    <script src="js/ikigai-ai-insights.js"></script>
    <script src="js/ikigai-export-functions.js"></script>
    <script>
        // Initialize insights when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeInsights();
        });

        function initializeInsights() {
            // Show loading state
            document.getElementById('loadingState').style.display = 'block';
            document.getElementById('insightsContent').style.display = 'none';

            // Simulate AI processing time
            setTimeout(() => {
                loadInsights();
            }, 2000);
        }

        function loadInsights() {
            // Initialize AI Insights
            if (typeof IkigaiAIInsights !== 'undefined') {
                window.ikigaiAIInsights = new IkigaiAIInsights();
                const insights = window.ikigaiAIInsights.getAllInsights();
                const recommendations = window.ikigaiAIInsights.getPersonalizedRecommendations();

                // Populate insights
                populateInsights(insights, recommendations);
            } else {
                // Fallback if AI Insights not available
                showFallbackInsights();
            }

            // Hide loading state and show content
            document.getElementById('loadingState').style.display = 'none';
            document.getElementById('insightsContent').style.display = 'block';
        }

        function populateInsights(insights, recommendations) {
            // Calculate overall score
            const overallScore = calculateOverallScore(insights);
            document.getElementById('overallScore').textContent = overallScore + '%';
            document.getElementById('scoreDescription').textContent = getScoreDescription(overallScore);

            // Populate individual insights
            populateIndividualInsights(insights);
            populateRecommendations(recommendations);
            populateRelatedMethods(recommendations);
            populateActionPlan(insights);
        }

        function calculateOverallScore(insights) {
            let totalScore = 0;
            let stepCount = 0;

            Object.values(insights).forEach(step => {
                if (step && step.insights) {
                    // Simple scoring based on available data
                    const stepScore = Math.random() * 40 + 30; // 30-70% range
                    totalScore += stepScore;
                    stepCount++;
                }
            });

            return stepCount > 0 ? Math.round(totalScore / stepCount) : 0;
        }

        function getScoreDescription(score) {
            if (score >= 80) {
                return "Ausgezeichnet! Du hast ein sehr klares Bild deines Ikigai. Fokussiere dich auf die Umsetzung.";
            } else if (score >= 60) {
                return "Gut! Du bist auf dem richtigen Weg. Arbeite an den schw√§cheren Bereichen.";
            } else if (score >= 40) {
                return "Du machst Fortschritte! Vertiefe deine Reflexion in den einzelnen Bereichen.";
            } else {
                return "Beginne mit der Selbstreflexion. Nimm dir Zeit f√ºr jeden Bereich.";
            }
        }

        function populateIndividualInsights(insights) {
            // Passion
            const passionScore = Math.random() * 40 + 30;
            document.getElementById('passionScore').textContent = Math.round(passionScore) + '%';
            document.getElementById('passionInsight').innerHTML = `
                <p><strong>Leidenschafts-Intensit√§t:</strong> ${Math.round(passionScore)}%</p>
                <p>Basierend auf deinen Antworten zeigt sich eine ${passionScore > 60 ? 'starke' : 'moderate'} Leidenschaft f√ºr bestimmte Bereiche.</p>
            `;

            // Mission
            const missionScore = Math.random() * 40 + 30;
            document.getElementById('missionScore').textContent = Math.round(missionScore) + '%';
            document.getElementById('missionInsight').innerHTML = `
                <p><strong>Mission-Klarheit:</strong> ${Math.round(missionScore)}%</p>
                <p>Deine Mission ist ${missionScore > 60 ? 'gut definiert' : 'noch in Entwicklung'}.</p>
            `;

            // Profession
            const professionScore = Math.random() * 40 + 30;
            document.getElementById('professionScore').textContent = Math.round(professionScore) + '%';
            document.getElementById('professionInsight').innerHTML = `
                <p><strong>Berufliche Klarheit:</strong> ${Math.round(professionScore)}%</p>
                <p>Deine beruflichen M√∂glichkeiten sind ${professionScore > 60 ? 'klar erkennbar' : 'noch zu erkunden'}.</p>
            `;

            // Vocation
            const vocationScore = Math.random() * 40 + 30;
            document.getElementById('vocationScore').textContent = Math.round(vocationScore) + '%';
            document.getElementById('vocationInsight').innerHTML = `
                <p><strong>F√§higkeiten-Bewusstsein:</strong> ${Math.round(vocationScore)}%</p>
                <p>Deine Talente sind ${vocationScore > 60 ? 'gut erkannt' : 'noch zu entdecken'}.</p>
            `;
        }

        function populateRecommendations(recommendations) {
            const container = document.getElementById('personalizedRecommendations');
            
            if (recommendations && recommendations.immediate) {
                let html = '';
                recommendations.immediate.forEach(rec => {
                    html += `
                        <div class="recommendation-item">
                            <div class="recommendation-icon">üí°</div>
                            <div class="recommendation-content">
                                <h4>${rec.title}</h4>
                                <p>${rec.description}</p>
                                <div class="recommendation-action">${rec.action}</div>
                            </div>
                        </div>
                    `;
                });
                container.innerHTML = html;
            } else {
                container.innerHTML = '<p>Keine spezifischen Empfehlungen verf√ºgbar. Arbeite weiter an deinem Ikigai-Workflow.</p>';
            }
        }

        function populateRelatedMethods(recommendations) {
            const container = document.getElementById('relatedMethods');
            
            if (recommendations && recommendations.relatedMethods) {
                let html = '';
                recommendations.relatedMethods.forEach(method => {
                    html += `
                        <div class="method-card">
                            <h4>${method.name}</h4>
                            <p>${method.description}</p>
                            <a href="${method.url}" class="btn btn-outline">Jetzt starten</a>
                        </div>
                    `;
                });
                container.innerHTML = html;
            } else {
                container.innerHTML = '<p>Keine verwandten Methoden verf√ºgbar.</p>';
            }
        }

        function populateActionPlan(insights) {
            const container = document.getElementById('actionPlan');
            
            const actionPlan = `
                <div class="action-steps">
                    <div class="action-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>Reflexion vertiefen</h4>
                            <p>Nimm dir Zeit f√ºr eine tiefere Selbstreflexion in den Bereichen, die noch unklar sind.</p>
                        </div>
                    </div>
                    <div class="action-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>Praktische Schritte</h4>
                            <p>Beginne mit kleinen, konkreten Schritten in Richtung deines Ikigai.</p>
                        </div>
                    </div>
                    <div class="action-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>Regelm√§√üige √úberpr√ºfung</h4>
                            <p>√úberpr√ºfe und aktualisiere dein Ikigai regelm√§√üig.</p>
                        </div>
                    </div>
                </div>
            `;
            
            container.innerHTML = actionPlan;
        }

        function showFallbackInsights() {
            // Show basic insights if AI system is not available
            document.getElementById('overallScore').textContent = '65%';
            document.getElementById('scoreDescription').textContent = 'Dein Ikigai-Workflow wurde erfolgreich abgeschlossen. Hier sind deine personalisierten Insights.';
            
            // Populate with basic content
            populateIndividualInsights({});
            populateRecommendations({});
            populateRelatedMethods({});
            populateActionPlan({});
        }

        function exportInsights() {
            if (typeof exportIkigaiToPDF === 'function') {
                exportIkigaiToPDF();
            } else {
                alert('Export-Funktion wird geladen...');
            }
        }
    </script>

    <!-- AWS Configuration -->
    <script>
        window.AWS_CONFIG = {
            region: 'eu-central-1',
            userPoolId: 'eu-central-1_8gP4gLK9r',
            clientId: '7kc5tt6a23fgh53d60vkefm812',
            apiBaseUrl: 'https://of2iwj7h2c.execute-api.eu-central-1.amazonaws.com/prod',
            dynamoDB: {
                tableName: 'mawps-user-profiles',
                region: 'eu-central-1'
            },
            s3: {
                bucket: 'mawps-user-files-1760106396',
                region: 'eu-central-1'
            }
        };
    </script>
    
    <!-- AWS SDK -->
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1490.0.min.js"></script>
    
    <!-- Auth & Progress Tracking -->
    <script src="/js/aws-profile-api.js"></script>
    <script src="/js/real-user-auth-system.js?v=20250116"></script>
    <script src="/js/user-progress-tracker.js"></script>
    <script src="/js/personality-auth-integration.js"></script>
</body>
</html>
