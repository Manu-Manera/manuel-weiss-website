[build]
  # Build für statische Website mit Netlify Functions
  command = "echo 'Static site with functions - no build required'"
  publish = "."
  functions = "netlify/functions"
  ignore = "node_modules"

# Netlify Functions für OpenAI Proxy
  
  # Production Environment Variables
  AWS_REGION = "eu-central-1"
  COGNITO_USER_POOL_ID = "eu-central-1_xxxxx"
  COGNITO_CLIENT_ID = "xxxxxxxxxx"
  API_BASE_URL = "https://api-gateway.execute-api.eu-central-1.amazonaws.com/prod"
  S3_MEDIA_BUCKET = "mw-prod-media"
  CLOUDFRONT_URL = "https://d1234567890.cloudfront.net"
  
  # Staging Environment (für Branch Deploys)
  [context.staging]
    AWS_REGION = "eu-central-1"
    COGNITO_USER_POOL_ID = "eu-central-1_staging_xxxxx"
    COGNITO_CLIENT_ID = "staging_xxxxxxxxxx"
    API_BASE_URL = "https://api-gateway.execute-api.eu-central-1.amazonaws.com/staging"
    S3_MEDIA_BUCKET = "mw-staging-media"
    CLOUDFRONT_URL = "https://d1234567890-staging.cloudfront.net"
  
  # Development Environment
  [context.development]
    AWS_REGION = "eu-central-1"
    COGNITO_USER_POOL_ID = "eu-central-1_dev_xxxxx"
    COGNITO_CLIENT_ID = "dev_xxxxxxxxxx"
    API_BASE_URL = "https://api-gateway.execute-api.eu-central-1.amazonaws.com/dev"
    S3_MEDIA_BUCKET = "mw-dev-media"
    CLOUDFRONT_URL = "https://d1234567890-dev.cloudfront.net"
  
# Redirects für bessere SEO
[[redirects]]
  from = "/admin"
  to = "/admin.html"
  status = 301

[[redirects]]
  from = "/persoenlichkeitsentwicklung"
  to = "/persoenlichkeitsentwicklung-uebersicht.html"
  status = 301

[[redirects]]
  from = "/personality"
  to = "/persoenlichkeitsentwicklung-uebersicht.html"
  status = 301

[[redirects]]
  from = "/methods"
  to = "/persoenlichkeitsentwicklung-uebersicht.html"
  status = 301

[[redirects]]
  from = "/applications"
  to = "/applications/index.html"
  status = 301

[[redirects]]
  from = "/bewerbung"
  to = "/applications/index.html"
  status = 301

[[redirects]]
  from = "/bewerbungen"
  to = "/applications/index.html"
  status = 301

# Headers für bessere Performance und Sicherheit
[[headers]]
  for = "/*"
  [headers.values]
    X-Frame-Options = "DENY"
    X-XSS-Protection = "1; mode=block"
    X-Content-Type-Options = "nosniff"
    Referrer-Policy = "strict-origin-when-cross-origin"
    Cache-Control = "public, max-age=31536000"

# Spezielle Headers für HTML-Dateien
[[headers]]
  for = "*.html"
  [headers.values]
    Cache-Control = "public, max-age=0, must-revalidate"
    Content-Type = "text/html; charset=utf-8"

# Headers für CSS und JS
[[headers]]
  for = "*.css"
  [headers.values]
    Cache-Control = "public, max-age=31536000"
    Content-Type = "text/css"

[[headers]]
  for = "*.js"
  [headers.values]
    Cache-Control = "public, max-age=31536000"
    Content-Type = "application/javascript"

# Headers für Bilder
[[headers]]
  for = "*.jpg"
  [headers.values]
    Cache-Control = "public, max-age=31536000"
    Content-Type = "image/jpeg"

[[headers]]
  for = "*.png"
  [headers.values]
    Cache-Control = "public, max-age=31536000"
    Content-Type = "image/png"

[[headers]]
  for = "*.jpeg"
  [headers.values]
    Cache-Control = "public, max-age=31536000"
    Content-Type = "image/jpeg"