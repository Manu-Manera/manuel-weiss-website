<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Change Management Workflow - Manuel Weiss</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="css/starry-background.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Custom Styles for Change Management Workflow -->
    <style>
        /* Dark Theme Override */
        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 50%, #312e81 100%) !important;
            min-height: 100vh;
            color: #e2e8f0;
        }
        
        .navbar {
            background: rgba(15, 23, 42, 0.8) !important;
            backdrop-filter: blur(20px) !important;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important;
        }
        
        .nav-name { color: #fff !important; }
        .nav-menu a { color: rgba(255, 255, 255, 0.8) !important; }
        .nav-menu a:hover { color: #fff !important; }
        
        .change-mgmt-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
            z-index: 2;
        }
        
        /* Workflow Sidebar - Dark Theme */
        .workflow-sidebar {
            position: fixed;
            right: 2rem;
            top: 50%;
            transform: translateY(-50%);
            width: 280px;
            background: rgba(30, 27, 75, 0.9);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 1.5rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(245, 158, 11, 0.3);
            z-index: 100;
            transition: all 0.3s ease;
        }
        
        .progress-summary h4 { color: #fff; }
        .progress-text { color: #fde68a; }
        
        .workflow-sidebar.collapsed {
            width: 60px;
            padding: 1rem;
        }
        
        .sidebar-toggle {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: #f59e0b;
            color: white;
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .progress-summary {
            margin-bottom: 1rem;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #f59e0b, #d97706);
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .current-state-indicator {
            background: rgba(245, 158, 11, 0.15);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 2px solid rgba(245, 158, 11, 0.4);
            border-radius: 16px;
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: 0 4px 16px rgba(245, 158, 11, 0.2);
        }
        
        .maturity-score {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
        }
        
        .score-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
            background: #f59e0b;
        }
        
        .score-circle.score-beginner {
            background: #ef4444;
        }
        
        .score-circle.score-intermediate {
            background: #f59e0b;
        }
        
        .score-circle.score-advanced {
            background: #3b82f6;
        }
        
        .score-circle.score-expert {
            background: #10b981;
        }
        
        /* Assessment System Styles - Dark Theme */
        .assessment-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .assessment-category {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
        }
        
        .assessment-category h4 { color: #fff; }
        .assessment-category p { color: #fde68a; }
        
        .assessment-category.clickable-category {
            cursor: pointer;
        }
        
        .assessment-category.clickable-category:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 12px 32px rgba(245, 158, 11, 0.3);
            border-color: rgba(245, 158, 11, 0.5);
            background: rgba(245, 158, 11, 0.15);
        }
        
        .category-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }
        
        .category-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.25rem;
        }
        
        .slider-container {
            margin-top: 1rem;
        }
        
        .slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #e5e7eb;
            outline: none;
            -webkit-appearance: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #f59e0b;
            cursor: pointer;
        }
        
        .slider-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            color: #fde68a;
            margin-top: 0.5rem;
        }
        
        .slider-value-display {
            text-align: center;
            font-size: 1.25rem;
            font-weight: 700;
            margin: 0.5rem 0;
            color: #fbbf24;
        }
        
        .slider {
            background: rgba(255, 255, 255, 0.1) !important;
        }
        
        .smart-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(255, 255, 255, 0.2);
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 1rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .ai-icon {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .score-circle-large {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            color: white;
            font-size: 2rem;
        }
        
        .workflow-header {
            text-align: center;
            margin-bottom: 2rem;
            padding: 2rem 2rem;
            background: rgba(245, 158, 11, 0.2);
            backdrop-filter: blur(20px);
            color: white;
            border-radius: 24px;
            border: 1px solid rgba(245, 158, 11, 0.3);
        .workflow-header h1 {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 0.75rem;
        .workflow-header p {
            font-size: 1rem;
            opacity: 0.9;
        .workflow-progress {
            display: flex;
            justify-content: center;
            margin-bottom: 3rem;
            flex-wrap: wrap;
        .progress-step {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 25px;
            font-weight: 500;
            color: #fde68a;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .progress-step.active {
            background: rgba(245, 158, 11, 0.3);
            border-color: #f59e0b;
            color: #fff;
        }
        .progress-step.completed {
            background: rgba(16, 185, 129, 0.3);
            border-color: #10b981;
            color: #fff;
        .workflow-step {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 2rem;
            margin-bottom: 2rem;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        .step-header {
            margin-bottom: 1.5rem;
        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-weight: 700;
            margin-right: 1rem;
        .step-title {
            font-size: 1.5rem;
            color: #fff;
        .step-description {
            line-height: 1.6;
        .form-group {
        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #e2e8f0;
        }
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            transition: border-color 0.3s ease;
            background: rgba(255, 255, 255, 0.05);
            color: #fff;
        }
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #f59e0b;
            background: rgba(245, 158, 11, 0.1);
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        .checkbox-item {
            padding: 1rem;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .checkbox-item label { color: #e2e8f0; }
        .checkbox-item:hover {
            background: rgba(245, 158, 11, 0.1);
            border-color: rgba(245, 158, 11, 0.3);
        .checkbox-item input[type="checkbox"] {
            margin-right: 0.75rem;
            width: auto;
        .btn {
            border: none;
            text-decoration: none;
            display: inline-block;
        .btn:hover {
            transform: translateY(-2px);
        .btn-secondary {
            background: #6b7280;
        .btn-secondary:hover {
            background: #4b5563;
        .btn-success {
            background: #059669;
        .btn-success:hover {
            background: #047857;
        .methodology-section {
            border: 2px solid rgba(245, 158, 11, 0.4);
            background: rgba(245, 158, 11, 0.1);
            border-radius: 16px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }
        .methodology-section h4 {
            color: #fde68a;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        .methodology-section .methodology {
        .methodology-section .methodology i {
            color: #f59e0b;
            margin-right: 0.5rem;
            width: 20px;
        .methodology-section .methodology strong {
        .practical-implementation {
            background: rgba(16, 185, 129, 0.1);
            border: 2px solid rgba(16, 185, 129, 0.4);
            border-radius: 12px;
            padding: 1rem;
            margin-top: 1rem;
        }
        .practical-implementation h5 {
            color: #6ee7b7;
        }
        .practical-implementation li {
            color: #a7f3d0;
        .export-section {
            margin-top: 2rem;
        .export-buttons {
            margin-top: 1.5rem;
        .btn-pdf {
            background: #dc2626;
            border: 2px solid white;
            padding: 1rem 2rem;
        .btn-pdf:hover {
            color: #dc2626;
        .btn-excel {
        .btn-excel:hover {
            color: #059669;
        .btn-word {
            background: #2563eb;
        .btn-word:hover {
            color: #2563eb;
        @media (max-width: 768px) {
            .workflow-progress {
                flex-direction: column;
                align-items: center;
            }
            
            .progress-step {
                margin: 0.25rem 0;
            .checkbox-group {
                grid-template-columns: 1fr;
            .export-buttons {
        /* AWS User System Styles - Integrated in Navigation */
        .user-system {
            margin-left: 20px;

        .user-info {
            gap: 12px;
            background: linear-gradient(135deg, #ffffff, #f8fafc);
            padding: 8px 16px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(99, 102, 241, 0.2);
        .user-info:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        .user-avatar {
            width: 32px;
            height: 32px;
            overflow: hidden;
            border: 2px solid #6366f1;
            box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3);
        .user-avatar-img {
            height: 100%;
            object-fit: cover;
        .user-details {
            flex-direction: column;
            gap: 2px;
        .user-name {
            font-size: 0.8rem;
            color: #1e293b;
            line-height: 1.2;
        .user-email {
            font-size: 0.7rem;
            color: #64748b;
        .user-logout {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            width: 28px;
            height: 28px;
            box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);
        .user-logout:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
        .user-login {
        .btn-login {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            border-radius: 20px;
            gap: 6px;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
        .btn-login:hover {
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
        .btn-login i {
        /* Responsive Design for User System */
            .user-system {
                margin-left: 10px;
            .user-info {
                padding: 6px 12px;
                gap: 8px;
            .user-avatar {
                width: 28px;
                height: 28px;
            .user-name {
                font-size: 0.7rem;
            .user-email {
                font-size: 0.6rem;
            .btn-login {
    </style>
    <link rel="stylesheet" href="css/unified-auth-system.css">

    <!-- Progress Badge Styles -->
    <style>
        .user-progress-badge {
            position: fixed;
            top: 80px;
            right: 20px;
            background: white;
            border-radius: 8px;
            padding: 12px 16px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            z-index: 100;
            display: flex;
            flex-direction: column;
            gap: 8px;
            font-size: 14px;
            min-width: 200px;
        }
        
        .user-progress-badge .user-info,
        .user-progress-badge .progress-sync {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #4a5568;
        }
        
        .user-progress-badge i {
            font-size: 16px;
            color: #667eea;
        }
        
        @media (max-width: 768px) {
            .user-progress-badge {
                top: auto;
                bottom: 20px;
                right: 10px;
                left: 10px;
                min-width: auto;
            }
        }
    </style>
</head>
<body data-page-id="change-management-workflow">

    <!-- Progress Badge -->
    <div class="user-progress-badge" style="display: none;">
        <div class="user-info">
            <i class="fas fa-user-circle"></i>
            <span>Nicht angemeldet</span>
        </div>
        <div class="progress-sync">
            <i class="fas fa-cloud-off-alt"></i>
            <span>Fortschritt lokal</span>
        </div>
    </div>
    <div class="change-mgmt-container">
        <!-- Smart Workflow Sidebar -->
        <div class="workflow-sidebar" id="workflowSidebar">
            <button class="sidebar-toggle" onclick="toggleSidebar()">
                <i class="fas fa-chevron-left" id="sidebarToggleIcon"></i>
            </button>
            
            <div class="sidebar-content" id="sidebarContent">
                <div class="progress-summary">
                    <h4 style="margin: 0 0 1rem; font-size: 1rem;">Fortschritt</h4>
                    <div class="progress-bar">
                        <div class="progress-fill" id="overallProgress" style="width: 0%;"></div>
                    </div>
                    <span class="progress-text" id="progressText">0% abgeschlossen</span>
                </div>
                
                <div class="current-state-indicator">
                    <div class="maturity-score">
                        <div class="score-circle" id="maturityCircle">1</div>
                        <div>
                            <div style="font-size: 0.875rem; color: #6b7280;">Change-Reifegrad</div>
                            <div id="maturityLevel">Anf√§nger</div>
                        </div>
                    </div>
                </div>
                
                <div style="display: flex; gap: 0.75rem; margin-top: 1rem; flex-wrap: wrap;">
                    <button onclick="exportAllToExcel()" style="background: #217346; color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 8px; font-size: 0.9rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; flex: 1; min-width: 120px;">
                        <i class="fas fa-file-excel"></i> Excel
                    </button>
                    <button onclick="exportAllToPDF()" style="background: #dc3545; color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 8px; font-size: 0.9rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; flex: 1; min-width: 120px;">
                        <i class="fas fa-file-pdf"></i> PDF
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Header -->
        <div class="workflow-header">
            <div class="smart-badge">
                <i class="fas fa-graduation-cap ai-icon"></i>
                Wissenschaftlich fundierte Methodologie
            </div>
            <h1><i class="fas fa-sync-alt"></i> Change Management</h1>
            <p>F√ºhren Sie erfolgreiche Transformationen durch mit systematischen Ver√§nderungsprozessen. Wissenschaftlich fundierte Bewertung und Entwicklung Ihrer Change-F√§higkeiten.</p>
        </div>
        
        <!-- Progress Indicator -->
        <div class="workflow-progress">
            <div class="progress-step active" data-step="0">
                <i class="fas fa-search"></i>
                <span>Ist-Analyse</span>
            </div>
            <div class="progress-step" data-step="1">
                <i class="fas fa-users"></i>
                <span>Stakeholder</span>
            </div>
            <div class="progress-step" data-step="2">
                <i class="fas fa-comments"></i>
                <span>Kommunikation</span>
            </div>
            <div class="progress-step" data-step="3">
                <i class="fas fa-exclamation-triangle"></i>
                <span>Widerstand</span>
            </div>
            <div class="progress-step" data-step="4">
                <i class="fas fa-graduation-cap"></i>
                <span>Training</span>
            </div>
            <div class="progress-step" data-step="5">
                <i class="fas fa-chart-line"></i>
                <span>Monitoring</span>
            </div>
            <div class="progress-step" data-step="6">
                <i class="fas fa-anchor"></i>
                <span>Verankerung</span>
            </div>
        </div>
        
        <!-- Step 0: Change-Reifegrad Analyse -->
        <div class="workflow-step active" data-step="0">
            <div class="step-header">
                <div class="step-number">üîç</div>
                <div class="step-title">
                    <h2>Change-Reifegrad Analyse</h2>
                    <p>Systematische Bewertung der aktuellen Change-F√§higkeiten in 7 Dimensionen</p>
                </div>
            </div>
            
            <div class="step-content">
                <div class="maturity-assessment-card" style="background: #f8fafc; border-radius: 16px; padding: 2rem; margin-bottom: 2rem; border: 2px solid #f59e0b;">
                    <h3 style="color: #1f2937; margin-bottom: 1rem;">üéØ Intelligente Ist-Zustand-Bewertung</h3>
                    <p style="color: #6b7280; margin-bottom: 1.5rem;">Bewerten Sie Ihre Change-F√§higkeiten in den kritischen Dimensionen. Diese Analyse bildet die Grundlage f√ºr Ihre ma√ügeschneiderte Change-Strategie.</p>
                    
                    <div class="assessment-grid">
                        <div class="assessment-category clickable-category" onclick="openDetailAssessment('readiness')" style="cursor: pointer;">
                            <div class="category-header">
                                <div class="category-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                                    <i class="fas fa-clipboard-check"></i>
                                </div>
                                <div>
                                    <h3>Change Readiness</h3>
                                    <p>Bereitschaft f√ºr Ver√§nderungen</p>
                                </div>
                            </div>
                            <div class="slider-container">
                                <input type="range" min="1" max="5" value="1" class="slider" id="readinessSlider" 
                                       oninput="updateAssessment('readiness', this.value)" 
                                       onclick="event.stopPropagation();">
                                <div class="slider-labels">
                                    <span>1</span>
                                    <span>2</span>
                                    <span>3</span>
                                    <span>4</span>
                                    <span>5</span>
                                </div>
                                <div class="slider-value-display" id="readinessValue">1</div>
                            </div>
                        </div>
                        
                        <div class="assessment-category clickable-category" onclick="openDetailAssessment('stakeholder')" style="cursor: pointer;">
                            <div class="category-header">
                                <div class="category-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div>
                                    <h3>Stakeholder-Analyse</h3>
                                    <p>Stakeholder-Management</p>
                                </div>
                            </div>
                            <div class="slider-container">
                                <input type="range" min="1" max="5" value="1" class="slider" id="stakeholderSlider" 
                                       oninput="updateAssessment('stakeholder', this.value)" 
                                       onclick="event.stopPropagation();">
                                <div class="slider-labels">
                                    <span>1</span>
                                    <span>2</span>
                                    <span>3</span>
                                    <span>4</span>
                                    <span>5</span>
                                </div>
                                <div class="slider-value-display" id="stakeholderValue">1</div>
                            </div>
                        </div>
                        
                        <div class="assessment-category clickable-category" onclick="openDetailAssessment('communication')" style="cursor: pointer;">
                            <div class="category-header">
                                <div class="category-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                                    <i class="fas fa-comments"></i>
                                </div>
                                <div>
                                    <h3>Kommunikationsstrategie</h3>
                                    <p>Change-Kommunikation</p>
                                </div>
                            </div>
                            <div class="slider-container">
                                <input type="range" min="1" max="5" value="1" class="slider" id="communicationSlider" 
                                       oninput="updateAssessment('communication', this.value)" 
                                       onclick="event.stopPropagation();">
                                <div class="slider-labels">
                                    <span>1</span>
                                    <span>2</span>
                                    <span>3</span>
                                    <span>4</span>
                                    <span>5</span>
                                </div>
                                <div class="slider-value-display" id="communicationValue">1</div>
                            </div>
                        </div>
                        
                        <div class="assessment-category clickable-category" onclick="openDetailAssessment('resistance')" style="cursor: pointer;">
                            <div class="category-header">
                                <div class="category-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                                <div>
                                    <h3>Widerstandsmanagement</h3>
                                    <p>Umgang mit Widerstand</p>
                                </div>
                            </div>
                            <div class="slider-container">
                                <input type="range" min="1" max="5" value="1" class="slider" id="resistanceSlider" 
                                       oninput="updateAssessment('resistance', this.value)" 
                                       onclick="event.stopPropagation();">
                                <div class="slider-labels">
                                    <span>1</span>
                                    <span>2</span>
                                    <span>3</span>
                                    <span>4</span>
                                    <span>5</span>
                                </div>
                                <div class="slider-value-display" id="resistanceValue">1</div>
                            </div>
                        </div>
                        
                        <div class="assessment-category clickable-category" onclick="openDetailAssessment('training')" style="cursor: pointer;">
                            <div class="category-header">
                                <div class="category-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                                    <i class="fas fa-graduation-cap"></i>
                                </div>
                                <div>
                                    <h3>Training & Development</h3>
                                    <p>Kompetenzentwicklung</p>
                                </div>
                            </div>
                            <div class="slider-container">
                                <input type="range" min="1" max="5" value="1" class="slider" id="trainingSlider" 
                                       oninput="updateAssessment('training', this.value)" 
                                       onclick="event.stopPropagation();">
                                <div class="slider-labels">
                                    <span>1</span>
                                    <span>2</span>
                                    <span>3</span>
                                    <span>4</span>
                                    <span>5</span>
                                </div>
                                <div class="slider-value-display" id="trainingValue">1</div>
                            </div>
                        </div>
                        
                        <div class="assessment-category clickable-category" onclick="openDetailAssessment('monitoring')" style="cursor: pointer;">
                            <div class="category-header">
                                <div class="category-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <div>
                                    <h3>Monitoring & Evaluation</h3>
                                    <p>Change-Messung</p>
                                </div>
                            </div>
                            <div class="slider-container">
                                <input type="range" min="1" max="5" value="1" class="slider" id="monitoringSlider" 
                                       oninput="updateAssessment('monitoring', this.value)" 
                                       onclick="event.stopPropagation();">
                                <div class="slider-labels">
                                    <span>1</span>
                                    <span>2</span>
                                    <span>3</span>
                                    <span>4</span>
                                    <span>5</span>
                                </div>
                                <div class="slider-value-display" id="monitoringValue">1</div>
                            </div>
                        </div>
                        
                        <div class="assessment-category clickable-category" onclick="openDetailAssessment('sustainability')" style="cursor: pointer;">
                            <div class="category-header">
                                <div class="category-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                                    <i class="fas fa-anchor"></i>
                                </div>
                                <div>
                                    <h3>Nachhaltige Verankerung</h3>
                                    <p>Change-Nachhaltigkeit</p>
                                </div>
                            </div>
                            <div class="slider-container">
                                <input type="range" min="1" max="5" value="1" class="slider" id="sustainabilitySlider" 
                                       oninput="updateAssessment('sustainability', this.value)" 
                                       onclick="event.stopPropagation();">
                                <div class="slider-labels">
                                    <span>1</span>
                                    <span>2</span>
                                    <span>3</span>
                                    <span>4</span>
                                    <span>5</span>
                                </div>
                                <div class="slider-value-display" id="sustainabilityValue">1</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 2rem; padding: 1.5rem; background: white; border-radius: 12px; border: 2px solid #f59e0b;">
                        <h3 style="color: #1f2937; margin-bottom: 1rem;">üìä Gesamtbewertung</h3>
                        <div style="display: flex; align-items: center; gap: 2rem; flex-wrap: wrap;">
                            <div style="text-align: center;">
                                <div class="score-circle-large" id="overallScore" style="width: 80px; height: 80px; border-radius: 50%; background: linear-gradient(135deg, #f59e0b, #d97706); color: white; display: flex; align-items: center; justify-content: center; font-size: 2rem; font-weight: 800; margin: 0 auto 0.5rem;">1.0</div>
                                <div style="font-size: 0.875rem; color: #6b7280;">Change-Reifegrad</div>
                            </div>
                            <div style="flex: 1; min-width: 200px;">
                                <div id="scoreDescription" style="font-size: 1rem; color: #1f2937; font-weight: 600; margin-bottom: 0.5rem;">Bewerten Sie die Dimensionen, um Ihre Gesamtbewertung zu sehen</div>
                                <div id="scoreRecommendation" style="font-size: 0.875rem; color: #6b7280;">Klicken Sie auf die Kategorien f√ºr detaillierte Bewertungen</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Step 1: Stakeholder-Analyse -->
        <div class="workflow-step" data-step="1" id="step1" style="display: none;">
            <div class="step-header">
                <div class="step-number">1</div>
                <div class="step-title">Change Readiness Assessment</div>
            <div class="step-description">
                <p>Bewerten Sie die Bereitschaft Ihrer Organisation f√ºr Ver√§nderungen und identifizieren Sie kritische Erfolgsfaktoren.</p>
            <div class="methodology-section">
                <h4><i class="fas fa-graduation-cap"></i> Change Readiness Methoden</h4>
                <div class="methodology">
                    <i class="fas fa-clipboard-check"></i>
                    <strong>Readiness Assessment:</strong> Systematische Bewertung der Organisationsbereitschaft f√ºr Change.
                </div>
                    <i class="fas fa-chart-bar"></i>
                    <strong>Capability Analysis:</strong> Analyse der vorhandenen Change-Management-F√§higkeiten.
                    <i class="fas fa-shield-alt"></i>
                    <strong>Risk Assessment:</strong> Identifikation und Bewertung von Change-Risiken.
            <div class="form-group">
                <label for="changeType">Art der Ver√§nderung</label>
                <select id="changeType">
                    <option value="strategic">Strategische Transformation</option>
                    <option value="organizational">Organisatorische Ver√§nderung</option>
                    <option value="technological">Technologische Transformation</option>
                    <option value="cultural">Kulturwandel</option>
                    <option value="process">Prozessoptimierung</option>
                    <option value="digital">Digitale Transformation</option>
                </select>
                <label for="changeScope">Umfang der Ver√§nderung</label>
                <select id="changeScope">
                    <option value="department">Abteilungsweise</option>
                    <option value="division">Bereichsweise</option>
                    <option value="company">Unternehmensweit</option>
                    <option value="group">Konzernweit</option>
                <label>Change Readiness Faktoren</label>
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="leadership" value="leadership">
                        <label for="leadership">F√ºhrungsunterst√ºtzung</label>
                    </div>
                        <input type="checkbox" id="culture" value="culture">
                        <label for="culture">Change-freundliche Kultur</label>
                        <input type="checkbox" id="resources" value="resources">
                        <label for="resources">Verf√ºgbare Ressourcen</label>
                        <input type="checkbox" id="capabilities" value="capabilities">
                        <label for="capabilities">Change-Management-F√§higkeiten</label>
                        <input type="checkbox" id="communication" value="communication">
                        <label for="communication">Kommunikationsstrukturen</label>
                        <input type="checkbox" id="stakeholders" value="stakeholders">
                        <label for="stakeholders">Stakeholder-Engagement</label>
                <label for="readinessScore">Change Readiness Score (1-10)</label>
                <input type="range" id="readinessScore" min="1" max="10" value="5">
                <div style="display: flex; justify-content: space-between; font-size: 0.9rem; color: #6b7280;">
                    <span>Niedrig (1)</span>
                    <span>Mittel (5)</span>
                    <span>Hoch (10)</span>
        <!-- Step 2: Stakeholder-Analyse -->
        <div class="workflow-step" data-step="2" id="step2" style="display: none;">
                <div class="step-number">2</div>
                <div class="step-title">Stakeholder-Analyse & Mapping</div>
                <p>Identifizieren und analysieren Sie alle relevanten Stakeholder f√ºr Ihren Change-Prozess.</p>
                <h4><i class="fas fa-graduation-cap"></i> Stakeholder Management</h4>
                    <i class="fas fa-users"></i>
                    <strong>Stakeholder Mapping:</strong> Systematische Identifikation und Kategorisierung aller Stakeholder.
                    <i class="fas fa-chart-pie"></i>
                    <strong>Influence-Interest Matrix:</strong> Bewertung von Einfluss und Interesse der Stakeholder.
                    <i class="fas fa-handshake"></i>
                    <strong>Engagement Strategy:</strong> Entwicklung ma√ügeschneiderter Engagement-Strategien.
                <label>Stakeholder-Gruppen</label>
                        <input type="checkbox" id="executives" value="executives">
                        <label for="executives">Gesch√§ftsf√ºhrung & Vorstand</label>
                        <input type="checkbox" id="managers" value="managers">
                        <label for="managers">F√ºhrungskr√§fte</label>
                        <input type="checkbox" id="employees" value="employees">
                        <label for="employees">Mitarbeiter</label>
                        <input type="checkbox" id="customers" value="customers">
                        <label for="customers">Kunden</label>
                        <input type="checkbox" id="suppliers" value="suppliers">
                        <label for="suppliers">Lieferanten & Partner</label>
                        <input type="checkbox" id="investors" value="investors">
                        <label for="investors">Investoren</label>
                <label for="keyStakeholders">Wichtige Stakeholder</label>
                <textarea id="keyStakeholders" rows="3" placeholder="Listen Sie die wichtigsten Stakeholder auf..."></textarea>
                <label for="stakeholderStrategy">Stakeholder-Engagement-Strategie</label>
                <textarea id="stakeholderStrategy" rows="4" placeholder="Beschreiben Sie Ihre Strategie f√ºr das Stakeholder-Engagement..."></textarea>
        <!-- Step 3: Kommunikationsstrategie -->
        <div class="workflow-step" data-step="3" id="step3" style="display: none;">
                <div class="step-number">3</div>
                <div class="step-title">Kommunikationsstrategie</div>
                <p>Entwickeln Sie eine umfassende Kommunikationsstrategie f√ºr transparente und effektive Change-Kommunikation.</p>
                <h4><i class="fas fa-graduation-cap"></i> Change Communication</h4>
                    <i class="fas fa-comments"></i>
                    <strong>Multi-Channel Communication:</strong> Nutzung verschiedener Kommunikationskan√§le f√ºr maximale Reichweite.
                    <i class="fas fa-heart"></i>
                    <strong>Emotional Intelligence:</strong> Ber√ºcksichtigung emotionaler Aspekte in der Change-Kommunikation.
                    <i class="fas fa-repeat"></i>
                    <strong>Two-Way Communication:</strong> F√∂rderung von Dialog und Feedback in der Kommunikation.
                <label>Kommunikationskan√§le</label>
                        <input type="checkbox" id="townhalls" value="townhalls">
                        <label for="townhalls">Town Hall Meetings</label>
                        <input type="checkbox" id="newsletters" value="newsletters">
                        <label for="newsletters">Newsletter & E-Mails</label>
                        <input type="checkbox" id="intranet" value="intranet">
                        <label for="intranet">Intranet & Digitale Plattformen</label>
                        <input type="checkbox" id="workshops" value="workshops">
                        <label for="workshops">Workshops & Trainings</label>
                        <input type="checkbox" id="oneonone" value="oneonone">
                        <label for="oneonone">Einzelgespr√§che</label>
                        <input type="checkbox" id="social" value="social">
                        <label for="social">Social Media & Collaboration Tools</label>
                <label for="keyMessages">Kernbotschaften</label>
                <textarea id="keyMessages" rows="4" placeholder="Definieren Sie die wichtigsten Botschaften f√ºr den Change..."></textarea>
                <label for="communicationPlan">Kommunikationsplan</label>
                <textarea id="communicationPlan" rows="4" placeholder="Beschreiben Sie Ihren detaillierten Kommunikationsplan..."></textarea>
        <!-- Step 4: Widerstandsmanagement -->
        <div class="workflow-step" data-step="4" id="step4" style="display: none;">
                <div class="step-number">4</div>
                <div class="step-title">Widerstandsmanagement</div>
                <p>Identifizieren und adressieren Sie Widerst√§nde gegen den Change-Prozess proaktiv.</p>
                <h4><i class="fas fa-graduation-cap"></i> Resistance Management</h4>
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>Resistance Analysis:</strong> Systematische Analyse von Widerstandsquellen und -ursachen.
                    <strong>Engagement Strategies:</strong> Entwicklung von Strategien zur √úberwindung von Widerst√§nden.
                    <strong>Open Dialogue:</strong> F√∂rderung offener Kommunikation √ºber Bedenken und √Ñngste.
                <label>Typische Widerstandsquellen</label>
                        <input type="checkbox" id="fear" value="fear">
                        <label for="fear">Angst vor Ver√§nderung</label>
                        <input type="checkbox" id="uncertainty" value="uncertainty">
                        <label for="uncertainty">Unsicherheit √ºber die Zukunft</label>
                        <input type="checkbox" id="loss" value="loss">
                        <label for="loss">Verlust von Status oder Macht</label>
                        <input type="checkbox" id="workload" value="workload">
                        <label for="workload">Zus√§tzliche Arbeitsbelastung</label>
                        <input type="checkbox" id="skills" value="skills">
                        <label for="skills">Fehlende Kompetenzen</label>
                        <input type="checkbox" id="trust" value="trust">
                        <label for="trust">Mangelndes Vertrauen</label>
                <label for="resistanceStrategy">Widerstandsmanagement-Strategie</label>
                <textarea id="resistanceStrategy" rows="4" placeholder="Beschreiben Sie Ihre Strategie zur Bew√§ltigung von Widerst√§nden..."></textarea>
        <!-- Step 5: Training & Development -->
        <div class="workflow-step" data-step="5" id="step5" style="display: none;">
                <div class="step-number">5</div>
                <div class="step-title">Training & Development</div>
                <p>Entwickeln Sie die notwendigen Kompetenzen f√ºr eine erfolgreiche Change-Implementierung.</p>
                <h4><i class="fas fa-graduation-cap"></i> Change Training</h4>
                    <i class="fas fa-graduation-cap"></i>
                    <strong>Competency Development:</strong> Entwicklung der notwendigen Change-Management-Kompetenzen.
                    <strong>Role-Based Training:</strong> Ma√ügeschneiderte Schulungen f√ºr verschiedene Rollen.
                    <strong>Change Champions:</strong> Ausbildung von Change-Botschaftern in der Organisation.
                <label>Schulungsbereiche</label>
                        <input type="checkbox" id="changeBasics" value="change-basics">
                        <label for="changeBasics">Change Management Grundlagen</label>
                        <label for="leadership">Change Leadership</label>
                        <label for="communication">Change Communication</label>
                        <input type="checkbox" id="resistance" value="resistance">
                        <label for="resistance">Widerstandsmanagement</label>
                        <input type="checkbox" id="tools" value="tools">
                        <label for="tools">Change Management Tools</label>
                        <input type="checkbox" id="coaching" value="coaching">
                        <label for="coaching">Change Coaching</label>
                <label for="trainingPlan">Schulungsplan</label>
                <textarea id="trainingPlan" rows="4" placeholder="Beschreiben Sie Ihren detaillierten Schulungsplan..."></textarea>
        <!-- Step 6: Monitoring & Evaluation -->
        <div class="workflow-step" data-step="6" id="step6" style="display: none;">
                <div class="step-number">6</div>
                <div class="step-title">Monitoring & Evaluation</div>
                <p>√úberwachen Sie den Fortschritt des Change-Prozesses und bewerten Sie den Erfolg.</p>
                <h4><i class="fas fa-graduation-cap"></i> Change Monitoring</h4>
                    <i class="fas fa-chart-line"></i>
                    <strong>Progress Tracking:</strong> Kontinuierliche √úberwachung des Change-Fortschritts.
                    <strong>KPI Monitoring:</strong> Messung und Bewertung von Change-Kennzahlen.
                    <strong>Feedback Loops:</strong> Etablierung von Feedback-Mechanismen f√ºr kontinuierliche Verbesserung.
                <label>Monitoring-Bereiche</label>
                        <input type="checkbox" id="adoption" value="adoption">
                        <label for="adoption">Adoption Rate</label>
                        <input type="checkbox" id="engagement" value="engagement">
                        <label for="engagement">Engagement Level</label>
                        <input type="checkbox" id="satisfaction" value="satisfaction">
                        <label for="satisfaction">Mitarbeiterzufriedenheit</label>
                        <input type="checkbox" id="performance" value="performance">
                        <label for="performance">Performance-Metriken</label>
                        <label for="resistance">Widerstandslevel</label>
                        <input type="checkbox" id="timeline" value="timeline">
                        <label for="timeline">Timeline-Adherence</label>
                <label for="evaluationPlan">Evaluationsplan</label>
                <textarea id="evaluationPlan" rows="4" placeholder="Beschreiben Sie Ihren Plan f√ºr die Bewertung des Change-Erfolgs..."></textarea>
        <!-- Step 7: Nachhaltige Verankerung -->
        <div class="workflow-step" id="step7" style="display: none;">
                <div class="step-number">7</div>
                <div class="step-title">Nachhaltige Verankerung</div>
                <p>Sichern Sie den langfristigen Erfolg der Change-Implementierung durch nachhaltige Verankerung.</p>
                <h4><i class="fas fa-graduation-cap"></i> Sustainable Change</h4>
                    <i class="fas fa-anchor"></i>
                    <strong>Change Anchoring:</strong> Verankerung der Ver√§nderungen in der Organisationskultur.
                    <i class="fas fa-sync-alt"></i>
                    <strong>Continuous Improvement:</strong> Etablierung kontinuierlicher Verbesserungsprozesse.
                    <strong>Change Sustainability:</strong> Sicherstellung der langfristigen Nachhaltigkeit der Ver√§nderungen.
                <label>Verankerungsstrategien</label>
                        <label for="culture">Kulturintegration</label>
                        <input type="checkbox" id="processes" value="processes">
                        <label for="processes">Prozessintegration</label>
                        <input type="checkbox" id="systems" value="systems">
                        <label for="systems">Systemintegration</label>
                        <input type="checkbox" id="governance" value="governance">
                        <label for="governance">Governance-Strukturen</label>
                        <label for="leadership">Leadership-Commitment</label>
                        <input type="checkbox" id="rewards" value="rewards">
                        <label for="rewards">Belohnungssysteme</label>
                <label for="sustainabilityPlan">Nachhaltigkeitsplan</label>
                <textarea id="sustainabilityPlan" rows="4" placeholder="Beschreiben Sie Ihren Plan f√ºr die nachhaltige Verankerung der Ver√§nderungen..."></textarea>
        <!-- Export Section -->
        <div class="export-section">
            <h3><i class="fas fa-download"></i> Change Management Plan herunterladen</h3>
            <p>Ihr entwickelter Change Management Plan ist bereit! Laden Sie die Zusammenfassung herunter und implementieren Sie sie in Ihrem Unternehmen.</p>
            <div class="export-buttons">
                <a href="#" class="btn-pdf" onclick="exportChangeMgmtToPDF()">
                    <i class="fas fa-file-pdf"></i> Als PDF
                </a>
                <a href="#" class="btn-excel" onclick="exportChangeMgmtToExcel()">
                    <i class="fas fa-file-excel"></i> Als Excel
                <a href="#" class="btn-word" onclick="exportChangeMgmtToWord()">
                    <i class="fas fa-file-word"></i> Als Word
        <!-- Navigation Buttons -->
        <div style="text-align: center; margin-top: 2rem;">
            <button class="btn btn-secondary" id="prevBtn" onclick="changeStep(-1)" style="display: none;">
                <i class="fas fa-arrow-left"></i> Zur√ºck
            </button>
            <button class="btn btn-success" id="nextBtn" onclick="changeStep(1)">
                Weiter <i class="fas fa-arrow-right"></i>
    </div>
<!-- Auth Modals -->
<div id="authModalsContainer"></div>
<script>
        // Change Management Assessment System
        let changeMgmtMaturityData = {
            readiness: 1,
            stakeholder: 1,
            communication: 1,
            resistance: 1,
            training: 1,
            monitoring: 1,
            sustainability: 1
        };
        let overallChangeMgmtMaturity = 1.0;
        let currentStep = 0;
        const totalSteps = 7; // 0 = Assessment, 1-6 = Workflow steps
        let workflowExporter = null;
        
        // Sidebar functionality
        function toggleSidebar() {
            const sidebar = document.getElementById('workflowSidebar');
            const icon = document.getElementById('sidebarToggleIcon');
            const content = document.getElementById('sidebarContent');
            
            if (sidebar.classList.contains('collapsed')) {
                sidebar.classList.remove('collapsed');
                icon.className = 'fas fa-chevron-left';
                content.style.display = 'block';
            } else {
                sidebar.classList.add('collapsed');
                icon.className = 'fas fa-chevron-right';
                content.style.display = 'none';
            }
        }
        
        // Assessment functions
        function updateAssessment(dimension, value) {
            changeMgmtMaturityData[dimension] = parseInt(value);
            const valueDisplay = document.getElementById(`${dimension}Value`);
            if (valueDisplay) {
                valueDisplay.textContent = value;
            }
            calculateOverallMaturity();
            updateMaturityDisplay();
            saveProgress();
        }
        
        function calculateOverallMaturity() {
            // Load detail assessments if available
            const detailAssessments = JSON.parse(localStorage.getItem('changeMgmtDetailAssessments') || '{}');
            let total = 0;
            let count = 0;
            
            Object.keys(changeMgmtMaturityData).forEach(dimension => {
                if (detailAssessments[dimension] && detailAssessments[dimension].aggregated) {
                    total += parseFloat(detailAssessments[dimension].aggregated);
                } else {
                    total += changeMgmtMaturityData[dimension];
                }
                count++;
            });
            
            overallChangeMgmtMaturity = parseFloat((total / count).toFixed(1));
        }
        
        function updateMaturityDisplay() {
            const circle = document.getElementById('overallScore');
            const description = document.getElementById('scoreDescription');
            const recommendation = document.getElementById('scoreRecommendation');
            const sidebarCircle = document.getElementById('maturityCircle');
            const sidebarLevel = document.getElementById('maturityLevel');
            
            if (circle) circle.textContent = overallChangeMgmtMaturity.toFixed(1);
            
            let level, desc, rec, colorClass;
            if (overallChangeMgmtMaturity <= 1.5) {
                level = 'Anf√§nger';
                desc = 'Change-Einsteiger';
                rec = 'Fokus auf Grundlagen und Change-Readiness';
                colorClass = 'score-beginner';
            } else if (overallChangeMgmtMaturity <= 2.5) {
                level = 'Aufsteiger';
                desc = 'Change-Aufsteiger';
                rec = 'Grundlagen vorhanden, weitere Entwicklung n√∂tig';
                colorClass = 'score-intermediate';
            } else if (overallChangeMgmtMaturity <= 3.5) {
                level = 'Fortgeschritten';
                desc = 'Change-Fortgeschritten';
                rec = 'Solide Basis, Optimierung m√∂glich';
                colorClass = 'score-advanced';
            } else if (overallChangeMgmtMaturity <= 4.5) {
                level = 'Experte';
                desc = 'Change-Experte';
                rec = 'Hohe Reife, kleine Verbesserungen m√∂glich';
                colorClass = 'score-expert';
            } else {
                level = 'Exzellent';
                desc = 'Change-Exzellenz';
                rec = 'Hervorragende Change-F√§higkeiten';
                colorClass = 'score-expert';
            }
            
            if (description) description.textContent = desc;
            if (recommendation) recommendation.textContent = rec;
            if (sidebarCircle) {
                sidebarCircle.textContent = Math.round(overallChangeMgmtMaturity);
                sidebarCircle.className = `score-circle ${colorClass}`;
            }
            if (sidebarLevel) sidebarLevel.textContent = level;
        }
        
        function openDetailAssessment(dimension) {
            // Save current progress
            saveProgress();
            // Navigate to detail page
            window.location.href = `change-mgmt-assessment-detail-${dimension}.html`;
        }
        
        function loadDetailAssessments() {
            const detailAssessments = JSON.parse(localStorage.getItem('changeMgmtDetailAssessments') || '{}');
            Object.keys(detailAssessments).forEach(dimension => {
                if (detailAssessments[dimension].aggregated) {
                    changeMgmtMaturityData[dimension] = parseFloat(detailAssessments[dimension].aggregated);
                    const slider = document.getElementById(`${dimension}Slider`);
                    const valueDisplay = document.getElementById(`${dimension}Value`);
                    if (slider) slider.value = changeMgmtMaturityData[dimension];
                    if (valueDisplay) valueDisplay.textContent = changeMgmtMaturityData[dimension].toFixed(1);
                }
            });
            calculateOverallMaturity();
            updateMaturityDisplay();
        }
    // Load auth modals
    async function loadAuthModals() {
        try {
            const response = await fetch('components/auth-modals.html');
            const html = await response.text();
            document.getElementById('authModalsContainer').innerHTML = html;
        } catch (error) {
            console.error('Error loading auth modals:', error);
    }
    // AWS User System Functions
    function loginUser() {
        const modal = document.getElementById('loginModal');
        if (modal) {
            modal.style.display = 'flex';
    function logoutUser() {
        if (window.awsAuth) {
            window.awsAuth.signOut().then(() => {
                console.log('Erfolgreich abgemeldet');
            }).catch(error => {
                console.error('Fehler beim Abmelden:', error);
            });
    // Initialize auth system
    document.addEventListener('DOMContentLoaded', async function() {
        await loadAuthModals();
        // Check user status
            window.awsAuth.checkUserStatus();
    });
        // Navigation functions
        function changeStep(direction) {
            const prevStep = currentStep;
            currentStep += direction;
            if (currentStep < 0) currentStep = 0;
            if (currentStep >= totalSteps) currentStep = totalSteps - 1;
            if (currentStep !== prevStep) {
                updateStepDisplay();
                updateProgress();
                updateNavigation();
                saveProgress();
            }
        }
        
        function updateStepDisplay() {
            document.querySelectorAll('.workflow-step').forEach((step, index) => {
                step.classList.remove('active');
                step.style.display = 'none';
                if (index === currentStep) {
                    step.classList.add('active');
                    step.style.display = 'block';
                }
            });
        }
        
        function updateProgress() {
            document.querySelectorAll('.progress-step').forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index < currentStep) {
                    step.classList.add('completed');
                } else if (index === currentStep) {
                    step.classList.add('active');
                }
            });
            
            updateOverallProgress();
        }
        
        function updateOverallProgress() {
            const progress = ((currentStep + 1) / totalSteps) * 100;
            const progressFill = document.getElementById('overallProgress');
            const progressText = document.getElementById('progressText');
            if (progressFill) progressFill.style.width = `${progress}%`;
            if (progressText) progressText.textContent = `${Math.round(progress)}% abgeschlossen`;
        }
        
        function updateNavigation() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            if (prevBtn) prevBtn.style.display = currentStep > 0 ? 'inline-block' : 'none';
            if (nextBtn) {
                nextBtn.textContent = currentStep === totalSteps - 1 ? 'Strategie generieren' : 'Weiter';
                nextBtn.onclick = currentStep === totalSteps - 1 ? generateChangeMgmtStrategy : () => changeStep(1);
            }
        }
        
        function saveProgress() {
            const progressData = {
                currentStep: currentStep,
                changeMgmtMaturityData: changeMgmtMaturityData,
                overallMaturity: overallChangeMgmtMaturity,
                timestamp: new Date().toISOString()
            };
            localStorage.setItem('changeMgmtWorkflow', JSON.stringify(progressData));
        }
        
        function loadProgress() {
            const saved = localStorage.getItem('changeMgmtWorkflow');
            if (saved) {
                const data = JSON.parse(saved);
                currentStep = data.currentStep || 0;
                if (data.changeMgmtMaturityData) {
                    changeMgmtMaturityData = data.changeMgmtMaturityData;
                    Object.keys(changeMgmtMaturityData).forEach(dimension => {
                        const slider = document.getElementById(`${dimension}Slider`);
                        const valueDisplay = document.getElementById(`${dimension}Value`);
                        if (slider) slider.value = changeMgmtMaturityData[dimension];
                        if (valueDisplay) valueDisplay.textContent = changeMgmtMaturityData[dimension];
                    });
                }
                calculateOverallMaturity();
                updateMaturityDisplay();
                updateStepDisplay();
                updateProgress();
                updateNavigation();
            }
        }
        
        // Export functions
        async function exportAllToExcel() {
            if (!workflowExporter) {
                workflowExporter = new AssessmentExporter();
                await new Promise(resolve => setTimeout(resolve, 1000));
            }
            const data = prepareCompleteExportData();
            await workflowExporter.exportToExcel(data, `Change-Management-Gesamt-Assessment-${new Date().toISOString().split('T')[0]}`);
        }
        
        async function exportAllToPDF() {
            if (!workflowExporter) {
                workflowExporter = new AssessmentExporter();
                await new Promise(resolve => setTimeout(resolve, 1000));
            }
            const data = prepareCompleteExportData();
            await workflowExporter.exportToPDF(data, `Change-Management-Gesamt-Assessment-${new Date().toISOString().split('T')[0]}`);
        }
        
        function prepareCompleteExportData() {
            const detailAssessments = JSON.parse(localStorage.getItem('changeMgmtDetailAssessments') || '{}');
            return {
                overall: overallChangeMgmtMaturity,
                dimensions: {
                    readiness: { aggregated: detailAssessments.readiness?.aggregated || changeMgmtMaturityData.readiness },
                    stakeholder: { aggregated: detailAssessments.stakeholder?.aggregated || changeMgmtMaturityData.stakeholder },
                    communication: { aggregated: detailAssessments.communication?.aggregated || changeMgmtMaturityData.communication },
                    resistance: { aggregated: detailAssessments.resistance?.aggregated || changeMgmtMaturityData.resistance },
                    training: { aggregated: detailAssessments.training?.aggregated || changeMgmtMaturityData.training },
                    monitoring: { aggregated: detailAssessments.monitoring?.aggregated || changeMgmtMaturityData.monitoring },
                    sustainability: { aggregated: detailAssessments.sustainability?.aggregated || changeMgmtMaturityData.sustainability }
                },
                maturityData: changeMgmtMaturityData,
                timestamp: new Date().toISOString()
            };
        }
        
        function generateChangeMgmtStrategy() {
        function generateChangeMgmtPlan() {
            // Collect all form data
            const planData = {
                changeType: document.getElementById('changeType').value || '',
                changeScope: document.getElementById('changeScope').value || '',
                readinessScore: document.getElementById('readinessScore').value || '',
                keyStakeholders: document.getElementById('keyStakeholders').value || '',
                stakeholderStrategy: document.getElementById('stakeholderStrategy').value || '',
                keyMessages: document.getElementById('keyMessages').value || '',
                communicationPlan: document.getElementById('communicationPlan').value || '',
                resistanceStrategy: document.getElementById('resistanceStrategy').value || '',
                trainingPlan: document.getElementById('trainingPlan').value || '',
                evaluationPlan: document.getElementById('evaluationPlan').value || '',
                sustainabilityPlan: document.getElementById('sustainabilityPlan').value || '',
                timestamp: new Date().toISOString()
            };
            console.log('Change Management Plan Data:', planData);
            alert('‚úÖ Change Management Plan erfolgreich generiert! Sie k√∂nnen jetzt die Zusammenfassung herunterladen.');
        function exportChangeMgmtToPDF() {
            const planData = collectChangeMgmtData();
            const content = generateChangeMgmtContent(planData);
            downloadFile(content, 'change-management-plan.pdf', 'application/pdf');
        function exportChangeMgmtToExcel() {
            downloadFile(content, 'change-management-plan.xlsx', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
        function exportChangeMgmtToWord() {
            downloadFile(content, 'change-management-plan.docx', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document');
        function collectChangeMgmtData() {
            return {
                company: 'Ihr Unternehmen',
        function generateChangeMgmtContent(data) {
            return `# Change Management Plan f√ºr ${data.company}
## 1. Change Assessment
**Art der Ver√§nderung:** ${data.changeType || 'Nicht definiert'}
**Umfang:** ${data.changeScope || 'Nicht definiert'}
**Readiness Score:** ${data.readinessScore || 'Nicht definiert'}/10
## 2. Stakeholder Management
**Wichtige Stakeholder:** ${data.keyStakeholders || 'Nicht definiert'}
**Engagement-Strategie:** ${data.stakeholderStrategy || 'Nicht definiert'}
## 3. Kommunikationsstrategie
**Kernbotschaften:** ${data.keyMessages || 'Nicht definiert'}
**Kommunikationsplan:** ${data.communicationPlan || 'Nicht definiert'}
## 4. Widerstandsmanagement
**Strategie:** ${data.resistanceStrategy || 'Nicht definiert'}
## 5. Training & Development
**Schulungsplan:** ${data.trainingPlan || 'Nicht definiert'}
## 6. Monitoring & Evaluation
**Evaluationsplan:** ${data.evaluationPlan || 'Nicht definiert'}
## 7. Nachhaltige Verankerung
**Nachhaltigkeitsplan:** ${data.sustainabilityPlan || 'Nicht definiert'}
---
Erstellt am: ${data.timestamp}
Entwickelt mit wissenschaftlichen Change Management Methoden`;
        function downloadFile(content, filename, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            alert(`‚úÖ ${filename} erfolgreich heruntergeladen!`);
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadProgress();
            loadDetailAssessments();
            calculateOverallMaturity();
            updateMaturityDisplay();
            updateStepDisplay();
            updateProgress();
            updateNavigation();
            workflowExporter = new AssessmentExporter();
        });
    </script>
    
    <!-- Assessment Export Script -->
    <script src="js/assessment-export.js"></script>

    <!-- AWS Configuration -->
    <script>
        window.AWS_CONFIG = {
            region: 'eu-central-1',
            userPoolId: 'eu-central-1_8gP4gLK9r',
            clientId: '7kc5tt6a23fgh53d60vkefm812',
            apiBaseUrl: 'https://of2iwj7h2c.execute-api.eu-central-1.amazonaws.com/prod',
            dynamoDB: {
                tableName: 'mawps-user-profiles',
                region: 'eu-central-1'
            },
            s3: {
                bucket: 'mawps-user-files-1760106396',
                region: 'eu-central-1'
            }
        };
    </script>
    
    <!-- AWS SDK -->
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1490.0.min.js"></script>
    
    <!-- Auth & Progress Tracking -->
    <script src="/js/aws-profile-api.js"></script>
    <script src="/js/real-user-auth-system.js?v=20250116"></script>
    <script src="/js/user-progress-tracker.js"></script>
    <script src="/js/personality-auth-integration.js"></script>
</body>
</html>
