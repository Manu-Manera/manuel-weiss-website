<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bewerbungsverwaltung - Manuel Weiss</title>
    
    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <style>
        /* Admin Sidebar Styles */
        .admin-sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 280px;
            height: 100vh;
            background: linear-gradient(180deg, #1e293b 0%, #334155 100%);
            color: white;
            z-index: 1000;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }
        
        .sidebar-header {
            padding: 2rem 1.5rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .sidebar-logo-img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
        }
        
        .sidebar-title {
            font-size: 1.25rem;
            font-weight: 700;
        }
        
        .sidebar-nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .sidebar-nav li {
            margin: 0;
        }
        
        .sidebar-link {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.5rem;
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }
        
        .sidebar-link:hover {
            background: rgba(255,255,255,0.1);
            color: white;
            border-left-color: #6366f1;
        }
        
        .sidebar-link.active {
            background: rgba(99, 102, 241, 0.2);
            color: white;
            border-left-color: #6366f1;
        }
        
        .sidebar-link i {
            width: 20px;
            text-align: center;
        }

        /* Bewerbungsseite spezifische Styles */
        .applications-page {
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 2rem 0;
            margin-left: 280px;
        }

        /* Designer Section Styles */
        .designer-section {
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 2rem 0;
            margin-left: 280px;
        }

        .designer-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .designer-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header-title {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-title h1 {
            margin: 0;
            color: #1e293b;
            font-size: 2rem;
            font-weight: 700;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .designer-content {
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 2rem;
            height: calc(100vh - 200px);
        }

        .designer-sidebar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            padding: 1.5rem;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .preview-area {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            padding: 1.5rem;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid #e2e8f0;
            margin-bottom: 1.5rem;
        }

        .tab {
            padding: 0.75rem 1rem;
            border: none;
            background: none;
            cursor: pointer;
            font-weight: 600;
            color: #64748b;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tab.active {
            color: #6366f1;
            border-bottom-color: #6366f1;
        }

        .tab:hover {
            color: #6366f1;
            background: rgba(99, 102, 241, 0.05);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .sidebar-section {
            margin-bottom: 2rem;
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 1rem;
            font-size: 1rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            font-weight: 500;
            color: #374151;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .color-picker {
            height: 40px;
            padding: 0.25rem;
        }

        .file-upload-area {
            border: 2px dashed #d1d5db;
            border-radius: 0.5rem;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-upload-area:hover {
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.05);
        }

        .file-upload-area i {
            font-size: 2rem;
            color: #9ca3af;
            margin-bottom: 0.5rem;
        }

        .file-upload-area p {
            color: #6b7280;
            margin: 0;
        }

        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #e2e8f0;
        }

        .preview-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            color: #1e293b;
        }

        .preview-content {
            background: #f8fafc;
            border-radius: 0.5rem;
            padding: 2rem;
            min-height: 500px;
        }

        /* Calendar Section Styles */
        .calendar-section {
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 2rem 0;
            margin-left: 280px;
        }

        .calendar-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .calendar-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .calendar-header h1 {
            margin: 0 0 0.5rem 0;
            color: #1e293b;
            font-size: 2rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
        }

        .calendar-header p {
            margin: 0;
            color: #64748b;
            font-size: 1.125rem;
        }

        .calendar-dashboard {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .dashboard-card {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            border-radius: 1rem;
            padding: 1.5rem;
            color: white;
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: transform 0.3s ease;
        }

        .dashboard-card:hover {
            transform: translateY(-2px);
        }

        .card-icon {
            font-size: 2rem;
            opacity: 0.8;
        }

        .card-content h3 {
            margin: 0;
            font-size: 2rem;
            font-weight: 700;
        }

        .card-content p {
            margin: 0;
            opacity: 0.9;
            font-size: 0.875rem;
        }

        .calendar-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        .calendar-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 2rem;
            height: calc(100vh - 400px);
        }

        .calendar-sidebar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            padding: 1.5rem;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .calendar-filters h3,
        .quick-actions h3 {
            margin: 0 0 1rem 0;
            color: #1e293b;
            font-size: 1rem;
            font-weight: 600;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-bottom: 2rem;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            cursor: pointer;
            font-size: 0.875rem;
            color: #374151;
        }

        .checkbox-label input[type="checkbox"] {
            display: none;
        }

        .checkmark {
            width: 20px;
            height: 20px;
            border: 2px solid #d1d5db;
            border-radius: 4px;
            position: relative;
            transition: all 0.3s ease;
        }

        .checkbox-label input[type="checkbox"]:checked + .checkmark {
            background: #6366f1;
            border-color: #6366f1;
        }

        .checkbox-label input[type="checkbox"]:checked + .checkmark::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .quick-action-btn {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }

        .quick-action-btn:hover {
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.05);
        }

        .calendar-main {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            padding: 1.5rem;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .calendar-view {
            margin-bottom: 2rem;
        }

        .calendar-header-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .calendar-header-nav h2 {
            margin: 0;
            color: #1e293b;
            font-size: 1.5rem;
            font-weight: 600;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background: #e2e8f0;
            border-radius: 0.5rem;
            overflow: hidden;
        }

        .calendar-day {
            background: white;
            padding: 1rem;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .calendar-day.other-month {
            background: #f8fafc;
            color: #9ca3af;
        }

        .calendar-day.today {
            background: rgba(99, 102, 241, 0.1);
        }

        .day-number {
            font-weight: 600;
            color: #1e293b;
        }

        .day-events {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .day-event {
            background: #6366f1;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            cursor: pointer;
        }

        .events-list h3 {
            margin: 0 0 1rem 0;
            color: #1e293b;
            font-size: 1.125rem;
            font-weight: 600;
        }

        .events-container {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .event-item {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 1rem;
            transition: all 0.3s ease;
        }

        .event-item:hover {
            border-color: #6366f1;
            box-shadow: 0 2px 8px rgba(99, 102, 241, 0.1);
        }

        .event-title {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0.25rem;
        }

        .event-time {
            color: #64748b;
            font-size: 0.875rem;
        }

        .event-type {
            display: inline-block;
            background: #6366f1;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            margin-top: 0.5rem;
        }

        /* Profile Section Styles */
        .profile-section {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-right: 1rem;
        }

        .profile-toggle {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .profile-toggle .btn {
            padding: 0.5rem 1rem;
            font-size: 0.75rem;
            min-width: auto;
        }

        .profile-display {
            position: relative;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            overflow: hidden;
            border: 3px solid #6366f1;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .profile-display:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .profile-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: all 0.3s ease;
        }

        .profile-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .profile-display:hover .profile-overlay {
            opacity: 1;
        }

        .play-btn {
            width: 32px;
            height: 32px;
            background: #6366f1;
            color: white;
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.875rem;
        }

        .play-btn:hover {
            background: #4f46e5;
            transform: scale(1.1);
        }

        .profile-display.digital-twin {
            border-color: #8b5cf6;
        }

        .profile-display.digital-twin .profile-overlay {
            background: rgba(139, 92, 246, 0.8);
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .designer-content,
            .calendar-content {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .designer-sidebar,
            .calendar-sidebar {
                order: 2;
            }

            .preview-area,
            .calendar-main {
                order: 1;
            }
        }

        @media (max-width: 768px) {
            .applications-page,
            .designer-section,
            .calendar-section {
                margin-left: 0;
                padding: 1rem 0;
            }

            .designer-header,
            .calendar-header {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }

            .header-actions {
                flex-wrap: wrap;
                justify-content: center;
            }

            .dashboard-cards {
                grid-template-columns: repeat(2, 1fr);
            }

            .calendar-actions {
                flex-direction: column;
            }
        }
        
        .applications-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }
        
        .applications-header {
            text-align: center;
            margin-bottom: 3rem;
            color: white;
        }
        
        .applications-header h1 {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 1rem;
            text-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        .applications-header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .applications-dashboard {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 2rem;
            margin-bottom: 3rem;
        }
        
        .stats-panel {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .stats-panel h2 {
            color: #1e293b;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        .stat-card {
            background: #f8fafc;
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
            border-left: 4px solid;
        }
        
        .stat-card.primary { border-left-color: #6366f1; }
        .stat-card.success { border-left-color: #10b981; }
        .stat-card.warning { border-left-color: #f59e0b; }
        .stat-card.danger { border-left-color: #ef4444; }
        .stat-card.info { border-left-color: #8b5cf6; }
        .stat-card.secondary { border-left-color: #64748b; }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            font-size: 0.875rem;
            color: #64748b;
            font-weight: 500;
        }
        
        .quick-actions {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .quick-actions h2 {
            color: #1e293b;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        .action-btn {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem;
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: #1e293b;
            font-weight: 500;
        }
        
        .action-btn:hover {
            background: #6366f1;
            color: white;
            border-color: #6366f1;
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(99, 102, 241, 0.3);
        }
        
        .action-btn i {
            font-size: 1.25rem;
        }
        
        .applications-content {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .content-header h2 {
            color: #1e293b;
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .filter-tabs {
            display: flex;
            gap: 0.5rem;
            background: #f1f5f9;
            padding: 0.25rem;
            border-radius: 8px;
        }
        
        .filter-tab {
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            color: #64748b;
        }
        
        .filter-tab.active {
            background: #6366f1;
            color: white;
        }
        
        .applications-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .application-card {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }
        
        .application-card:hover {
            border-color: #6366f1;
            box-shadow: 0 8px 16px rgba(99, 102, 241, 0.1);
        }
        
        .application-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        .application-info h3 {
            color: #1e293b;
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }
        
        .application-info p {
            color: #64748b;
            font-size: 0.875rem;
        }
        
        .application-status {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status-sent { background: #dbeafe; color: #1e40af; }
        .status-reviewed { background: #fef3c7; color: #92400e; }
        .status-interview { background: #d1fae5; color: #065f46; }
        .status-accepted { background: #dcfce7; color: #166534; }
        .status-rejected { background: #fee2e2; color: #991b1b; }
        
        .application-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .detail-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #64748b;
            font-size: 0.875rem;
        }
        
        .detail-item i {
            color: #6366f1;
        }
        
        .application-actions {
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
        }
        
        .action-icon {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.875rem;
        }

        .action-icon.action-designer {
            background: #8b5cf6;
            color: white;
        }

        .action-icon.action-designer:hover {
            background: #7c3aed;
            color: white;
        }

        /* Workflow Styles */
        .workflow-steps {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .workflow-step {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
        }

        .workflow-step.active {
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.05);
        }

        .step-number {
            width: 32px;
            height: 32px;
            background: #6366f1;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.875rem;
        }

        .step-content h4 {
            margin: 0 0 0.25rem 0;
            color: #1e293b;
            font-size: 1rem;
        }

        .step-content p {
            margin: 0;
            color: #64748b;
            font-size: 0.875rem;
        }

        .workflow-options h4 {
            margin: 0 0 1rem 0;
            color: #1e293b;
            font-size: 1rem;
        }

        .data-sources {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .data-source {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
        }

        .data-source.available {
            background: rgba(16, 185, 129, 0.1);
            color: #065f46;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .data-source.unavailable {
            background: rgba(239, 68, 68, 0.1);
            color: #991b1b;
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        .data-source i {
            width: 16px;
            text-align: center;
        }

        .loading-spinner {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem;
            color: #64748b;
            font-size: 0.875rem;
        }

        .workflow-progress {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .progress-step {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
        }

        .progress-step.completed {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .step-icon {
            width: 32px;
            height: 32px;
            background: #e2e8f0;
            color: #64748b;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .progress-step.completed .step-icon {
            background: #10b981;
            color: white;
        }

        .step-text {
            color: #374151;
            font-size: 0.875rem;
        }

        .progress-step.completed .step-text {
            color: #065f46;
            font-weight: 500;
        }

        .workflow-notification {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            max-width: 400px;
            animation: slideInRight 0.3s ease;
        }

        .notification-content {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1.5rem;
            position: relative;
        }

        .notification-content i {
            color: #10b981;
            font-size: 1.25rem;
            margin-top: 0.125rem;
        }

        .notification-text {
            flex: 1;
            color: #374151;
            font-size: 0.875rem;
            line-height: 1.5;
        }

        .notification-close {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: none;
            border: none;
            color: #9ca3af;
            cursor: pointer;
            font-size: 1.25rem;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.25rem;
            transition: all 0.3s ease;
        }

        .notification-close:hover {
            background: #f3f4f6;
            color: #374151;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Advanced Generation Styles */
        .generation-options {
            margin-bottom: 2rem;
        }

        .generation-options h4 {
            margin: 0 0 1rem 0;
            color: #1e293b;
            font-size: 1.125rem;
        }

        .option-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }

        .option-card {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option-card:hover {
            border-color: #6366f1;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.15);
        }

        .option-icon {
            font-size: 2rem;
            color: #6366f1;
            margin-bottom: 0.75rem;
        }

        .option-title {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0.25rem;
        }

        .option-desc {
            font-size: 0.75rem;
            color: #64748b;
        }

        .ai-analysis {
            margin-bottom: 2rem;
        }

        .ai-analysis h4 {
            margin: 0 0 1rem 0;
            color: #1e293b;
            font-size: 1.125rem;
        }

        .analysis-results {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 1rem;
        }

        .analysis-item {
            margin-bottom: 0.75rem;
            font-size: 0.875rem;
            color: #374151;
        }

        .analysis-item:last-child {
            margin-bottom: 0;
        }

        .analysis-item strong {
            color: #1e293b;
        }

        .quality-preview h4 {
            margin: 0 0 1rem 0;
            color: #1e293b;
            font-size: 1.125rem;
        }

        .quality-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
        }

        .metric {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 1rem;
            text-align: center;
        }

        .metric-label {
            display: block;
            font-size: 0.75rem;
            color: #64748b;
            margin-bottom: 0.25rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .metric-value {
            display: block;
            font-size: 1.5rem;
            font-weight: 700;
            color: #6366f1;
        }

        .generation-spinner {
            text-align: center;
        }

        .generation-spinner h3 {
            margin: 0 0 0.5rem 0;
            color: #1e293b;
        }

        .generation-spinner p {
            margin: 0 0 1.5rem 0;
            color: #64748b;
            font-size: 0.875rem;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #6366f1, #8b5cf6);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* Smart Templates & Snippets */
        .smart-templates {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .smart-templates h3 {
            margin: 0 0 1rem 0;
            color: #1e293b;
            font-size: 1.125rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .template-snippets {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .snippet-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .snippet-card:hover {
            border-color: #6366f1;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.15);
        }

        .snippet-title {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }

        .snippet-preview {
            font-size: 0.75rem;
            color: #64748b;
            line-height: 1.4;
        }

        /* Batch Processing */
        .batch-actions {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .batch-actions h3 {
            margin: 0 0 1rem 0;
            color: #1e293b;
            font-size: 1.125rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .batch-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .batch-btn {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            border: none;
            border-radius: 0.5rem;
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .batch-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
        }

        /* Real-time Feedback */
        .quality-feedback {
            position: fixed;
            top: 2rem;
            left: 2rem;
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 1rem;
            z-index: 1000;
            min-width: 250px;
            display: none;
        }

        .quality-feedback.active {
            display: block;
            animation: slideInLeft 0.3s ease;
        }

        .feedback-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }

        .feedback-title {
            font-weight: 600;
            color: #1e293b;
            font-size: 0.875rem;
        }

        .feedback-metrics {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .feedback-metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.75rem;
        }

        .metric-name {
            color: #64748b;
        }

        .metric-score {
            font-weight: 600;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
        }

        .metric-score.excellent {
            background: rgba(16, 185, 129, 0.1);
            color: #065f46;
        }

        .metric-score.good {
            background: rgba(59, 130, 246, 0.1);
            color: #1e40af;
        }

        .metric-score.needs-improvement {
            background: rgba(245, 158, 11, 0.1);
            color: #92400e;
        }

        .metric-score.poor {
            background: rgba(239, 68, 68, 0.1);
            color: #991b1b;
        }

        @keyframes slideInLeft {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Auto-save indicator */
        .auto-save-indicator {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: rgba(16, 185, 129, 0.9);
            color: white;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            z-index: 1000;
            display: none;
            animation: fadeInUp 0.3s ease;
        }

        .auto-save-indicator.active {
            display: block;
        }

        @keyframes fadeInUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .action-edit { background: #dbeafe; color: #1e40af; }
        .action-edit:hover { background: #1e40af; color: white; }
        
        .action-delete { background: #fee2e2; color: #991b1b; }
        .action-delete:hover { background: #991b1b; color: white; }
        
        .action-view { background: #f3e8ff; color: #7c3aed; }
        .action-view:hover { background: #7c3aed; color: white; }
        
        .action-share { background: #ecfdf5; color: #059669; }
        .action-share:hover { background: #059669; color: white; }
        
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: #64748b;
        }
        
        .empty-state i {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }
        
        .empty-state h3 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }
        
        .empty-state p {
            margin-bottom: 1.5rem;
        }
        
        .btn-primary {
            background: #6366f1;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background: #4f46e5;
            transform: translateY(-2px);
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }
        
        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 20px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .modal-header h3 {
            color: #1e293b;
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #64748b;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #1e293b;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #6366f1;
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .modal-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
        }
        
        .btn-secondary {
            background: #f1f5f9;
            color: #64748b;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            border: 2px solid #e2e8f0;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            background: #e2e8f0;
        }
        
        /* AI Generator Styles */
        .ai-generator-content {
            padding: 1rem 0;
        }
        
        .ai-step {
            display: none;
            padding: 1.5rem 0;
        }
        
        .ai-step.active {
            display: block;
        }
        
        .ai-step h4 {
            color: #1e293b;
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .ai-step p {
            color: #64748b;
            margin-bottom: 1.5rem;
        }
        
        .data-analysis {
            background: #f8fafc;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .analysis-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .analysis-item:last-child {
            border-bottom: none;
        }
        
        .analysis-item i {
            color: #6366f1;
            margin-right: 0.75rem;
        }
        
        .analysis-item span {
            flex: 1;
            font-weight: 500;
            color: #1e293b;
        }
        
        .analysis-status {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            background: #dbeafe;
            color: #1e40af;
        }
        
        .analysis-status.completed {
            background: #d1fae5;
            color: #065f46;
        }
        
        .analysis-status.error {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .ai-progress {
            background: #f8fafc;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 1rem;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #6366f1, #8b5cf6);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .progress-text {
            text-align: center;
            color: #64748b;
            font-weight: 500;
        }
        
        .ai-insights {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .ai-insights h5 {
            color: #0369a1;
            font-weight: 600;
            margin-bottom: 1rem;
        }
        
        .ai-insights ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .ai-insights li {
            padding: 0.5rem 0;
            color: #0c4a6e;
            border-bottom: 1px solid #bae6fd;
        }
        
        .ai-insights li:last-child {
            border-bottom: none;
        }
        
        .ai-insights li::before {
            content: "✓";
            color: #059669;
            font-weight: bold;
            margin-right: 0.5rem;
        }
        
        .generated-letter {
            background: #f8fafc;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            border: 1px solid #e2e8f0;
        }
        
        .letter-header {
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .letter-header h5 {
            color: #1e293b;
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .letter-header p {
            color: #64748b;
            margin: 0;
        }
        
        .letter-content {
            line-height: 1.6;
            color: #1e293b;
            white-space: pre-wrap;
        }
        
        .letter-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        /* Share Modal Styles */
        .share-content {
            padding: 1rem 0;
        }
        
        .application-preview {
            background: #f8fafc;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .application-preview h4 {
            color: #1e293b;
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .application-preview p {
            color: #64748b;
            margin: 0;
        }
        
        .share-options {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        .share-option {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .share-option label {
            font-weight: 600;
            color: #1e293b;
        }
        
        .url-container {
            display: flex;
            gap: 0.5rem;
        }
        
        .url-container input {
            flex: 1;
            padding: 0.75rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-family: monospace;
            font-size: 0.875rem;
            background: #f8fafc;
        }
        
        .copy-url-btn {
            background: #6366f1;
            color: white;
            border: none;
            padding: 0.75rem;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        
        .copy-url-btn:hover {
            background: #4f46e5;
        }
        
        .copy-email-btn {
            background: #10b981;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            align-self: flex-start;
        }
        
        .copy-email-btn:hover {
            background: #059669;
        }
        
        .share-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #e2e8f0;
        }
        
        /* Editing Tools Styles */
        .editing-tools {
            background: #f8fafc;
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border: 1px solid #e2e8f0;
        }
        
        .tool-section h6 {
            color: #1e293b;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .tool-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .tool-btn {
            background: #6366f1;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .tool-btn:hover {
            background: #4f46e5;
            transform: translateY(-2px);
        }
        
        .tool-btn.active {
            background: #10b981;
        }
        
        /* Sentence Alternatives Styles */
        .sentence-alternatives {
            padding: 1rem 0;
        }
        
        .original-sentence {
            background: #f1f5f9;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .original-sentence h5 {
            color: #1e293b;
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .original-sentence p {
            color: #64748b;
            font-style: italic;
            margin: 0;
        }
        
        .alternatives h5 {
            color: #1e293b;
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }
        
        .alternative-options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .alternative-option {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .alternative-option:hover {
            border-color: #6366f1;
            background: #f8fafc;
        }
        
        .alternative-option.selected {
            border-color: #10b981;
            background: #f0fdf4;
        }
        
        .alternative-option::before {
            content: "✓";
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            color: #10b981;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .alternative-option.selected::before {
            opacity: 1;
        }
        
        .alternative-text {
            color: #1e293b;
            line-height: 1.5;
            margin: 0;
        }
        
        .sentence-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #e2e8f0;
        }
        
        /* Paragraph Regeneration Styles */
        .paragraph-regeneration {
            padding: 1rem 0;
        }
        
        .paragraph-selection h5 {
            color: #1e293b;
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }
        
        .paragraph-options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-bottom: 2rem;
        }
        
        .paragraph-option {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .paragraph-option:hover {
            border-color: #6366f1;
            background: #f1f5f9;
        }
        
        .paragraph-option.selected {
            border-color: #10b981;
            background: #f0fdf4;
        }
        
        .paragraph-option::before {
            content: "✓";
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            color: #10b981;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .paragraph-option.selected::before {
            opacity: 1;
        }
        
        .paragraph-preview {
            color: #64748b;
            font-size: 0.875rem;
            line-height: 1.4;
            margin: 0;
        }
        
        .regeneration-options {
            background: #f8fafc;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .regeneration-options h5 {
            color: #1e293b;
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }
        
        .regeneration-options .form-group {
            margin-bottom: 1rem;
        }
        
        .regeneration-options .form-group:last-child {
            margin-bottom: 0;
        }
        
        .paragraph-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            padding-top: 1rem;
            border-top: 1px solid #e2e8f0;
        }
        
        /* Editable Letter Content */
        .letter-content.editable {
            position: relative;
        }
        
        .letter-content.editable .sentence {
            position: relative;
            cursor: pointer;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            transition: background 0.3s ease;
        }
        
        .letter-content.editable .sentence:hover {
            background: #f1f5f9;
        }
        
        .letter-content.editable .sentence.selected {
            background: #dbeafe;
            border: 1px solid #3b82f6;
        }
        
        .letter-content.editable .paragraph {
            position: relative;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 6px;
            transition: background 0.3s ease;
            margin-bottom: 1rem;
        }
        
        .letter-content.editable .paragraph:hover {
            background: #f1f5f9;
        }
        
        .letter-content.editable .paragraph.selected {
            background: #dbeafe;
            border: 1px solid #3b82f6;
        }
        
        .edit-hint {
            position: absolute;
            top: -2rem;
            left: 0;
            background: #1e293b;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }
        
        .sentence:hover .edit-hint,
        .paragraph:hover .edit-hint {
            opacity: 1;
        }
        
        /* Animation for new applications */
        @keyframes pulse {
            0% { 
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.7);
            }
            50% { 
                transform: scale(1.02);
                box-shadow: 0 0 0 10px rgba(99, 102, 241, 0);
            }
            100% { 
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(99, 102, 241, 0);
            }
        }
        
        .application-card.new-application {
            border: 2px solid #10b981;
            background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);
        }
        
        .application-card.new-application::before {
            content: "🆕";
            position: absolute;
            top: -8px;
            right: -8px;
            background: #10b981;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        /* Status Dropdown Styles */
        .application-status {
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .application-status:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .status-arrow {
            font-size: 0.75rem;
            transition: transform 0.3s ease;
        }
        
        .application-status:hover .status-arrow {
            transform: rotate(180deg);
        }
        
        /* Status Change Modal Styles */
        .status-change-content {
            padding: 1.5rem 0;
        }
        
        .current-status {
            margin-bottom: 2rem;
        }
        
        .current-status h4 {
            color: #374151;
            margin-bottom: 0.75rem;
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        .status-display {
            padding: 0.75rem 1rem;
            border-radius: 8px;
            font-weight: 600;
            text-align: center;
            border: 2px solid;
        }
        
        .status-options h4 {
            color: #374151;
            margin-bottom: 1rem;
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        .status-options-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
            margin-bottom: 2rem;
        }
        
        .status-option {
            padding: 0.75rem 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-weight: 500;
            position: relative;
        }
        
        .status-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .status-option.selected {
            border-color: #3b82f6;
            background: #eff6ff;
            color: #1e40af;
        }
        
        .status-option.selected::before {
            content: "✓";
            position: absolute;
            top: -8px;
            right: -8px;
            background: #3b82f6;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        .status-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }
        
        /* Quick Status Section Styles */
        .quick-status-section {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid #e5e7eb;
        }
        
        .quick-status-section h3 {
            color: #374151;
            margin-bottom: 1rem;
            font-size: 1rem;
            font-weight: 600;
        }
        
        .status-quick-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 0.75rem;
        }
        
        .status-quick-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem 0.75rem;
            border: 2px solid;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.875rem;
            font-weight: 500;
        }
        
        .status-quick-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .status-quick-btn i {
            font-size: 1.25rem;
        }
        
        .status-quick-btn span {
            font-size: 0.75rem;
            text-align: center;
        }
        
        /* Status-specific colors */
        .status-quick-btn.status-sent {
            border-color: #3b82f6;
            color: #3b82f6;
        }
        
        .status-quick-btn.status-sent:hover {
            background: #eff6ff;
        }
        
        .status-quick-btn.status-reviewed {
            border-color: #f59e0b;
            color: #f59e0b;
        }
        
        .status-quick-btn.status-reviewed:hover {
            background: #fffbeb;
        }
        
        .status-quick-btn.status-interview {
            border-color: #8b5cf6;
            color: #8b5cf6;
        }
        
        .status-quick-btn.status-interview:hover {
            background: #f3e8ff;
        }
        
        .status-quick-btn.status-accepted {
            border-color: #10b981;
            color: #10b981;
        }
        
        .status-quick-btn.status-accepted:hover {
            background: #ecfdf5;
        }
        
        .status-quick-btn.status-rejected {
            border-color: #ef4444;
            color: #ef4444;
        }
        
        .status-quick-btn.status-rejected:hover {
            background: #fef2f2;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .admin-sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }
            
            .admin-sidebar.open {
                transform: translateX(0);
            }
            
            .applications-page {
                margin-left: 0;
            }
            
            .applications-dashboard {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                grid-template-columns: 1fr;
            }
            
            .application-details {
                grid-template-columns: 1fr;
            }
            
            .applications-header h1 {
                font-size: 2rem;
            }
            
            .overview-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Admin Sidebar -->
    <div class="admin-sidebar">
        <div class="sidebar-header">
            <div class="sidebar-logo">
                <img src="manuel-weiss-photo.svg" alt="MW" class="sidebar-logo-img">
                <span class="sidebar-title">Admin Panel</span>
            </div>
        </div>
        
        <nav class="sidebar-nav">
            <ul>
                <li><a href="admin.html" class="sidebar-link"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                <li><a href="#" class="sidebar-link active" onclick="showSection('applications')"><i class="fas fa-briefcase"></i> Bewerbungen</a></li>
                <li><a href="#" class="sidebar-link" onclick="showSection('designer')"><i class="fas fa-palette"></i> Bewerbungs-Designer</a></li>
                <li><a href="#" class="sidebar-link" onclick="showSection('calendar')"><i class="fas fa-calendar-alt"></i> Termine</a></li>
                <li><a href="admin.html#nutrition" class="sidebar-link"><i class="fas fa-apple-alt"></i> Ernährungsplan</a></li>
                <li><a href="admin.html#content" class="sidebar-link"><i class="fas fa-edit"></i> Content</a></li>
                <li><a href="admin.html#media" class="sidebar-link"><i class="fas fa-images"></i> Medien</a></li>
                <li><a href="admin.html#ai-twin" class="sidebar-link"><i class="fas fa-robot"></i> AI Twin</a></li>
                <li><a href="admin.html#analytics" class="sidebar-link"><i class="fas fa-chart-line"></i> Analytics</a></li>
                <li><a href="admin.html#settings" class="sidebar-link"><i class="fas fa-cog"></i> Einstellungen</a></li>
            </ul>
        </nav>
    </div>

    <!-- Applications Page -->
    <section class="applications-page" id="applications-section">
        <div class="applications-container">
            <!-- Header -->
            <div class="applications-header">
                <h1>Bewerbungsverwaltung</h1>
                <p>Verwalte deine Bewerbungen und verfolge deinen Erfolg</p>
            </div>

            <!-- Dashboard -->
            <div class="applications-dashboard">
                <!-- Statistics Panel -->
                <div class="stats-panel">
                    <h2>📊 Statistiken</h2>
                    <div class="stats-grid">
                        <div class="stat-card primary">
                            <div class="stat-number" id="total-applications">0</div>
                            <div class="stat-label">Gesamt</div>
                        </div>
                        <div class="stat-card success">
                            <div class="stat-number" id="positive-responses">0</div>
                            <div class="stat-label">Positiv</div>
                        </div>
                        <div class="stat-card warning">
                            <div class="stat-number" id="interviews">0</div>
                            <div class="stat-label">Interviews</div>
                        </div>
                        <div class="stat-card danger">
                            <div class="stat-number" id="rejections">0</div>
                            <div class="stat-label">Absagen</div>
                        </div>
                        <div class="stat-card info">
                            <div class="stat-number" id="success-rate">0%</div>
                            <div class="stat-label">Erfolgsrate</div>
                        </div>
                        <div class="stat-card secondary">
                            <div class="stat-number" id="pending-applications">0</div>
                            <div class="stat-label">Ausstehend</div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions">
                    <h2>⚡ Quick Actions</h2>
                    <div class="action-buttons">
                        <button class="action-btn" onclick="openAddModal()">
                            <i class="fas fa-plus"></i>
                            <span>Neue Bewerbung</span>
                        </button>
                        <button class="action-btn" onclick="createNewWithDesigner()">
                            <i class="fas fa-palette"></i>
                            <span>Mit Designer erstellen</span>
                        </button>
                        <button class="action-btn" onclick="exportApplications()">
                            <i class="fas fa-download"></i>
                            <span>Exportieren</span>
                        </button>
                        <button class="action-btn" onclick="generateReport()">
                            <i class="fas fa-chart-bar"></i>
                            <span>Bericht erstellen</span>
                        </button>
                        <button class="action-btn" onclick="openSettings()">
                            <i class="fas fa-cog"></i>
                            <span>Einstellungen</span>
                        </button>
                        <button class="action-btn" onclick="openAILetterGenerator()">
                            <i class="fas fa-robot"></i>
                            <span>KI Anschreiben</span>
                        </button>
                    </div>
                    
                    <!-- Quick Status Changes -->
                    <div class="quick-status-section">
                        <h3>🚀 Schnelle Statusänderungen</h3>
                        <div class="status-quick-buttons">
                            <button class="status-quick-btn status-sent" onclick="quickStatusChange('sent')" title="Als 'Gesendet' markieren">
                                <i class="fas fa-paper-plane"></i>
                                <span>Gesendet</span>
                            </button>
                            <button class="status-quick-btn status-reviewed" onclick="quickStatusChange('reviewed')" title="Als 'In Bearbeitung' markieren">
                                <i class="fas fa-clock"></i>
                                <span>In Bearbeitung</span>
                            </button>
                            <button class="status-quick-btn status-interview" onclick="quickStatusChange('interview')" title="Als 'Vorstellungsgespräch' markieren">
                                <i class="fas fa-handshake"></i>
                                <span>Interview</span>
                            </button>
                            <button class="status-quick-btn status-accepted" onclick="quickStatusChange('accepted')" title="Als 'Zusage' markieren">
                                <i class="fas fa-check-circle"></i>
                                <span>Zusage</span>
                            </button>
                            <button class="status-quick-btn status-rejected" onclick="quickStatusChange('rejected')" title="Als 'Abgelehnt' markieren">
                                <i class="fas fa-times-circle"></i>
                                <span>Abgelehnt</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Applications Content -->
            <div class="applications-content">
                <div class="content-header">
                    <h2>📋 Bewerbungen</h2>
                    <div class="filter-tabs">
                        <div class="filter-tab active" data-filter="all">Alle</div>
                        <div class="filter-tab" data-filter="sent">Gesendet</div>
                        <div class="filter-tab" data-filter="interview">Interviews</div>
                        <div class="filter-tab" data-filter="accepted">Angenommen</div>
                        <div class="filter-tab" data-filter="rejected">Abgelehnt</div>
                    </div>
                </div>

                <div class="applications-list" id="applicationsList">
                    <!-- Applications will be loaded here -->
                </div>
            </div>
        </div>
    </section>

    <!-- Designer Section -->
    <section class="designer-section" id="designer-section" style="display: none;">
        <div class="designer-container">
            <div class="designer-header">
                <div class="header-title">
                    <i class="fas fa-palette"></i>
                    <h1>Bewerbungs-Designer</h1>
                    <span style="color: var(--gray-500); font-size: 0.875rem;">Modulares Baukasten-System</span>
                </div>
                <div class="header-actions">
                    <div class="profile-section">
                        <div class="profile-toggle">
                            <button class="btn btn-secondary" onclick="toggleProfileMode()" id="profileToggleBtn">
                                <i class="fas fa-camera"></i>
                                <span>Foto</span>
                            </button>
                        </div>
                        <div class="profile-display" id="profileDisplay">
                            <img src="manuel-weiss-photo.svg" alt="Manuel Weiss" class="profile-image" id="profileImage">
                            <div class="profile-overlay" id="profileOverlay">
                                <button class="play-btn" onclick="playDigitalTwin()" title="Digital Twin abspielen">
                                    <i class="fas fa-play"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-secondary" onclick="resetDesign()">
                        <i class="fas fa-undo"></i>
                        Zurücksetzen
                    </button>
                    <button class="btn btn-primary" onclick="saveDesign()">
                        <i class="fas fa-save"></i>
                        Speichern
                    </button>
                    <button class="btn btn-success" onclick="previewDesign()">
                        <i class="fas fa-eye"></i>
                        Vorschau
                    </button>
                </div>
            </div>

            <div class="designer-content">
                <div class="designer-sidebar">
                    <div class="tabs">
                        <button class="tab active" onclick="switchTab('content')">
                            <i class="fas fa-edit"></i>
                            Inhalt
                        </button>
                        <button class="tab" onclick="switchTab('design')">
                            <i class="fas fa-paint-brush"></i>
                            Design
                        </button>
                        <button class="tab" onclick="switchTab('branding')">
                            <i class="fas fa-building"></i>
                            Branding
                        </button>
                        <button class="tab" onclick="switchTab('cover-letter')">
                            <i class="fas fa-robot"></i>
                            Anschreiben
                        </button>
                    </div>

                    <!-- Content Tab -->
                    <div id="content-tab" class="tab-content active">
                        <div class="sidebar-section">
                            <div class="section-title">
                                <i class="fas fa-user"></i>
                                Kandidaten-Informationen
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Name</label>
                                <input type="text" class="form-input" id="candidateName" placeholder="Manuel Weiss">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Position</label>
                                <input type="text" class="form-input" id="candidatePosition" placeholder="HR & AI Berater">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">E-Mail</label>
                                <input type="email" class="form-input" id="candidateEmail" placeholder="manuel@example.com">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Telefon</label>
                                <input type="tel" class="form-input" id="candidatePhone" placeholder="+41 79 123 45 67">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Standort</label>
                                <input type="text" class="form-input" id="candidateLocation" placeholder="Zürich, Schweiz">
                            </div>
                        </div>

                        <div class="sidebar-section">
                            <div class="section-title">
                                <i class="fas fa-file-alt"></i>
                                Anschreiben
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Anschreiben-Text</label>
                                <textarea class="form-input form-textarea" id="coverLetterText" rows="8" placeholder="Hier kommt der Anschreiben-Text..."></textarea>
                            </div>
                        </div>

                        <div class="sidebar-section">
                            <div class="section-title">
                                <i class="fas fa-cogs"></i>
                                Fähigkeiten
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Kernkompetenzen</label>
                                <textarea class="form-input form-textarea" id="skillsText" rows="4" placeholder="HR Management, AI Integration, Projektmanagement..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Design Tab -->
                    <div id="design-tab" class="tab-content">
                        <div class="sidebar-section">
                            <div class="section-title">
                                <i class="fas fa-palette"></i>
                                Farben & Stil
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Primärfarbe</label>
                                <input type="color" class="form-input color-picker" id="primaryColor" value="#6366f1">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Sekundärfarbe</label>
                                <input type="color" class="form-input color-picker" id="secondaryColor" value="#8b5cf6">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Design-Stil</label>
                                <select class="form-input" id="designStyle">
                                    <option value="swiss">Swiss Design</option>
                                    <option value="modern">Modern</option>
                                    <option value="corporate">Corporate</option>
                                    <option value="creative">Creative</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Branding Tab -->
                    <div id="branding-tab" class="tab-content">
                        <div class="sidebar-section">
                            <div class="section-title">
                                <i class="fas fa-building"></i>
                                Unternehmens-Branding
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Unternehmensname</label>
                                <input type="text" class="form-input" id="companyName" placeholder="Beispiel AG">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Firmenlogo</label>
                                <div class="file-upload-area" id="logoUploadArea">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                    <p>Logo hier ablegen oder klicken</p>
                                    <input type="file" id="logoFile" accept="image/*" style="display: none;">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Cover Letter Tab -->
                    <div id="cover-letter-tab" class="tab-content">
                        <div class="sidebar-section">
                            <div class="section-title">
                                <i class="fas fa-robot"></i>
                                KI Anschreiben-Generator
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Stellenanzeige</label>
                                <textarea class="form-input form-textarea" id="jobDescription" rows="4" placeholder="Kopiere hier die Stellenanzeige..."></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Unternehmen</label>
                                <input type="text" class="form-input" id="aiCompanyName" placeholder="Name des Unternehmens">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Position</label>
                                <input type="text" class="form-input" id="aiPositionTitle" placeholder="Titel der Position">
                            </div>
                            
                            <button class="btn btn-primary" onclick="generateCoverLetter()" style="width: 100%;">
                                <i class="fas fa-magic"></i>
                                Anschreiben generieren
                            </button>
                            
                            <div class="form-group" style="margin-top: 1rem;">
                                <label class="form-label">Generiertes Anschreiben</label>
                                <textarea class="form-input form-textarea" id="generatedCoverLetter" rows="8" placeholder="Hier erscheint das generierte Anschreiben..."></textarea>
                            </div>
                            
                            <div style="display: flex; gap: 0.5rem;">
                                <button class="btn btn-success" onclick="saveCoverLetter()" style="flex: 1;">
                                    <i class="fas fa-save"></i>
                                    Speichern
                                </button>
                                <button class="btn btn-secondary" onclick="copyCoverLetter()" style="flex: 1;">
                                    <i class="fas fa-copy"></i>
                                    Kopieren
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Preview Area -->
                <div class="preview-area">
                    <div class="preview-header">
                        <div class="preview-title">
                            <i class="fas fa-eye"></i>
                            Live-Vorschau
                        </div>
                        <div class="preview-actions">
                            <button class="btn btn-secondary" onclick="openPreview()">
                                <i class="fas fa-external-link-alt"></i>
                                In neuem Tab öffnen
                            </button>
                        </div>
                    </div>
                    
                    <div class="preview-content" id="previewContent">
                        <!-- Preview wird hier dynamisch geladen -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Calendar Section -->
    <section class="calendar-section" id="calendar-section" style="display: none;">
        <div class="calendar-container">
            <div class="calendar-header">
                <h1><i class="fas fa-calendar-alt"></i> Terminverwaltung</h1>
                <p>Verwalte Interviews, Telefonate und Erinnerungen</p>
            </div>

            <div class="calendar-dashboard">
                <div class="dashboard-cards">
                    <div class="dashboard-card">
                        <div class="card-icon">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div class="card-content">
                            <h3 id="upcomingCount">0</h3>
                            <p>Anstehende Termine</p>
                        </div>
                    </div>
                    
                    <div class="dashboard-card">
                        <div class="card-icon">
                            <i class="fas fa-phone"></i>
                        </div>
                        <div class="card-content">
                            <h3 id="phoneCount">0</h3>
                            <p>Telefontermine</p>
                        </div>
                    </div>
                    
                    <div class="dashboard-card">
                        <div class="card-icon">
                            <i class="fas fa-video"></i>
                        </div>
                        <div class="card-content">
                            <h3 id="interviewCount">0</h3>
                            <p>Interviews</p>
                        </div>
                    </div>
                    
                    <div class="dashboard-card">
                        <div class="card-icon">
                            <i class="fas fa-bell"></i>
                        </div>
                        <div class="card-content">
                            <h3 id="reminderCount">0</h3>
                            <p>Erinnerungen</p>
                        </div>
                    </div>
                </div>

                <div class="calendar-actions">
                    <button class="btn btn-primary" onclick="openEventModal()">
                        <i class="fas fa-plus"></i>
                        Neuer Termin
                    </button>
                    <button class="btn btn-secondary" onclick="openReminderModal()">
                        <i class="fas fa-bell"></i>
                        Erinnerung erstellen
                    </button>
                    <button class="btn btn-secondary" onclick="exportCalendar()">
                        <i class="fas fa-download"></i>
                        Export
                    </button>
                </div>
            </div>

            <div class="calendar-content">
                <div class="calendar-sidebar">
                    <div class="calendar-filters">
                        <h3>Filter</h3>
                        <div class="filter-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="filterInterviews" checked>
                                <span class="checkmark"></span>
                                Interviews
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="filterPhone" checked>
                                <span class="checkmark"></span>
                                Telefonate
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="filterReminders" checked>
                                <span class="checkmark"></span>
                                Erinnerungen
                            </label>
                        </div>
                    </div>

                    <div class="quick-actions">
                        <h3>Quick Actions</h3>
                        <button class="quick-action-btn" onclick="createInterviewReminder()">
                            <i class="fas fa-video"></i>
                            Interview-Erinnerung
                        </button>
                        <button class="quick-action-btn" onclick="createFollowUpReminder()">
                            <i class="fas fa-reply"></i>
                            Follow-up Erinnerung
                        </button>
                        <button class="quick-action-btn" onclick="createEmailReminder()">
                            <i class="fas fa-envelope"></i>
                            E-Mail Erinnerung
                        </button>
                    </div>
                </div>

                <div class="calendar-main">
                    <div class="calendar-view">
                        <div class="calendar-header-nav">
                            <button class="btn btn-secondary" onclick="previousMonth()">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <h2 id="currentMonth">Januar 2024</h2>
                            <button class="btn btn-secondary" onclick="nextMonth()">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                        
                        <div class="calendar-grid" id="calendarGrid">
                            <!-- Calendar wird hier dynamisch generiert -->
                        </div>
                    </div>

                    <div class="events-list">
                        <h3>Anstehende Termine</h3>
                        <div class="events-container" id="eventsContainer">
                            <!-- Events werden hier dynamisch geladen -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Add Application Modal -->
    <div id="addModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Neue Bewerbung hinzufügen</h3>
                <button class="close-btn" onclick="closeModal('addModal')">&times;</button>
            </div>
            <form id="addApplicationForm">
                <div class="form-group">
                    <label for="company">Unternehmen *</label>
                    <input type="text" id="company" name="company" required>
                </div>
                <div class="form-group">
                    <label for="position">Position *</label>
                    <input type="text" id="position" name="position" required>
                </div>
                <div class="form-group">
                    <label for="status">Status</label>
                    <select id="status" name="status">
                        <option value="sent">Gesendet</option>
                        <option value="reviewed">In Bearbeitung</option>
                        <option value="interview">Interview</option>
                        <option value="accepted">Angenommen</option>
                        <option value="rejected">Abgelehnt</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="notes">Notizen</label>
                    <textarea id="notes" name="notes" placeholder="Zusätzliche Informationen..."></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('addModal')">Abbrechen</button>
                    <button type="submit" class="btn-primary">Speichern</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Application Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Bewerbung bearbeiten</h3>
                <button class="close-btn" onclick="closeModal('editModal')">&times;</button>
            </div>
            <form id="editApplicationForm">
                <input type="hidden" id="editId" name="id">
                <div class="form-group">
                    <label for="editCompany">Unternehmen *</label>
                    <input type="text" id="editCompany" name="company" required>
                </div>
                <div class="form-group">
                    <label for="editPosition">Position *</label>
                    <input type="text" id="editPosition" name="position" required>
                </div>
                <div class="form-group">
                    <label for="editStatus">Status</label>
                    <select id="editStatus" name="status">
                        <option value="sent">Gesendet</option>
                        <option value="reviewed">In Bearbeitung</option>
                        <option value="interview">Interview</option>
                        <option value="accepted">Angenommen</option>
                        <option value="rejected">Abgelehnt</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="editNotes">Notizen</label>
                    <textarea id="editNotes" name="notes" placeholder="Zusätzliche Informationen..."></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('editModal')">Abbrechen</button>
                    <button type="submit" class="btn-primary">Aktualisieren</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Status Change Modal -->
    <div id="statusModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3><i class="fas fa-edit"></i> Status ändern</h3>
                <button class="close-btn" onclick="closeModal('statusModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="status-change-content">
                <div class="current-status">
                    <h4>Aktueller Status:</h4>
                    <div id="currentStatusDisplay" class="status-display"></div>
                </div>
                <div class="status-options">
                    <h4>Neuer Status wählen:</h4>
                    <div id="statusOptionsList" class="status-options-grid">
                        <!-- Status options will be populated here -->
                    </div>
                </div>
                <div class="status-actions">
                    <button class="btn-secondary" onclick="closeModal('statusModal')">Abbrechen</button>
                    <button class="btn-primary" onclick="confirmStatusChange()" id="confirmStatusBtn" disabled>
                        <i class="fas fa-check"></i>
                        Status ändern
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- AI Letter Generator Modal -->
    <div id="aiLetterModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3><i class="fas fa-robot"></i> KI-Anschreiben Generator</h3>
                <button class="close-btn" onclick="closeModal('aiLetterModal')">&times;</button>
            </div>
            
            <div class="ai-generator-content">
                <!-- Step 1: Data Analysis -->
                <div id="aiStep1" class="ai-step active">
                    <h4><i class="fas fa-search"></i> Schritt 1: Datenanalyse</h4>
                    <p>Analysiere deine gespeicherten Daten (Lebenslauf, Bewerbungen, etc.)</p>
                    <div class="data-analysis">
                        <div class="analysis-item">
                            <i class="fas fa-file-alt"></i>
                            <span>Lebenslauf-Daten</span>
                            <div class="analysis-status" id="cvStatus">Wird analysiert...</div>
                        </div>
                        <div class="analysis-item">
                            <i class="fas fa-briefcase"></i>
                            <span>Bewerbungshistorie</span>
                            <div class="analysis-status" id="appStatus">Wird analysiert...</div>
                        </div>
                        <div class="analysis-item">
                            <i class="fas fa-graduation-cap"></i>
                            <span>Qualifikationen</span>
                            <div class="analysis-status" id="qualStatus">Wird analysiert...</div>
                        </div>
                    </div>
                    <button class="btn-primary" onclick="analyzeData()" id="analyzeBtn">
                        <i class="fas fa-play"></i> Analyse starten
                    </button>
                </div>

                <!-- Step 2: Job Description -->
                <div id="aiStep2" class="ai-step">
                    <h4><i class="fas fa-briefcase"></i> Schritt 2: Stellenanzeige</h4>
                    <p>Füge die Stellenanzeige ein, für die du dich bewerben möchtest</p>
                    <div class="form-group">
                        <label for="jobDescription">Stellenanzeige *</label>
                        <textarea id="jobDescription" name="jobDescription" rows="8" 
                                  placeholder="Kopiere hier die komplette Stellenanzeige hinein..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="companyName">Unternehmen</label>
                        <input type="text" id="companyName" name="companyName" placeholder="Name des Unternehmens">
                    </div>
                    <div class="form-group">
                        <label for="positionTitle">Position</label>
                        <input type="text" id="positionTitle" name="positionTitle" placeholder="Titel der Position">
                    </div>
                    <button class="btn-primary" onclick="proceedToStep3()">
                        <i class="fas fa-arrow-right"></i> Weiter
                    </button>
                </div>

                <!-- Step 3: AI Generation -->
                <div id="aiStep3" class="ai-step">
                    <h4><i class="fas fa-magic"></i> Schritt 3: KI-Generierung</h4>
                    <p>Die KI analysiert die Anforderungen und erstellt ein maßgeschneidertes Anschreiben</p>
                    
                    <div class="ai-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" id="aiProgressFill"></div>
                        </div>
                        <div class="progress-text" id="aiProgressText">Bereite Analyse vor...</div>
                    </div>

                    <div class="ai-insights" id="aiInsights" style="display: none;">
                        <h5>Erkannte Anforderungen:</h5>
                        <ul id="requirementsList"></ul>
                    </div>

                    <button class="btn-primary" onclick="generateCoverLetter()" id="generateBtn">
                        <i class="fas fa-robot"></i> Anschreiben generieren
                    </button>
                </div>

                <!-- Step 4: Result -->
                <div id="aiStep4" class="ai-step">
                    <h4><i class="fas fa-check-circle"></i> Schritt 4: Ergebnis & Bearbeitung</h4>
                    <p>Dein KI-generiertes Anschreiben ist fertig! Du kannst es jetzt interaktiv bearbeiten.</p>
                    
                    <div class="generated-letter">
                        <div class="letter-header">
                            <h5>Anschreiben für: <span id="resultCompany"></span></h5>
                            <p>Position: <span id="resultPosition"></span></p>
                        </div>
                        <div class="letter-content" id="generatedLetterContent">
                            <!-- Generated letter will appear here -->
                        </div>
                    </div>

                    <div class="editing-tools">
                        <div class="tool-section">
                            <h6><i class="fas fa-magic"></i> KI-Bearbeitung</h6>
                            <div class="tool-buttons">
                                <button class="tool-btn" onclick="enableSentenceEditing()">
                                    <i class="fas fa-edit"></i> Sätze bearbeiten
                                </button>
                                <button class="tool-btn" onclick="enableParagraphEditing()">
                                    <i class="fas fa-paragraph"></i> Absätze neu generieren
                                </button>
                                <button class="tool-btn" onclick="improveTone()">
                                    <i class="fas fa-palette"></i> Ton verbessern
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="letter-actions">
                        <button class="btn-secondary" onclick="regenerateLetter()">
                            <i class="fas fa-redo"></i> Neu generieren
                        </button>
                        <button class="btn-primary" onclick="saveLetter()">
                            <i class="fas fa-save"></i> Speichern
                        </button>
                        <button class="btn-primary" onclick="copyLetter()">
                            <i class="fas fa-copy"></i> Kopieren
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Share Application Modal -->
    <div id="shareModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-share-alt"></i> HR-Link teilen</h3>
                <button class="close-btn" onclick="closeModal('shareModal')">&times;</button>
            </div>
            
            <div class="share-content">
                <div class="application-preview">
                    <h4 id="shareApplicationTitle">-</h4>
                    <p id="shareApplicationCompany">-</p>
                </div>
                
                <div class="share-options">
                    <div class="share-option">
                        <label for="shareUrl">HR-Link:</label>
                        <div class="url-container">
                            <input type="text" id="shareUrl" readonly>
                            <button class="copy-url-btn" onclick="copyShareUrl()">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="share-option">
                        <label for="shareEmail">E-Mail-Vorlage:</label>
                        <textarea id="shareEmail" rows="6" readonly></textarea>
                        <button class="copy-email-btn" onclick="copyEmailTemplate()">
                            <i class="fas fa-copy"></i> E-Mail kopieren
                        </button>
                    </div>
                </div>
                
                <div class="share-actions">
                    <button class="btn-secondary" onclick="closeModal('shareModal')">Schließen</button>
                    <button class="btn-primary" onclick="openEmailClient()">
                        <i class="fas fa-envelope"></i> E-Mail öffnen
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Sentence Alternatives Modal -->
    <div id="sentenceModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3><i class="fas fa-edit"></i> Satz-Alternativen</h3>
                <button class="close-btn" onclick="closeModal('sentenceModal')">&times;</button>
            </div>
            
            <div class="sentence-alternatives">
                <div class="original-sentence">
                    <h5>Ursprünglicher Satz:</h5>
                    <p id="originalSentenceText">-</p>
                </div>
                
                <div class="alternatives">
                    <h5>KI-generierte Alternativen:</h5>
                    <div class="alternative-options" id="alternativeOptions">
                        <!-- Alternatives will be loaded here -->
                    </div>
                </div>
                
                <div class="sentence-actions">
                    <button class="btn-secondary" onclick="closeModal('sentenceModal')">Abbrechen</button>
                    <button class="btn-primary" onclick="regenerateAlternatives()">
                        <i class="fas fa-redo"></i> Neue Alternativen
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Paragraph Regeneration Modal -->
    <div id="paragraphModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h3><i class="fas fa-paragraph"></i> Absatz neu generieren</h3>
                <button class="close-btn" onclick="closeModal('paragraphModal')">&times;</button>
            </div>
            
            <div class="paragraph-regeneration">
                <div class="paragraph-selection">
                    <h5>Wähle einen Absatz zum Neugenerieren:</h5>
                    <div class="paragraph-options" id="paragraphOptions">
                        <!-- Paragraph options will be loaded here -->
                    </div>
                </div>
                
                <div class="regeneration-options">
                    <h5>Generierungsoptionen:</h5>
                    <div class="form-group">
                        <label for="paragraphTone">Ton:</label>
                        <select id="paragraphTone">
                            <option value="professional">Professionell</option>
                            <option value="enthusiastic">Begeistert</option>
                            <option value="confident">Selbstbewusst</option>
                            <option value="humble">Bescheiden</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="paragraphFocus">Fokus:</label>
                        <select id="paragraphFocus">
                            <option value="experience">Berufserfahrung</option>
                            <option value="skills">Fähigkeiten</option>
                            <option value="motivation">Motivation</option>
                            <option value="achievements">Erfolge</option>
                        </select>
                    </div>
                </div>
                
                <div class="paragraph-actions">
                    <button class="btn-secondary" onclick="closeModal('paragraphModal')">Abbrechen</button>
                    <button class="btn-primary" onclick="regenerateParagraph()">
                        <i class="fas fa-robot"></i> Absatz neu generieren
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        // Navigation Management
        function showSection(sectionName) {
            // Hide all sections
            document.getElementById('applications-section').style.display = 'none';
            document.getElementById('designer-section').style.display = 'none';
            document.getElementById('calendar-section').style.display = 'none';
            
            // Show selected section
            document.getElementById(sectionName + '-section').style.display = 'block';
            
            // Update active navigation
            document.querySelectorAll('.sidebar-link').forEach(link => {
                link.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Initialize section-specific functionality
            if (sectionName === 'calendar') {
                initializeCalendar();
            } else if (sectionName === 'designer') {
                initializeDesigner();
            }
        }

        // Designer Management
        function initializeDesigner() {
            // Load contact data from website
            loadContactDataFromWebsite();
            
            // Setup event listeners
            setupDesignerEventListeners();
            
            // Update preview
            updatePreview();
        }

        function loadContactDataFromWebsite() {
            fetch('data/website-content.json')
                .then(response => response.json())
                .then(data => {
                    if (data.contact) {
                        document.getElementById('candidateEmail').value = data.contact.email || '';
                        document.getElementById('candidatePhone').value = data.contact.phone || '';
                        document.getElementById('candidateLocation').value = data.contact.location || '';
                    }
                    if (data.hero) {
                        document.getElementById('candidateName').value = data.hero.name || '';
                        document.getElementById('candidatePosition').value = data.hero.title || '';
                    }
                    console.log('✅ Kontaktdaten von Website übernommen');
                })
                .catch(error => {
                    console.log('⚠️ Konnte Kontaktdaten nicht von Website laden:', error);
                });
        }

        function setupDesignerEventListeners() {
            // Content inputs
            document.getElementById('candidateName').addEventListener('input', updatePreview);
            document.getElementById('candidatePosition').addEventListener('input', updatePreview);
            document.getElementById('candidateEmail').addEventListener('input', updatePreview);
            document.getElementById('candidatePhone').addEventListener('input', updatePreview);
            document.getElementById('candidateLocation').addEventListener('input', updatePreview);
            document.getElementById('coverLetterText').addEventListener('input', updatePreview);
            document.getElementById('skillsText').addEventListener('input', updatePreview);
            
            // Design inputs
            document.getElementById('primaryColor').addEventListener('change', updatePreview);
            document.getElementById('secondaryColor').addEventListener('change', updatePreview);
            document.getElementById('designStyle').addEventListener('change', updatePreview);
            
            // Branding inputs
            document.getElementById('companyName').addEventListener('input', updatePreview);
            
            // Logo upload
            document.getElementById('logoUploadArea').addEventListener('click', () => {
                document.getElementById('logoFile').click();
            });
            
            document.getElementById('logoFile').addEventListener('change', handleLogoUpload);
        }

        function handleLogoUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const logoPreview = document.createElement('img');
                    logoPreview.src = e.target.result;
                    logoPreview.style.maxWidth = '100px';
                    logoPreview.style.maxHeight = '100px';
                    logoPreview.style.borderRadius = '0.5rem';
                    
                    const uploadArea = document.getElementById('logoUploadArea');
                    uploadArea.innerHTML = '';
                    uploadArea.appendChild(logoPreview);
                    
                    updatePreview();
                };
                reader.readAsDataURL(file);
            }
        }

        function updatePreview() {
            const previewContent = document.getElementById('previewContent');
            const name = document.getElementById('candidateName').value || 'Manuel Weiss';
            const position = document.getElementById('candidatePosition').value || 'HR & AI Berater';
            const email = document.getElementById('candidateEmail').value || 'manuel@example.com';
            const phone = document.getElementById('candidatePhone').value || '+41 79 123 45 67';
            const location = document.getElementById('candidateLocation').value || 'Zürich, Schweiz';
            const coverLetter = document.getElementById('coverLetterText').value || 'Hier kommt der Anschreiben-Text...';
            const skills = document.getElementById('skillsText').value || 'HR Management, AI Integration, Projektmanagement...';
            const companyName = document.getElementById('companyName').value || 'Beispiel AG';
            const primaryColor = document.getElementById('primaryColor').value;
            const secondaryColor = document.getElementById('secondaryColor').value;
            
            previewContent.innerHTML = `
                <div style="max-width: 800px; margin: 0 auto; font-family: 'Inter', sans-serif; line-height: 1.6; color: #1e293b;">
                    <div style="background: linear-gradient(135deg, ${primaryColor} 0%, ${secondaryColor} 100%); color: white; padding: 2rem; border-radius: 1rem; margin-bottom: 2rem; text-align: center;">
                        <h1 style="margin: 0 0 0.5rem 0; font-size: 2.5rem; font-weight: 700;">${name}</h1>
                        <p style="margin: 0; font-size: 1.25rem; opacity: 0.9;">${position}</p>
                    </div>
                    
                    <div style="background: white; border-radius: 1rem; padding: 2rem; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
                        <h2 style="color: ${primaryColor}; margin-bottom: 1rem;">Anschreiben</h2>
                        <div style="white-space: pre-wrap; margin-bottom: 2rem;">${coverLetter}</div>
                        
                        <h2 style="color: ${primaryColor}; margin-bottom: 1rem;">Kernkompetenzen</h2>
                        <p style="margin-bottom: 2rem;">${skills}</p>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 2rem;">
                            <div style="text-align: center;">
                                <i class="fas fa-envelope" style="color: ${primaryColor}; font-size: 1.5rem; margin-bottom: 0.5rem;"></i>
                                <p style="margin: 0; font-size: 0.875rem;">${email}</p>
                            </div>
                            <div style="text-align: center;">
                                <i class="fas fa-phone" style="color: ${primaryColor}; font-size: 1.5rem; margin-bottom: 0.5rem;"></i>
                                <p style="margin: 0; font-size: 0.875rem;">${phone}</p>
                            </div>
                            <div style="text-align: center;">
                                <i class="fas fa-map-marker-alt" style="color: ${primaryColor}; font-size: 1.5rem; margin-bottom: 0.5rem;"></i>
                                <p style="margin: 0; font-size: 0.875rem;">${location}</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Tab Management
        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        // Cover Letter Generation
        function generateCoverLetter() {
            const jobDescription = document.getElementById('jobDescription').value;
            const companyName = document.getElementById('aiCompanyName').value;
            const positionTitle = document.getElementById('aiPositionTitle').value;
            
            if (!jobDescription || !companyName || !positionTitle) {
                alert('Bitte füllen Sie alle Felder aus.');
                return;
            }
            
            // Show advanced generation modal
            showAdvancedGenerationModal(jobDescription, companyName, positionTitle);
        }

        function showAdvancedGenerationModal(jobDescription, companyName, positionTitle) {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 700px;">
                    <div class="modal-header">
                        <h3><i class="fas fa-brain"></i> Intelligente Anschreiben-Generierung</h3>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="generation-options">
                            <h4>🎯 Generierungsoptionen</h4>
                            <div class="option-grid">
                                <div class="option-card" onclick="generateVersion('formal', '${companyName}', '${positionTitle}')">
                                    <div class="option-icon">
                                        <i class="fas fa-handshake"></i>
                                    </div>
                                    <div class="option-title">Formal</div>
                                    <div class="option-desc">Klassisch & professionell</div>
                                </div>
                                <div class="option-card" onclick="generateVersion('modern', '${companyName}', '${positionTitle}')">
                                    <div class="option-icon">
                                        <i class="fas fa-rocket"></i>
                                    </div>
                                    <div class="option-title">Modern</div>
                                    <div class="option-desc">Innovativ & dynamisch</div>
                                </div>
                                <div class="option-card" onclick="generateVersion('creative', '${companyName}', '${positionTitle}')">
                                    <div class="option-icon">
                                        <i class="fas fa-palette"></i>
                                    </div>
                                    <div class="option-title">Kreativ</div>
                                    <div class="option-desc">Einzigartig & persönlich</div>
                                </div>
                                <div class="option-card" onclick="generateVersion('ats', '${companyName}', '${positionTitle}')">
                                    <div class="option-icon">
                                        <i class="fas fa-robot"></i>
                                    </div>
                                    <div class="option-title">ATS-optimiert</div>
                                    <div class="option-desc">Für Bewerbungssysteme</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="ai-analysis">
                            <h4>🔍 KI-Analyse der Stellenanzeige</h4>
                            <div class="analysis-results" id="jobAnalysis">
                                <div class="loading-spinner">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <span>Analysiere Stellenanzeige...</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="quality-preview">
                            <h4>📊 Qualitätsvorschau</h4>
                            <div class="quality-metrics" id="qualityMetrics">
                                <div class="metric">
                                    <span class="metric-label">Match-Score:</span>
                                    <span class="metric-value" id="matchScore">-</span>
                                </div>
                                <div class="metric">
                                    <span class="metric-label">ATS-Score:</span>
                                    <span class="metric-value" id="atsScore">-</span>
                                </div>
                                <div class="metric">
                                    <span class="metric-label">Readability:</span>
                                    <span class="metric-value" id="readabilityScore">-</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Analyze job description
            analyzeJobDescription(jobDescription);
        }

        function analyzeJobDescription(jobDescription) {
            setTimeout(() => {
                const analysisResults = document.getElementById('jobAnalysis');
                
                // Simulate AI analysis
                const keywords = extractKeywords(jobDescription);
                const requirements = extractRequirements(jobDescription);
                const companyCulture = analyzeCompanyCulture(jobDescription);
                
                analysisResults.innerHTML = `
                    <div class="analysis-item">
                        <strong>Schlüsselwörter:</strong> ${keywords.slice(0, 5).join(', ')}
                    </div>
                    <div class="analysis-item">
                        <strong>Anforderungen:</strong> ${requirements.slice(0, 3).join(', ')}
                    </div>
                    <div class="analysis-item">
                        <strong>Unternehmenskultur:</strong> ${companyCulture}
                    </div>
                `;
                
                // Update quality metrics
                updateQualityMetrics(keywords, requirements);
            }, 2000);
        }

        function extractKeywords(text) {
            const commonKeywords = [
                'Projektmanagement', 'Teamführung', 'Digitalisierung', 'Innovation',
                'Strategie', 'Analytik', 'Kommunikation', 'Leadership', 'Agile',
                'Change Management', 'Stakeholder', 'Prozessoptimierung', 'KI',
                'Machine Learning', 'Data Science', 'Cloud', 'SaaS', 'Startup'
            ];
            
            return commonKeywords.filter(keyword => 
                text.toLowerCase().includes(keyword.toLowerCase())
            );
        }

        function extractRequirements(text) {
            const requirements = [];
            if (text.includes('Erfahrung')) requirements.push('Berufserfahrung');
            if (text.includes('Studium') || text.includes('Bachelor') || text.includes('Master')) requirements.push('Hochschulabschluss');
            if (text.includes('Sprachen') || text.includes('Englisch')) requirements.push('Sprachkenntnisse');
            if (text.includes('Führung') || text.includes('Team')) requirements.push('Führungserfahrung');
            return requirements;
        }

        function analyzeCompanyCulture(text) {
            if (text.includes('Startup') || text.includes('agil')) return 'Innovativ & dynamisch';
            if (text.includes('Tradition') || text.includes('etabliert')) return 'Traditionell & strukturiert';
            if (text.includes('international') || text.includes('global')) return 'International & divers';
            return 'Professionell & zielorientiert';
        }

        function updateQualityMetrics(keywords, requirements) {
            const matchScore = Math.min(95, 60 + (keywords.length * 5) + (requirements.length * 3));
            const atsScore = Math.min(90, 70 + (keywords.length * 4));
            const readabilityScore = Math.min(95, 80 + Math.random() * 10);
            
            document.getElementById('matchScore').textContent = `${Math.round(matchScore)}%`;
            document.getElementById('atsScore').textContent = `${Math.round(atsScore)}%`;
            document.getElementById('readabilityScore').textContent = `${Math.round(readabilityScore)}%`;
        }

        function generateVersion(style, companyName, positionTitle) {
            const modal = document.querySelector('.modal');
            if (modal) modal.remove();
            
            // Show generation progress
            showGenerationProgress(style);
            
            setTimeout(() => {
                const coverLetter = generateCoverLetterByStyle(style, companyName, positionTitle);
                document.getElementById('generatedCoverLetter').value = coverLetter;
                
                // Show success with quality metrics
                showGenerationSuccess(style, coverLetter);
            }, 2000);
        }

        function generateCoverLetterByStyle(style, companyName, positionTitle) {
            const name = document.getElementById('candidateName').value || 'Manuel Weiss';
            
            const templates = {
                formal: `Sehr geehrte Damen und Herren,

mit großem Interesse habe ich Ihre Stellenanzeige für die Position "${positionTitle}" bei ${companyName} gelesen. Als erfahrener HR & AI Berater mit über 6 Jahren Erfahrung in der digitalen Transformation bin ich überzeugt, dass ich eine wertvolle Bereicherung für Ihr Team darstellen kann.

Meine Expertise umfasst:
• Strategische HR-Beratung und Prozessoptimierung
• KI-Integration in HR-Prozesse
• Projektmanagement und Change Management
• Stakeholder-Management auf C-Level

Besonders reizt mich an dieser Position die Möglichkeit, innovative Lösungen zu entwickeln und direkt zum Unternehmenserfolg beizutragen. Ich bin überzeugt, dass meine analytische Denkweise und mein unternehmerisches Handeln eine ideale Ergänzung zu Ihrem Team darstellen.

Ich freue mich auf ein persönliches Gespräch und die Möglichkeit, Ihnen meine Qualifikationen im Detail vorstellen zu können.

Mit freundlichen Grüßen
${name}`,

                modern: `Hallo ${companyName} Team,

ich bin Manuel Weiss und bewerbe mich für die Position "${positionTitle}". Als HR & AI Experte mit 6+ Jahren Erfahrung in der digitalen Transformation bringe ich genau die Skills mit, die Sie suchen.

🚀 Was mich auszeichnet:
• HR-Prozesse digitalisieren und automatisieren
• KI-Tools erfolgreich implementieren
• Teams durch Change-Prozesse führen
• C-Level Stakeholder begeistern

Ich liebe es, komplexe Herausforderungen in innovative Lösungen zu verwandeln. Bei ${companyName} sehe ich die perfekte Gelegenheit, meine Leidenschaft für HR-Tech und strategische Beratung einzubringen.

Lass uns sprechen! Ich freue mich auf ein Gespräch über Ihre Vision und wie ich dazu beitragen kann.

Beste Grüße
${name}`,

                creative: `Liebes ${companyName} Team,

stellen Sie sich vor: Ein HR-Experte, der nicht nur über KI spricht, sondern sie lebt. Das bin ich - Manuel Weiss, und ich bewerbe mich für "${positionTitle}".

🎯 Meine Mission: HR-Prozesse revolutionieren
📊 Meine Waffe: 6 Jahre Erfahrung in der digitalen Transformation
🎨 Mein Stil: Komplexe Probleme in elegante Lösungen verwandeln

Warum ${companyName}? Weil ich spüre, dass hier Innovation und Tradition eine perfekte Symbiose eingehen. Ich möchte Teil dieser Geschichte werden und mit meiner Expertise in KI-Integration und strategischer HR-Beratung zum Erfolg beitragen.

Lassen Sie uns gemeinsam die Zukunft des HR gestalten!

Mit Begeisterung
${name}`,

                ats: `Bewerbung als ${positionTitle} bei ${companyName}

Sehr geehrte Damen und Herren,

ich bewerbe mich für die ausgeschriebene Position "${positionTitle}" bei ${companyName}. Als HR & AI Berater mit über 6 Jahren Berufserfahrung in der digitalen Transformation verfüge ich über umfassende Kenntnisse in Projektmanagement, Change Management, Stakeholder Management, Prozessoptimierung und KI-Integration.

Meine Kernkompetenzen:
- Strategische HR-Beratung
- Digitalisierung von HR-Prozessen
- Projektmanagement und Teamführung
- Change Management
- Stakeholder Management auf C-Level
- KI-Integration in HR-Systeme
- Prozessoptimierung
- Agile Methoden

Ich bin überzeugt, dass meine Qualifikationen und meine Erfahrung in der digitalen Transformation eine ideale Ergänzung für Ihr Team darstellen. Ich freue mich auf ein persönliches Gespräch.

Mit freundlichen Grüßen
${name}`
            };
            
            return templates[style] || templates.formal;
        }

        function showGenerationProgress(style) {
            const progressModal = document.createElement('div');
            progressModal.className = 'modal';
            progressModal.style.display = 'block';
            progressModal.innerHTML = `
                <div class="modal-content" style="max-width: 400px;">
                    <div class="modal-body" style="text-align: center; padding: 2rem;">
                        <div class="generation-spinner">
                            <i class="fas fa-brain fa-3x" style="color: #6366f1; margin-bottom: 1rem;"></i>
                            <h3>Generiere ${style} Anschreiben...</h3>
                            <p>KI analysiert Stellenanzeige und optimiert Inhalt</p>
                            <div class="progress-bar">
                                <div class="progress-fill"></div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(progressModal);
            
            // Animate progress bar
            const progressFill = progressModal.querySelector('.progress-fill');
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                progressFill.style.width = progress + '%';
                if (progress >= 100) {
                    clearInterval(interval);
                }
            }, 200);
        }

        function showGenerationSuccess(style, coverLetter) {
            // Remove progress modal
            const progressModal = document.querySelector('.modal');
            if (progressModal) progressModal.remove();
            
            // Show success notification
            const notification = document.createElement('div');
            notification.className = 'workflow-notification';
            notification.innerHTML = `
                <div class="notification-content">
                    <i class="fas fa-check-circle"></i>
                    <div class="notification-text">
                        ✅ ${style.charAt(0).toUpperCase() + style.slice(1)} Anschreiben generiert!<br><br>
                        📊 Qualitätsmetriken:<br>
                        • Match-Score: ${Math.round(85 + Math.random() * 10)}%<br>
                        • ATS-Score: ${Math.round(80 + Math.random() * 15)}%<br>
                        • Readability: ${Math.round(90 + Math.random() * 5)}%<br><br>
                        🎨 Anschreiben ist bereit für Anpassungen!
                    </div>
                    <button class="notification-close" onclick="this.parentElement.parentElement.remove()">&times;</button>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Auto-remove after 8 seconds
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 8000);
        }

        function saveCoverLetter() {
            const coverLetter = document.getElementById('generatedCoverLetter').value;
            if (!coverLetter) {
                alert('Bitte generieren Sie zuerst ein Anschreiben.');
                return;
            }
            
            // Save to localStorage
            const coverLetters = JSON.parse(localStorage.getItem('coverLetters') || '[]');
            const newCoverLetter = {
                id: Date.now(),
                title: document.getElementById('aiPositionTitle').value || 'Neues Anschreiben',
                company: document.getElementById('aiCompanyName').value || 'Unbekanntes Unternehmen',
                content: coverLetter,
                createdAt: new Date().toISOString()
            };
            
            coverLetters.push(newCoverLetter);
            localStorage.setItem('coverLetters', JSON.stringify(coverLetters));
            
            alert('Anschreiben erfolgreich gespeichert!');
        }

        function copyCoverLetter() {
            const coverLetter = document.getElementById('generatedCoverLetter').value;
            if (!coverLetter) {
                alert('Bitte generieren Sie zuerst ein Anschreiben.');
                return;
            }
            
            navigator.clipboard.writeText(coverLetter).then(() => {
                alert('Anschreiben in die Zwischenablage kopiert!');
            });
        }

        // Profile & Digital Twin Functions
        function toggleProfileMode() {
            const profileDisplay = document.getElementById('profileDisplay');
            const toggleBtn = document.getElementById('profileToggleBtn');
            const isDigitalTwin = profileDisplay.classList.contains('digital-twin');
            
            if (isDigitalTwin) {
                profileDisplay.classList.remove('digital-twin');
                toggleBtn.innerHTML = '<i class="fas fa-camera"></i><span>Foto</span>';
            } else {
                profileDisplay.classList.add('digital-twin');
                toggleBtn.innerHTML = '<i class="fas fa-robot"></i><span>AI Twin</span>';
            }
        }

        function playDigitalTwin() {
            const coverLetterText = document.getElementById('generatedCoverLetter').value;
            if (!coverLetterText) {
                alert('Bitte generieren Sie zuerst ein Anschreiben.');
                return;
            }
            
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(coverLetterText);
                utterance.lang = 'de-DE';
                utterance.rate = 0.9;
                utterance.pitch = 1.0;
                speechSynthesis.speak(utterance);
            } else {
                alert('Text-to-Speech wird von diesem Browser nicht unterstützt.');
            }
        }

        // Calendar Management
        function initializeCalendar() {
            updateCalendarStats();
            generateCalendar();
            loadUpcomingEvents();
        }

        function updateCalendarStats() {
            const events = JSON.parse(localStorage.getItem('calendarEvents') || '[]');
            const now = new Date();
            
            const upcoming = events.filter(event => new Date(event.date) > now).length;
            const phone = events.filter(event => event.type === 'phone').length;
            const interviews = events.filter(event => event.type === 'interview').length;
            const reminders = events.filter(event => event.type === 'reminder').length;
            
            document.getElementById('upcomingCount').textContent = upcoming;
            document.getElementById('phoneCount').textContent = phone;
            document.getElementById('interviewCount').textContent = interviews;
            document.getElementById('reminderCount').textContent = reminders;
        }

        function generateCalendar() {
            const calendarGrid = document.getElementById('calendarGrid');
            const currentDate = new Date();
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDay = firstDay.getDay();
            
            const monthNames = ['Januar', 'Februar', 'März', 'April', 'Mai', 'Juni',
                              'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'];
            
            document.getElementById('currentMonth').textContent = `${monthNames[month]} ${year}`;
            
            calendarGrid.innerHTML = '';
            
            // Add day headers
            const dayHeaders = ['So', 'Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa'];
            dayHeaders.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.style.background = '#f1f5f9';
                dayHeader.style.padding = '0.5rem';
                dayHeader.style.textAlign = 'center';
                dayHeader.style.fontWeight = '600';
                dayHeader.textContent = day;
                calendarGrid.appendChild(dayHeader);
            });
            
            // Add empty cells for days before month starts
            for (let i = 0; i < startingDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day other-month';
                calendarGrid.appendChild(emptyDay);
            }
            
            // Add days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                
                if (day === currentDate.getDate()) {
                    dayElement.classList.add('today');
                }
                
                dayElement.innerHTML = `
                    <div class="day-number">${day}</div>
                    <div class="day-events"></div>
                `;
                
                calendarGrid.appendChild(dayElement);
            }
        }

        function loadUpcomingEvents() {
            const events = JSON.parse(localStorage.getItem('calendarEvents') || '[]');
            const now = new Date();
            const upcoming = events.filter(event => new Date(event.date) > now)
                                 .sort((a, b) => new Date(a.date) - new Date(b.date))
                                 .slice(0, 5);
            
            const eventsContainer = document.getElementById('eventsContainer');
            eventsContainer.innerHTML = '';
            
            if (upcoming.length === 0) {
                eventsContainer.innerHTML = '<p style="color: #64748b; text-align: center;">Keine anstehenden Termine</p>';
                return;
            }
            
            upcoming.forEach(event => {
                const eventElement = document.createElement('div');
                eventElement.className = 'event-item';
                eventElement.innerHTML = `
                    <div class="event-title">${event.title}</div>
                    <div class="event-time">${new Date(event.date).toLocaleDateString('de-DE')} um ${event.time}</div>
                    <div class="event-type">${event.type}</div>
                `;
                eventsContainer.appendChild(eventElement);
            });
        }

        // Event Management
        function openEventModal() {
            // Create and show event modal
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Neuer Termin</h3>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label>Titel</label>
                            <input type="text" id="eventTitle" class="form-input" placeholder="Termin-Titel">
                        </div>
                        <div class="form-group">
                            <label>Datum</label>
                            <input type="date" id="eventDate" class="form-input">
                        </div>
                        <div class="form-group">
                            <label>Uhrzeit</label>
                            <input type="time" id="eventTime" class="form-input">
                        </div>
                        <div class="form-group">
                            <label>Typ</label>
                            <select id="eventType" class="form-input">
                                <option value="interview">Interview</option>
                                <option value="phone">Telefonat</option>
                                <option value="reminder">Erinnerung</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Beschreibung</label>
                            <textarea id="eventDescription" class="form-input" rows="3" placeholder="Optional"></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" onclick="this.closest('.modal').remove()">Abbrechen</button>
                        <button class="btn btn-primary" onclick="saveEvent()">Speichern</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function saveEvent() {
            const title = document.getElementById('eventTitle').value;
            const date = document.getElementById('eventDate').value;
            const time = document.getElementById('eventTime').value;
            const type = document.getElementById('eventType').value;
            const description = document.getElementById('eventDescription').value;
            
            if (!title || !date || !time) {
                alert('Bitte füllen Sie alle Pflichtfelder aus.');
                return;
            }
            
            const events = JSON.parse(localStorage.getItem('calendarEvents') || '[]');
            const newEvent = {
                id: Date.now(),
                title,
                date,
                time,
                type,
                description,
                createdAt: new Date().toISOString()
            };
            
            events.push(newEvent);
            localStorage.setItem('calendarEvents', JSON.stringify(events));
            
            // Close modal
            document.querySelector('.modal').remove();
            
            // Update calendar
            updateCalendarStats();
            loadUpcomingEvents();
            
            alert('Termin erfolgreich erstellt!');
        }

        // Quick Actions
        function createInterviewReminder() {
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            const events = JSON.parse(localStorage.getItem('calendarEvents') || '[]');
            const reminder = {
                id: Date.now(),
                title: 'Interview-Vorbereitung',
                date: tomorrow.toISOString().split('T')[0],
                time: '09:00',
                type: 'reminder',
                description: 'Interview vorbereiten - Fragen überlegen, Unterlagen bereitlegen'
            };
            
            events.push(reminder);
            localStorage.setItem('calendarEvents', JSON.stringify(events));
            
            updateCalendarStats();
            loadUpcomingEvents();
            alert('Interview-Erinnerung erstellt!');
        }

        function createFollowUpReminder() {
            const nextWeek = new Date();
            nextWeek.setDate(nextWeek.getDate() + 7);
            
            const events = JSON.parse(localStorage.getItem('calendarEvents') || '[]');
            const reminder = {
                id: Date.now(),
                title: 'Follow-up E-Mail',
                date: nextWeek.toISOString().split('T')[0],
                time: '10:00',
                type: 'reminder',
                description: 'Follow-up E-Mail für Bewerbung senden'
            };
            
            events.push(reminder);
            localStorage.setItem('calendarEvents', JSON.stringify(events));
            
            updateCalendarStats();
            loadUpcomingEvents();
            alert('Follow-up Erinnerung erstellt!');
        }

        function createEmailReminder() {
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            const events = JSON.parse(localStorage.getItem('calendarEvents') || '[]');
            const reminder = {
                id: Date.now(),
                title: 'E-Mail Erinnerung',
                date: tomorrow.toISOString().split('T')[0],
                time: '14:00',
                type: 'reminder',
                description: 'E-Mail für Bewerbung senden'
            };
            
            events.push(reminder);
            localStorage.setItem('calendarEvents', JSON.stringify(events));
            
            updateCalendarStats();
            loadUpcomingEvents();
            alert('E-Mail Erinnerung erstellt!');
        }

        function openReminderModal() {
            openEventModal();
            document.getElementById('eventType').value = 'reminder';
        }

        function exportCalendar() {
            const events = JSON.parse(localStorage.getItem('calendarEvents') || '[]');
            const csvContent = "data:text/csv;charset=utf-8," 
                + "Titel,Datum,Uhrzeit,Typ,Beschreibung\n"
                + events.map(event => 
                    `"${event.title}","${event.date}","${event.time}","${event.type}","${event.description}"`
                ).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "kalender_export.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function previousMonth() {
            // Implement month navigation
            console.log('Previous month');
        }

        function nextMonth() {
            // Implement month navigation
            console.log('Next month');
        }

        // Designer Functions
        function resetDesign() {
            if (confirm('Möchten Sie das Design wirklich zurücksetzen?')) {
                document.getElementById('primaryColor').value = '#6366f1';
                document.getElementById('secondaryColor').value = '#8b5cf6';
                document.getElementById('designStyle').value = 'swiss';
                updatePreview();
                alert('Design zurückgesetzt!');
            }
        }

        function saveDesign() {
            const designData = {
                primaryColor: document.getElementById('primaryColor').value,
                secondaryColor: document.getElementById('secondaryColor').value,
                designStyle: document.getElementById('designStyle').value,
                companyName: document.getElementById('companyName').value,
                savedAt: new Date().toISOString()
            };
            
            localStorage.setItem('hrDesignData', JSON.stringify(designData));
            alert('Design erfolgreich gespeichert!');
        }

        function previewDesign() {
            updatePreview();
            alert('Vorschau aktualisiert!');
        }

        function openPreview() {
            const previewWindow = window.open('', '_blank');
            previewWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Bewerbungs-Vorschau</title>
                    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
                    <style>
                        body { font-family: 'Inter', sans-serif; margin: 0; padding: 2rem; background: #f8fafc; }
                    </style>
                </head>
                <body>
                    ${document.getElementById('previewContent').innerHTML}
                </body>
                </html>
            `);
        }

        // Intelligent Workflow Functions
        function createNewWithDesigner() {
            // Show workflow modal
            showWorkflowModal();
        }

        function openInDesigner(applicationId) {
            const application = applicationsManager.applications.find(app => app.id === applicationId);
            if (!application) {
                alert('Bewerbung nicht gefunden.');
                return;
            }

            // Switch to designer section
            showSection('designer');
            
            // Auto-fill with application data
            autoFillFromApplication(application);
            
            // Show success message
            showWorkflowSuccess('Bewerbung in Designer geladen', application);
        }

        function showWorkflowModal() {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 600px;">
                    <div class="modal-header">
                        <h3><i class="fas fa-magic"></i> Intelligenter Bewerbungs-Workflow</h3>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="workflow-steps">
                            <div class="workflow-step active" id="step1">
                                <div class="step-number">1</div>
                                <div class="step-content">
                                    <h4>Daten sammeln</h4>
                                    <p>Analysiere vorhandene Bewerbungen und Dokumente</p>
                                </div>
                            </div>
                            <div class="workflow-step" id="step2">
                                <div class="step-number">2</div>
                                <div class="step-content">
                                    <h4>Intelligentes Vorausfüllen</h4>
                                    <p>Fülle Designer mit relevanten Daten</p>
                                </div>
                            </div>
                            <div class="workflow-step" id="step3">
                                <div class="step-number">3</div>
                                <div class="step-content">
                                    <h4>Designer öffnen</h4>
                                    <p>Bereit für Anpassungen und Optimierung</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="workflow-options">
                            <h4>Verfügbare Datenquellen:</h4>
                            <div class="data-sources" id="dataSources">
                                <div class="loading-spinner">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <span>Analysiere verfügbare Daten...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" onclick="this.closest('.modal').remove()">Abbrechen</button>
                        <button class="btn btn-primary" onclick="startIntelligentWorkflow()" id="startWorkflowBtn" disabled>
                            <i class="fas fa-rocket"></i>
                            Workflow starten
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Analyze available data
            analyzeAvailableData();
        }

        function analyzeAvailableData() {
            const dataSources = document.getElementById('dataSources');
            const startBtn = document.getElementById('startWorkflowBtn');
            
            // Simulate analysis
            setTimeout(() => {
                const applications = JSON.parse(localStorage.getItem('applications') || '[]');
                const coverLetters = JSON.parse(localStorage.getItem('coverLetters') || '[]');
                const hrDesignData = JSON.parse(localStorage.getItem('hrDesignData') || '{}');
                const certificates = hrDesignData.certificates || [];
                
                let sourcesHtml = '';
                let hasData = false;
                
                if (applications.length > 0) {
                    sourcesHtml += `
                        <div class="data-source available">
                            <i class="fas fa-briefcase"></i>
                            <span>${applications.length} Bewerbungen gefunden</span>
                        </div>
                    `;
                    hasData = true;
                }
                
                if (coverLetters.length > 0) {
                    sourcesHtml += `
                        <div class="data-source available">
                            <i class="fas fa-file-alt"></i>
                            <span>${coverLetters.length} Anschreiben gefunden</span>
                        </div>
                    `;
                    hasData = true;
                }
                
                if (certificates.length > 0) {
                    sourcesHtml += `
                        <div class="data-source available">
                            <i class="fas fa-certificate"></i>
                            <span>${certificates.length} Zeugnisse gefunden</span>
                        </div>
                    `;
                    hasData = true;
                }
                
                // Check for website data
                sourcesHtml += `
                    <div class="data-source available">
                        <i class="fas fa-globe"></i>
                        <span>Website-Kontaktdaten verfügbar</span>
                    </div>
                `;
                hasData = true;
                
                if (!hasData) {
                    sourcesHtml = `
                        <div class="data-source unavailable">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Keine Datenquellen gefunden</span>
                        </div>
                    `;
                } else {
                    startBtn.disabled = false;
                }
                
                dataSources.innerHTML = sourcesHtml;
            }, 1500);
        }

        function startIntelligentWorkflow() {
            // Close modal
            document.querySelector('.modal').remove();
            
            // Switch to designer
            showSection('designer');
            
            // Start intelligent filling
            performIntelligentFill();
        }

        function performIntelligentFill() {
            // Show progress
            showWorkflowProgress();
            
            // Step 1: Load contact data
            setTimeout(() => {
                loadContactDataFromWebsite();
                updateWorkflowStep(1);
            }, 500);
            
            // Step 2: Analyze and fill from applications
            setTimeout(() => {
                fillFromApplications();
                updateWorkflowStep(2);
            }, 1000);
            
            // Step 3: Fill from cover letters
            setTimeout(() => {
                fillFromCoverLetters();
                updateWorkflowStep(3);
            }, 1500);
            
            // Step 4: Complete
            setTimeout(() => {
                completeWorkflow();
            }, 2000);
        }

        function showWorkflowProgress() {
            const progressModal = document.createElement('div');
            progressModal.className = 'modal';
            progressModal.style.display = 'block';
            progressModal.id = 'workflowProgress';
            progressModal.innerHTML = `
                <div class="modal-content" style="max-width: 500px;">
                    <div class="modal-header">
                        <h3><i class="fas fa-magic"></i> Intelligenter Workflow</h3>
                    </div>
                    <div class="modal-body">
                        <div class="workflow-progress">
                            <div class="progress-step" id="progressStep1">
                                <div class="step-icon"><i class="fas fa-user"></i></div>
                                <div class="step-text">Kontaktdaten laden...</div>
                            </div>
                            <div class="progress-step" id="progressStep2">
                                <div class="step-icon"><i class="fas fa-briefcase"></i></div>
                                <div class="step-text">Bewerbungsdaten analysieren...</div>
                            </div>
                            <div class="progress-step" id="progressStep3">
                                <div class="step-icon"><i class="fas fa-file-alt"></i></div>
                                <div class="step-text">Anschreiben optimieren...</div>
                            </div>
                            <div class="progress-step" id="progressStep4">
                                <div class="step-icon"><i class="fas fa-check"></i></div>
                                <div class="step-text">Workflow abgeschlossen!</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(progressModal);
        }

        function updateWorkflowStep(step) {
            for (let i = 1; i <= step; i++) {
                const stepElement = document.getElementById(`progressStep${i}`);
                if (stepElement) {
                    stepElement.classList.add('completed');
                    const icon = stepElement.querySelector('.step-icon i');
                    if (i < step) {
                        icon.className = 'fas fa-check';
                    } else if (i === step) {
                        icon.className = 'fas fa-spinner fa-spin';
                    }
                }
            }
        }

        function completeWorkflow() {
            // Update final step
            updateWorkflowStep(4);
            
            // Close progress modal
            setTimeout(() => {
                const progressModal = document.getElementById('workflowProgress');
                if (progressModal) {
                    progressModal.remove();
                }
                
                // Show success message
                showWorkflowSuccess('Intelligenter Workflow abgeschlossen!', null);
            }, 1000);
        }

        function fillFromApplications() {
            const applications = JSON.parse(localStorage.getItem('applications') || '[]');
            if (applications.length === 0) return;
            
            // Find most recent or most successful application
            const recentApp = applications.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))[0];
            
            // Fill company and position if not already filled
            if (!document.getElementById('companyName').value && recentApp.company) {
                document.getElementById('companyName').value = recentApp.company;
            }
            
            if (!document.getElementById('aiCompanyName').value && recentApp.company) {
                document.getElementById('aiCompanyName').value = recentApp.company;
            }
            
            if (!document.getElementById('aiPositionTitle').value && recentApp.position) {
                document.getElementById('aiPositionTitle').value = recentApp.position;
            }
            
            // Update preview
            updatePreview();
        }

        function fillFromCoverLetters() {
            const coverLetters = JSON.parse(localStorage.getItem('coverLetters') || '[]');
            if (coverLetters.length === 0) return;
            
            // Find most recent cover letter
            const recentCoverLetter = coverLetters.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))[0];
            
            // Fill cover letter text if not already filled
            if (!document.getElementById('coverLetterText').value && recentCoverLetter.content) {
                document.getElementById('coverLetterText').value = recentCoverLetter.content;
            }
            
            // Update preview
            updatePreview();
        }

        function autoFillFromApplication(application) {
            // Fill all relevant fields
            if (application.company) {
                document.getElementById('companyName').value = application.company;
                document.getElementById('aiCompanyName').value = application.company;
            }
            
            if (application.position) {
                document.getElementById('aiPositionTitle').value = application.position;
            }
            
            if (application.coverLetter) {
                document.getElementById('coverLetterText').value = application.coverLetter;
                document.getElementById('generatedCoverLetter').value = application.coverLetter;
            }
            
            if (application.notes) {
                document.getElementById('skillsText').value = application.notes;
            }
            
            // Update preview
            updatePreview();
        }

        function showWorkflowSuccess(message, application) {
            const successHtml = application ? 
                `✅ ${message}<br><br>
                 📋 Bewerbung: ${application.company} - ${application.position}<br>
                 🎨 Designer ist bereit für Anpassungen!` :
                `✅ ${message}<br><br>
                 🎨 Designer ist mit intelligenten Daten vorausgefüllt!`;
            
            // Create success notification
            const notification = document.createElement('div');
            notification.className = 'workflow-notification';
            notification.innerHTML = `
                <div class="notification-content">
                    <i class="fas fa-check-circle"></i>
                    <div class="notification-text">${successHtml}</div>
                    <button class="notification-close" onclick="this.parentElement.parentElement.remove()">&times;</button>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Auto-remove after 5 seconds
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }

        // Applications Management
        class ApplicationsManager {
            constructor() {
                this.applications = this.loadApplications();
                this.currentFilter = 'all';
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.updateStats();
                this.renderApplications();
            }

            setupEventListeners() {
                // Filter tabs
                document.querySelectorAll('.filter-tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        this.setFilter(e.target.dataset.filter);
                    });
                });

                // Add form
                document.getElementById('addApplicationForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.addApplication();
                });

                // Edit form
                document.getElementById('editApplicationForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.updateApplication();
                });
            }

            loadApplications() {
                return JSON.parse(localStorage.getItem('applications') || '[]');
            }

            saveApplications() {
                localStorage.setItem('applications', JSON.stringify(this.applications));
            }

            setFilter(filter) {
                this.currentFilter = filter;
                
                // Update active tab
                document.querySelectorAll('.filter-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                document.querySelector(`[data-filter="${filter}"]`).classList.add('active');
                
                this.renderApplications();
            }

            updateStats() {
                const total = this.applications.length;
                const positive = this.applications.filter(app => 
                    app.status === 'interview' || app.status === 'accepted'
                ).length;
                const interviews = this.applications.filter(app => 
                    app.status === 'interview' || app.status === 'accepted'
                ).length;
                const rejections = this.applications.filter(app => 
                    app.status === 'rejected'
                ).length;
                const pending = this.applications.filter(app => 
                    app.status === 'sent' || app.status === 'reviewed'
                ).length;
                const successRate = total > 0 ? Math.round((positive / total) * 100) : 0;

                document.getElementById('total-applications').textContent = total;
                document.getElementById('positive-responses').textContent = positive;
                document.getElementById('interviews').textContent = interviews;
                document.getElementById('rejections').textContent = rejections;
                document.getElementById('pending-applications').textContent = pending;
                document.getElementById('success-rate').textContent = successRate + '%';
            }

            renderApplications() {
                const container = document.getElementById('applicationsList');
                let filteredApplications = this.applications;

                if (this.currentFilter !== 'all') {
                    filteredApplications = this.applications.filter(app => 
                        app.status === this.currentFilter
                    );
                }

                if (filteredApplications.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-file-alt"></i>
                            <h3>Keine Bewerbungen gefunden</h3>
                            <p>Füge deine erste Bewerbung hinzu, um loszulegen.</p>
                            <button class="btn-primary" onclick="openAddModal()">Bewerbung hinzufügen</button>
                        </div>
                    `;
                    return;
                }

            container.innerHTML = filteredApplications.map(app => {
                const isNew = this.isNewApplication(app);
                const cardClass = isNew ? 'application-card new-application' : 'application-card';
                
                return `
                    <div class="${cardClass}" data-application-id="${app.id}">
                        <div class="application-header">
                            <div class="application-info">
                                <h3>${app.company}</h3>
                                <p>${app.position}</p>
                                ${app.source === 'ai-generated' ? '<span style="font-size: 0.75rem; color: #6366f1; font-weight: 500;">🤖 KI-generiert</span>' : ''}
                            </div>
                            <div class="application-status status-${app.status}" onclick="showStatusDropdown(${app.id}, '${app.status}')" title="Status ändern">
                                ${this.getStatusText(app.status)}
                                <i class="fas fa-chevron-down status-arrow"></i>
                            </div>
                        </div>
                        <div class="application-details">
                            <div class="detail-item">
                                <i class="fas fa-calendar"></i>
                                <span>${new Date(app.date).toLocaleDateString('de-DE')}</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-clock"></i>
                                <span>${this.getTimeAgo(app.date)}</span>
                            </div>
                            ${app.views > 0 ? `
                                <div class="detail-item">
                                    <i class="fas fa-eye"></i>
                                    <span>${app.views} Aufrufe</span>
                                </div>
                            ` : ''}
                        </div>
                        ${app.notes ? `<div class="application-notes" style="margin-bottom: 1rem; color: #64748b; font-size: 0.875rem;">${app.notes}</div>` : ''}
                        <div class="application-actions">
                            <div class="action-icon action-view" onclick="viewApplication(${app.id})" title="Ansehen">
                                <i class="fas fa-eye"></i>
                            </div>
                            <div class="action-icon action-share" onclick="shareApplication(${app.id})" title="HR-Link teilen">
                                <i class="fas fa-share-alt"></i>
                            </div>
                            <div class="action-icon action-edit" onclick="editApplication(${app.id})" title="Bearbeiten">
                                <i class="fas fa-edit"></i>
                            </div>
                            <div class="action-icon action-designer" onclick="openInDesigner(${app.id})" title="Mit Designer bearbeiten">
                                <i class="fas fa-palette"></i>
                            </div>
                            <div class="action-icon action-delete" onclick="deleteApplication(${app.id})" title="Löschen">
                                <i class="fas fa-trash"></i>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            }

            getStatusText(status) {
                const statusMap = {
                    'draft': 'Entwurf',
                    'sent': 'Gesendet',
                    'reviewed': 'In Bearbeitung',
                    'interview': 'Vorstellungsgespräch',
                    'accepted': 'Zusage',
                    'rejected': 'Abgelehnt'
                };
            return statusMap[status] || status;
        }

        getStatusOptions() {
            return [
                { value: 'draft', text: 'Entwurf', color: '#6b7280' },
                { value: 'sent', text: 'Gesendet', color: '#3b82f6' },
                { value: 'reviewed', text: 'In Bearbeitung', color: '#f59e0b' },
                { value: 'interview', text: 'Vorstellungsgespräch', color: '#8b5cf6' },
                { value: 'accepted', text: 'Zusage', color: '#10b981' },
                { value: 'rejected', text: 'Abgelehnt', color: '#ef4444' }
            ];
        }

        isNewApplication(application) {
            // Consider an application "new" if it was created in the last 5 minutes
            const now = new Date();
            const appDate = new Date(application.date);
            const timeDiff = now - appDate;
            const fiveMinutes = 5 * 60 * 1000; // 5 minutes in milliseconds
            
            return timeDiff < fiveMinutes;
        }

            getTimeAgo(date) {
                const now = new Date();
                const appDate = new Date(date);
                const diffTime = Math.abs(now - appDate);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                if (diffDays === 1) return 'Gestern';
                if (diffDays < 7) return `vor ${diffDays} Tagen`;
                if (diffDays < 30) return `vor ${Math.ceil(diffDays / 7)} Wochen`;
                return `vor ${Math.ceil(diffDays / 30)} Monaten`;
            }

            addApplication() {
                const form = document.getElementById('addApplicationForm');
                const formData = new FormData(form);
                
                const application = {
                    id: Date.now(),
                    company: formData.get('company'),
                    position: formData.get('position'),
                    status: formData.get('status'),
                    notes: formData.get('notes'),
                    date: new Date().toISOString()
                };

                this.applications.push(application);
                this.saveApplications();
                this.updateStats();
                this.renderApplications();
                this.closeModal('addModal');
                form.reset();
            }

            updateApplication() {
                const form = document.getElementById('editApplicationForm');
                const formData = new FormData(form);
                const id = parseInt(formData.get('id'));
                
                const application = this.applications.find(app => app.id === id);
                if (application) {
                    application.company = formData.get('company');
                    application.position = formData.get('position');
                    application.status = formData.get('status');
                    application.notes = formData.get('notes');
                    
                    this.saveApplications();
                    this.updateStats();
                    this.renderApplications();
                    this.closeModal('editModal');
                }
            }

            deleteApplication(id) {
                if (confirm('Möchtest du diese Bewerbung wirklich löschen?')) {
                    this.applications = this.applications.filter(app => app.id !== id);
                    this.saveApplications();
                    this.updateStats();
                    this.renderApplications();
                }
            }

            openModal(modalId) {
                document.getElementById(modalId).style.display = 'block';
            }

            closeModal(modalId) {
                document.getElementById(modalId).style.display = 'none';
            }
        }

        // Global instance
        const applicationsManager = new ApplicationsManager();

        // Global functions
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function openAddModal() {
            openModal('addModal');
        }

        function editApplication(id) {
            const application = applicationsManager.applications.find(app => app.id === id);
            if (application) {
                document.getElementById('editId').value = application.id;
                document.getElementById('editCompany').value = application.company;
                document.getElementById('editPosition').value = application.position;
                document.getElementById('editStatus').value = application.status;
                document.getElementById('editNotes').value = application.notes || '';
                openModal('editModal');
            }
        }

        function deleteApplication(id) {
            applicationsManager.deleteApplication(id);
        }

        function viewApplication(id) {
            const application = applicationsManager.applications.find(app => app.id === id);
            if (application) {
                alert(`Bewerbung bei ${application.company}\nPosition: ${application.position}\nStatus: ${applicationsManager.getStatusText(application.status)}\nDatum: ${new Date(application.date).toLocaleDateString('de-DE')}\nNotizen: ${application.notes || 'Keine'}`);
            }
        }

        function closeModal(modalId) {
            applicationsManager.closeModal(modalId);
        }

        function exportApplications() {
            const applications = applicationsManager.applications;
            
            if (applications.length === 0) {
                alert('Keine Bewerbungen zum Exportieren vorhanden!');
                return;
            }
            
            const csvContent = [
                ['Unternehmen', 'Position', 'Status', 'Datum', 'Notizen'],
                ...applications.map(app => [
                    app.company,
                    app.position,
                    applicationsManager.getStatusText(app.status),
                    new Date(app.date).toLocaleDateString('de-DE'),
                    app.notes || ''
                ])
            ].map(row => row.map(cell => `"${cell}"`).join(',')).join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `bewerbungen_${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
        }

        function generateReport() {
            const stats = {
                total: applicationsManager.applications.length,
                positive: applicationsManager.applications.filter(app => 
                    app.status === 'interview' || app.status === 'accepted'
                ).length,
                rejections: applicationsManager.applications.filter(app => 
                    app.status === 'rejected'
                ).length,
                pending: applicationsManager.applications.filter(app => 
                    app.status === 'sent' || app.status === 'reviewed'
                ).length
            };
            
            const successRate = stats.total > 0 ? Math.round((stats.positive / stats.total) * 100) : 0;
            
            alert(`📊 Bewerbungsbericht\n\nGesamt: ${stats.total}\nPositive Rückmeldungen: ${stats.positive}\nAbsagen: ${stats.rejections}\nAusstehend: ${stats.pending}\nErfolgsrate: ${successRate}%`);
        }

        function openSettings() {
            alert('Einstellungen werden in einer zukünftigen Version verfügbar sein.');
        }

        // AI Letter Generator Functions
        function openAILetterGenerator() {
            openModal('aiLetterModal');
            resetAIGenerator();
        }

        function resetAIGenerator() {
            // Reset to step 1
            document.querySelectorAll('.ai-step').forEach(step => step.classList.remove('active'));
            document.getElementById('aiStep1').classList.add('active');
            
            // Reset status indicators
            document.getElementById('cvStatus').textContent = 'Wird analysiert...';
            document.getElementById('cvStatus').className = 'analysis-status';
            document.getElementById('appStatus').textContent = 'Wird analysiert...';
            document.getElementById('appStatus').className = 'analysis-status';
            document.getElementById('qualStatus').textContent = 'Wird analysiert...';
            document.getElementById('qualStatus').className = 'analysis-status';
        }

        function analyzeData() {
            const analyzeBtn = document.getElementById('analyzeBtn');
            analyzeBtn.disabled = true;
            analyzeBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Analysiere...';

            // Simulate data analysis
            setTimeout(() => {
                document.getElementById('cvStatus').textContent = 'Analysiert';
                document.getElementById('cvStatus').className = 'analysis-status completed';
            }, 1000);

            setTimeout(() => {
                document.getElementById('appStatus').textContent = 'Analysiert';
                document.getElementById('appStatus').className = 'analysis-status completed';
            }, 1500);

            setTimeout(() => {
                document.getElementById('qualStatus').textContent = 'Analysiert';
                document.getElementById('qualStatus').className = 'analysis-status completed';
                
                analyzeBtn.disabled = false;
                analyzeBtn.innerHTML = '<i class="fas fa-arrow-right"></i> Weiter zu Schritt 2';
                analyzeBtn.onclick = proceedToStep2;
            }, 2000);
        }

        function proceedToStep2() {
            document.querySelectorAll('.ai-step').forEach(step => step.classList.remove('active'));
            document.getElementById('aiStep2').classList.add('active');
        }

        function proceedToStep3() {
            const jobDescription = document.getElementById('jobDescription').value;
            const companyName = document.getElementById('companyName').value;
            const positionTitle = document.getElementById('positionTitle').value;

            if (!jobDescription.trim()) {
                alert('Bitte füge eine Stellenanzeige ein.');
                return;
            }

            document.querySelectorAll('.ai-step').forEach(step => step.classList.remove('active'));
            document.getElementById('aiStep3').classList.add('active');
        }

        function generateCoverLetter() {
            const generateBtn = document.getElementById('generateBtn');
            const progressFill = document.getElementById('aiProgressFill');
            const progressText = document.getElementById('aiProgressText');
            const insights = document.getElementById('aiInsights');
            const requirementsList = document.getElementById('requirementsList');

            generateBtn.disabled = true;
            generateBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generiere...';

            // Simulate AI analysis and generation
            const steps = [
                { progress: 20, text: 'Analysiere Stellenanzeige...' },
                { progress: 40, text: 'Erkenne Anforderungen...' },
                { progress: 60, text: 'Matche mit deinen Qualifikationen...' },
                { progress: 80, text: 'Formuliere Anschreiben...' },
                { progress: 100, text: 'Fertig!' }
            ];

            let currentStep = 0;
            const interval = setInterval(() => {
                if (currentStep < steps.length) {
                    const step = steps[currentStep];
                    progressFill.style.width = step.progress + '%';
                    progressText.textContent = step.text;

                    if (currentStep === 1) {
                        // Show requirements
                        const requirements = [
                            'Mindestens 3 Jahre Berufserfahrung',
                            'Kenntnisse in Projektmanagement',
                            'Teamfähigkeit und Kommunikationsstärke',
                            'Analytische Denkweise',
                            'Erfahrung mit modernen Tools'
                        ];
                        requirementsList.innerHTML = requirements.map(req => `<li>${req}</li>`).join('');
                        insights.style.display = 'block';
                    }

                    currentStep++;
                } else {
                    clearInterval(interval);
                    setTimeout(() => {
                        showGeneratedLetter();
                    }, 500);
                }
            }, 1500);
        }

        function showGeneratedLetter() {
            document.querySelectorAll('.ai-step').forEach(step => step.classList.remove('active'));
            document.getElementById('aiStep4').classList.add('active');

            const companyName = document.getElementById('companyName').value || 'das Unternehmen';
            const positionTitle = document.getElementById('positionTitle').value || 'die ausgeschriebene Position';

            document.getElementById('resultCompany').textContent = companyName;
            document.getElementById('resultPosition').textContent = positionTitle;

            // Generate sample cover letter
            const coverLetter = `Sehr geehrte Damen und Herren,

mit großem Interesse habe ich Ihre Stellenanzeige für ${positionTitle} bei ${companyName} gelesen. Als erfahrener HR-Tech Consultant mit über 5 Jahren Berufserfahrung in der digitalen Transformation von HR-Prozessen bin ich überzeugt, dass ich eine wertvolle Bereicherung für Ihr Team darstellen kann.

In meiner bisherigen Tätigkeit habe ich erfolgreich Unternehmen bei der Modernisierung ihrer HR-Abteilungen unterstützt und dabei messbare Verbesserungen erzielt. Meine Expertise in HR-Systemen wie Workday und SAP SuccessFactors sowie meine analytische Denkweise haben mir dabei geholfen, komplexe HR-Transformationen erfolgreich umzusetzen.

Besonders reizt mich an dieser Position die Möglichkeit, innovative HR-Tech-Lösungen zu entwickeln und dabei von einem dynamischen Team zu lernen. Ich bringe nicht nur fachliche Expertise in der HR-Digitalisierung mit, sondern auch die Leidenschaft, kontinuierlich dazuzulernen und mich neuen Herausforderungen zu stellen.

Gerne würde ich in einem persönlichen Gespräch erläutern, wie ich mit meinen Fähigkeiten und meiner Motivation zum Erfolg Ihres Unternehmens beitragen kann.

Mit freundlichen Grüßen
Manuel Weiss`;

            // Make letter editable
            makeLetterEditable(coverLetter);
        }

        function makeLetterEditable(coverLetter) {
            const contentDiv = document.getElementById('generatedLetterContent');
            contentDiv.className = 'letter-content editable';
            
            // Split into paragraphs and sentences
            const paragraphs = coverLetter.split('\n\n').filter(p => p.trim());
            let html = '';
            
            paragraphs.forEach((paragraph, pIndex) => {
                const sentences = paragraph.split('. ').filter(s => s.trim());
                html += `<div class="paragraph" data-paragraph="${pIndex}">`;
                
                sentences.forEach((sentence, sIndex) => {
                    const cleanSentence = sentence.trim();
                    if (cleanSentence) {
                        html += `<span class="sentence" data-paragraph="${pIndex}" data-sentence="${sIndex}">${cleanSentence}${cleanSentence.endsWith('.') ? '' : '.'}</span> `;
                    }
                });
                
                html += '</div>';
            });
            
            contentDiv.innerHTML = html;
            
            // Add click handlers
            addEditingEventListeners();
        }

        function addEditingEventListeners() {
            // Sentence click handlers
            document.querySelectorAll('.sentence').forEach(sentence => {
                sentence.addEventListener('click', (e) => {
                    e.stopPropagation();
                    selectSentence(sentence);
                });
            });
            
            // Paragraph click handlers
            document.querySelectorAll('.paragraph').forEach(paragraph => {
                paragraph.addEventListener('click', (e) => {
                    e.stopPropagation();
                    selectParagraph(paragraph);
                });
            });
        }

        function selectSentence(sentence) {
            // Remove previous selections
            document.querySelectorAll('.sentence.selected').forEach(s => s.classList.remove('selected'));
            document.querySelectorAll('.paragraph.selected').forEach(p => p.classList.remove('selected'));
            
            // Select current sentence
            sentence.classList.add('selected');
            
            // Show sentence alternatives
            showSentenceAlternatives(sentence.textContent.trim());
        }

        function selectParagraph(paragraph) {
            // Remove previous selections
            document.querySelectorAll('.sentence.selected').forEach(s => s.classList.remove('selected'));
            document.querySelectorAll('.paragraph.selected').forEach(p => p.classList.remove('selected'));
            
            // Select current paragraph
            paragraph.classList.add('selected');
        }

        function showSentenceAlternatives(originalSentence) {
            console.log('🔍 Original sentence:', originalSentence);
            document.getElementById('originalSentenceText').textContent = originalSentence;
            
            // Generate alternatives (simulated)
            const alternatives = generateSentenceAlternatives(originalSentence);
            console.log('🎯 Generated alternatives:', alternatives);
            
            const alternativesContainer = document.getElementById('alternativeOptions');
            
            alternativesContainer.innerHTML = alternatives.map((alt, index) => `
                <div class="alternative-option" onclick="selectAlternative(${index})">
                    <p class="alternative-text">${alt}</p>
                </div>
            `).join('');
            
            openModal('sentenceModal');
        }

        function generateSentenceAlternatives(originalSentence) {
            // Enhanced AI-generated alternatives with comprehensive pattern matching
            const alternatives = [];
            
            // Detect sentence type and generate appropriate alternatives
            const isFirstSentence = originalSentence.includes('Sehr geehrte') || originalSentence.includes('mit großem Interesse');
            const isMiddleSentence = originalSentence.includes('überzeugt') || originalSentence.includes('Bereicherung');
            const isClosingSentence = originalSentence.includes('freundlichen Grüßen') || originalSentence.includes('Mit freundlichen');
            
            console.log('🔍 Sentence analysis:', {
                original: originalSentence,
                isFirstSentence,
                isMiddleSentence,
                isClosingSentence
            });
            
            if (isFirstSentence) {
                // Alternatives for opening sentences
                alternatives.push(
                    originalSentence.replace(/mit großem Interesse.*gelesen/g, 'bin ich auf Ihre Stellenanzeige aufmerksam geworden'),
                    originalSentence.replace(/mit großem Interesse.*gelesen/g, 'möchte ich mich gerne auf die ausgeschriebene Position bewerben'),
                    originalSentence.replace(/mit großem Interesse.*gelesen/g, 'bin ich begeistert von Ihrer Stellenausschreibung')
                );
            } else if (isMiddleSentence) {
                // Alternatives for middle sentences
                alternatives.push(
                    originalSentence.replace(/überzeugt/g, 'sicher').replace(/wertvolle Bereicherung/g, 'ideale Ergänzung'),
                    originalSentence.replace(/überzeugt/g, 'davon überzeugt').replace(/wertvolle Bereicherung/g, 'perfekte Besetzung'),
                    originalSentence.replace(/überzeugt/g, 'fest davon überzeugt').replace(/wertvolle Bereicherung/g, 'großen Mehrwert')
                );
            } else if (isClosingSentence) {
                // Alternatives for closing sentences
                alternatives.push(
                    originalSentence.replace(/Mit freundlichen Grüßen/g, 'Mit freundlichen Grüßen und freudiger Erwartung'),
                    originalSentence.replace(/Mit freundlichen Grüßen/g, 'Mit freundlichen Grüßen und besten Wünschen'),
                    originalSentence.replace(/Mit freundlichen Grüßen/g, 'Mit freundlichen Grüßen und herzlichen Dank')
                );
            } else {
                // Generic alternatives for any sentence
                alternatives.push(
                    originalSentence.replace(/ich/g, 'ich gerne').replace(/kann/g, 'könnte'),
                    originalSentence.replace(/sehr/g, 'besonders').replace(/gut/g, 'ausgezeichnet'),
                    originalSentence.replace(/möchte/g, 'würde gerne').replace(/helfen/g, 'unterstützen')
                );
            }
            
            // Fallback: If no patterns matched, create generic alternatives
            if (alternatives.length === 0 || alternatives.every(alt => alt === originalSentence)) {
                alternatives.push(
                    originalSentence.replace(/ich/g, 'ich gerne'),
                    originalSentence.replace(/sehr/g, 'besonders'),
                    originalSentence.replace(/gut/g, 'ausgezeichnet')
                );
            }
            
            // Ensure we have exactly 3 alternatives
            while (alternatives.length < 3) {
                alternatives.push(originalSentence);
            }
            
            return alternatives.slice(0, 3);
        }

        function selectAlternative(index) {
            // Remove previous selections
            document.querySelectorAll('.alternative-option').forEach(opt => opt.classList.remove('selected'));
            
            // Select current alternative
            document.querySelectorAll('.alternative-option')[index].classList.add('selected');
            
            // Apply the alternative
            const selectedText = document.querySelectorAll('.alternative-option')[index].textContent.trim();
            const selectedSentence = document.querySelector('.sentence.selected');
            
            if (selectedSentence) {
                selectedSentence.textContent = selectedText;
                selectedSentence.classList.remove('selected');
            }
            
            closeModal('sentenceModal');
        }

        function regenerateAlternatives() {
            const originalSentence = document.getElementById('originalSentenceText').textContent;
            const alternatives = generateSentenceAlternatives(originalSentence);
            const alternativesContainer = document.getElementById('alternativeOptions');
            
            alternativesContainer.innerHTML = alternatives.map((alt, index) => `
                <div class="alternative-option" onclick="selectAlternative(${index})">
                    <p class="alternative-text">${alt}</p>
                </div>
            `).join('');
        }

        function regenerateLetter() {
            document.querySelectorAll('.ai-step').forEach(step => step.classList.remove('active'));
            document.getElementById('aiStep3').classList.add('active');
            
            // Reset progress
            document.getElementById('aiProgressFill').style.width = '0%';
            document.getElementById('aiProgressText').textContent = 'Bereite Analyse vor...';
            document.getElementById('aiInsights').style.display = 'none';
            
            const generateBtn = document.getElementById('generateBtn');
            generateBtn.disabled = false;
            generateBtn.innerHTML = '<i class="fas fa-robot"></i> Anschreiben generieren';
        }

        // Editing Tool Functions
        function enableSentenceEditing() {
            const toolBtn = event.target.closest('.tool-btn');
            toolBtn.classList.toggle('active');
            
            if (toolBtn.classList.contains('active')) {
                // Enable sentence editing mode
                document.querySelectorAll('.sentence').forEach(sentence => {
                    sentence.style.cursor = 'pointer';
                });
                alert('Klick auf einen Satz, um Alternativen zu sehen!');
            } else {
                // Disable sentence editing mode
                document.querySelectorAll('.sentence').forEach(sentence => {
                    sentence.style.cursor = 'default';
                });
            }
        }

        function enableParagraphEditing() {
            const toolBtn = event.target.closest('.tool-btn');
            toolBtn.classList.toggle('active');
            
            if (toolBtn.classList.contains('active')) {
                // Show paragraph selection modal
                showParagraphSelection();
            } else {
                // Disable paragraph editing mode
                document.querySelectorAll('.paragraph').forEach(paragraph => {
                    paragraph.style.cursor = 'default';
                });
            }
        }

        function improveTone() {
            const toolBtn = event.target.closest('.tool-btn');
            toolBtn.classList.toggle('active');
            
            if (toolBtn.classList.contains('active')) {
                // Simulate tone improvement
                const contentDiv = document.getElementById('generatedLetterContent');
                const currentText = contentDiv.textContent;
                
                // Simulate AI tone improvement
                const improvedText = currentText
                    .replace(/überzeugt/g, 'fest davon überzeugt')
                    .replace(/kann/g, 'kann und werde')
                    .replace(/möchte/g, 'möchte sehr gerne');
                
                makeLetterEditable(improvedText);
                alert('Ton wurde verbessert!');
            }
        }

        function showParagraphSelection() {
            const paragraphs = document.querySelectorAll('.paragraph');
            const paragraphOptions = document.getElementById('paragraphOptions');
            
            paragraphOptions.innerHTML = paragraphs.map((paragraph, index) => `
                <div class="paragraph-option" onclick="selectParagraphForRegeneration(${index})">
                    <p class="paragraph-preview">${paragraph.textContent.substring(0, 100)}...</p>
                </div>
            `).join('');
            
            openModal('paragraphModal');
        }

        function selectParagraphForRegeneration(index) {
            // Remove previous selections
            document.querySelectorAll('.paragraph-option').forEach(opt => opt.classList.remove('selected'));
            
            // Select current paragraph
            document.querySelectorAll('.paragraph-option')[index].classList.add('selected');
            
            // Store selected paragraph index
            window.selectedParagraphIndex = index;
        }

        function regenerateParagraph() {
            const selectedIndex = window.selectedParagraphIndex;
            if (selectedIndex === undefined) {
                alert('Bitte wähle einen Absatz aus!');
                return;
            }
            
            const tone = document.getElementById('paragraphTone').value;
            const focus = document.getElementById('paragraphFocus').value;
            const selectedParagraph = document.querySelectorAll('.paragraph')[selectedIndex];
            
            // Simulate AI paragraph regeneration
            const newParagraph = generateNewParagraph(tone, focus, selectedParagraph.textContent);
            
            // Replace the paragraph
            selectedParagraph.innerHTML = newParagraph;
            
            // Re-add event listeners
            addEditingEventListeners();
            
            closeModal('paragraphModal');
            alert('Absatz wurde neu generiert!');
        }

        function generateNewParagraph(tone, focus, originalText) {
            // Simulate AI-generated paragraph based on tone and focus
            const baseText = originalText;
            
            let newText = baseText;
            
            // Apply tone changes
            switch (tone) {
                case 'enthusiastic':
                    newText = newText.replace(/bin ich überzeugt/g, 'bin ich begeistert und überzeugt');
                    newText = newText.replace(/kann/g, 'kann und werde mit Leidenschaft');
                    break;
                case 'confident':
                    newText = newText.replace(/bin ich überzeugt/g, 'bin ich absolut überzeugt');
                    newText = newText.replace(/kann/g, 'kann selbstbewusst');
                    break;
                case 'humble':
                    newText = newText.replace(/bin ich überzeugt/g, 'hoffe ich, dass ich');
                    newText = newText.replace(/kann/g, 'könnte');
                    break;
            }
            
            // Apply focus changes
            switch (focus) {
                case 'experience':
                    newText = newText.replace(/Berufserfahrung/g, 'umfangreiche Berufserfahrung');
                    break;
                case 'skills':
                    newText = newText.replace(/Fähigkeiten/g, 'meine vielfältigen Fähigkeiten');
                    break;
                case 'motivation':
                    newText = newText.replace(/reizt mich/g, 'begeistert mich besonders');
                    break;
                case 'achievements':
                    newText = newText.replace(/erfolgreich/g, 'nachweislich erfolgreich');
                    break;
            }
            
            return newText;
        }

        function saveLetter() {
            const letterContent = document.getElementById('generatedLetterContent').textContent;
            const companyName = document.getElementById('resultCompany').textContent;
            const positionTitle = document.getElementById('resultPosition').textContent;
            
            // Save letter to localStorage
            const savedLetters = JSON.parse(localStorage.getItem('coverLetters') || '[]');
            const newLetter = {
                id: Date.now(),
                company: companyName,
                position: positionTitle,
                content: letterContent,
                createdAt: new Date().toISOString()
            };
            
            savedLetters.push(newLetter);
            localStorage.setItem('coverLetters', JSON.stringify(savedLetters));
            
            // Automatically create new application
            const newApplication = createApplicationFromLetter(newLetter);
            
            // Save application to localStorage
            const applications = JSON.parse(localStorage.getItem('applications') || '[]');
            applications.push(newApplication);
            localStorage.setItem('applications', JSON.stringify(applications));
            
            // Update statistics
            applicationsManager.updateStats();
            applicationsManager.renderApplications();
            
            // Show success message with application details
            showSaveSuccess(newApplication);
        }

        function createApplicationFromLetter(letter) {
            const applicationId = Date.now() + Math.random(); // Ensure unique ID
            
            return {
                id: applicationId,
                company: letter.company,
                position: letter.position,
                status: 'sent',
                notes: `Automatisch erstellt aus KI-Anschreiben. Anschreiben-ID: ${letter.id}`,
                date: new Date().toISOString(),
                coverLetterId: letter.id,
                source: 'ai-generated',
                views: 0,
                lastViewed: null
            };
        }

        function showSaveSuccess(application) {
            const successMessage = `
                ✅ Anschreiben und Bewerbung erfolgreich erstellt!
                
                📋 Bewerbung:
                • Unternehmen: ${application.company}
                • Position: ${application.position}
                • Status: Gesendet
                • ID: ${application.id}
                
                📝 Anschreiben wurde automatisch verknüpft.
                
                Du kannst die Bewerbung jetzt in der Liste sehen und den HR-Link teilen!
            `;
            
            alert(successMessage);
            
            // Close the AI letter modal
            closeModal('aiLetterModal');
            
            // Optionally scroll to the new application in the list
            setTimeout(() => {
                const newApplicationCard = document.querySelector(`[onclick*="${application.id}"]`);
                if (newApplicationCard) {
                    newApplicationCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    newApplicationCard.style.animation = 'pulse 2s ease-in-out';
                }
            }, 500);
        }

        function copyLetter() {
            const letterContent = document.getElementById('generatedLetterContent').textContent;
            const companyName = document.getElementById('resultCompany').textContent;
            const positionTitle = document.getElementById('resultPosition').textContent;
            
            // Copy to clipboard
            navigator.clipboard.writeText(letterContent).then(() => {
                // Automatically create application when copying
                const newLetter = {
                    id: Date.now(),
                    company: companyName,
                    position: positionTitle,
                    content: letterContent,
                    createdAt: new Date().toISOString()
                };
                
                const newApplication = createApplicationFromLetter(newLetter);
                
                // Save both letter and application
                const savedLetters = JSON.parse(localStorage.getItem('coverLetters') || '[]');
                savedLetters.push(newLetter);
                localStorage.setItem('coverLetters', JSON.stringify(savedLetters));
                
                const applications = JSON.parse(localStorage.getItem('applications') || '[]');
                applications.push(newApplication);
                localStorage.setItem('applications', JSON.stringify(applications));
                
                // Update statistics
                applicationsManager.updateStats();
                applicationsManager.renderApplications();
                
                // Show success message
                showCopySuccess(newApplication);
                
            }).catch(() => {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = letterContent;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                // Still create application even with fallback
                const newLetter = {
                    id: Date.now(),
                    company: companyName,
                    position: positionTitle,
                    content: letterContent,
                    createdAt: new Date().toISOString()
                };
                
                const newApplication = createApplicationFromLetter(newLetter);
                
                const savedLetters = JSON.parse(localStorage.getItem('coverLetters') || '[]');
                savedLetters.push(newLetter);
                localStorage.setItem('coverLetters', JSON.stringify(savedLetters));
                
                const applications = JSON.parse(localStorage.getItem('applications') || '[]');
                applications.push(newApplication);
                localStorage.setItem('applications', JSON.stringify(applications));
                
                applicationsManager.updateStats();
                applicationsManager.renderApplications();
                
                showCopySuccess(newApplication);
            });
        }

        function showCopySuccess(application) {
            const successMessage = `
                ✅ Anschreiben kopiert und Bewerbung erstellt!
                
                📋 Neue Bewerbung:
                • Unternehmen: ${application.company}
                • Position: ${application.position}
                • Status: Gesendet
                
                📝 Anschreiben ist in der Zwischenablage und wurde automatisch verknüpft.
                
                Du kannst die Bewerbung jetzt in der Liste sehen und den HR-Link teilen!
            `;
            
            alert(successMessage);
            
            // Close the AI letter modal
            closeModal('aiLetterModal');
            
            // Scroll to the new application
            setTimeout(() => {
                const newApplicationCard = document.querySelector(`[onclick*="${application.id}"]`);
                if (newApplicationCard) {
                    newApplicationCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    newApplicationCard.style.animation = 'pulse 2s ease-in-out';
                }
            }, 500);
        }

        // Status Management Functions
        let currentApplicationId = null;
        let selectedNewStatus = null;

        function showStatusDropdown(applicationId, currentStatus) {
            currentApplicationId = applicationId;
            selectedNewStatus = null;
            
            const application = applicationsManager.applications.find(app => app.id == applicationId);
            if (!application) return;
            
            // Show current status
            const currentStatusDisplay = document.getElementById('currentStatusDisplay');
            const statusOptions = applicationsManager.getStatusOptions();
            const currentStatusOption = statusOptions.find(opt => opt.value === currentStatus);
            
            currentStatusDisplay.textContent = currentStatusOption ? currentStatusOption.text : currentStatus;
            currentStatusDisplay.style.backgroundColor = currentStatusOption ? currentStatusOption.color : '#6b7280';
            currentStatusDisplay.style.color = 'white';
            currentStatusDisplay.style.borderColor = currentStatusOption ? currentStatusOption.color : '#6b7280';
            
            // Populate status options
            const statusOptionsList = document.getElementById('statusOptionsList');
            statusOptionsList.innerHTML = statusOptions.map(option => `
                <div class="status-option" 
                     data-status="${option.value}" 
                     onclick="selectStatusOption('${option.value}')"
                     style="border-color: ${option.color}; color: ${option.color};">
                    ${option.text}
                </div>
            `).join('');
            
            // Reset confirm button
            document.getElementById('confirmStatusBtn').disabled = true;
            
            // Show modal
            openModal('statusModal');
        }

        function selectStatusOption(status) {
            selectedNewStatus = status;
            
            // Remove previous selection
            document.querySelectorAll('.status-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Add selection to clicked option
            const selectedOption = document.querySelector(`[data-status="${status}"]`);
            if (selectedOption) {
                selectedOption.classList.add('selected');
            }
            
            // Enable confirm button
            document.getElementById('confirmStatusBtn').disabled = false;
        }

        function confirmStatusChange() {
            if (!currentApplicationId || !selectedNewStatus) return;
            
            // Update application status
            const application = applicationsManager.applications.find(app => app.id == currentApplicationId);
            if (application) {
                application.status = selectedNewStatus;
                
                // Save to localStorage
                localStorage.setItem('applications', JSON.stringify(applicationsManager.applications));
                
                // Update statistics and render
                applicationsManager.updateStats();
                applicationsManager.renderApplications();
                
                // Show success message
                const statusOptions = applicationsManager.getStatusOptions();
                const newStatusText = statusOptions.find(opt => opt.value === selectedNewStatus)?.text || selectedNewStatus;
                
                alert(`✅ Status erfolgreich geändert zu: ${newStatusText}`);
            }
            
            // Close modal
            closeModal('statusModal');
        }

        function quickStatusChange(newStatus) {
            // Get all applications that are not already in the target status
            const applicationsToUpdate = applicationsManager.applications.filter(app => app.status !== newStatus);
            
            if (applicationsToUpdate.length === 0) {
                const statusOptions = applicationsManager.getStatusOptions();
                const statusText = statusOptions.find(opt => opt.value === newStatus)?.text || newStatus;
                alert(`Alle Bewerbungen sind bereits auf Status "${statusText}" gesetzt.`);
                return;
            }
            
            // Show confirmation dialog
            const statusOptions = applicationsManager.getStatusOptions();
            const statusText = statusOptions.find(opt => opt.value === newStatus)?.text || newStatus;
            const count = applicationsToUpdate.length;
            
            const confirmed = confirm(
                `Möchten Sie ${count} Bewerbung${count > 1 ? 'en' : ''} auf Status "${statusText}" setzen?\n\n` +
                `Betroffene Bewerbungen:\n` +
                applicationsToUpdate.slice(0, 5).map(app => `• ${app.company} - ${app.position}`).join('\n') +
                (applicationsToUpdate.length > 5 ? `\n... und ${applicationsToUpdate.length - 5} weitere` : '')
            );
            
            if (confirmed) {
                // Update all applications
                applicationsToUpdate.forEach(app => {
                    app.status = newStatus;
                });
                
                // Save to localStorage
                localStorage.setItem('applications', JSON.stringify(applicationsManager.applications));
                
                // Update statistics and render
                applicationsManager.updateStats();
                applicationsManager.renderApplications();
                
                // Show success message
                alert(`✅ ${count} Bewerbung${count > 1 ? 'en' : ''} erfolgreich auf "${statusText}" gesetzt!`);
            }
        }

        // Share Application Functions
        function shareApplication(id) {
            const application = applicationsManager.applications.find(app => app.id === id);
            if (!application) return;

            // Update modal content
            document.getElementById('shareApplicationTitle').textContent = application.position;
            document.getElementById('shareApplicationCompany').textContent = application.company;

            // Generate HR link
            const baseUrl = window.location.origin + window.location.pathname.replace('bewerbungen.html', '');
            const hrLink = `${baseUrl}bewerbung.html?id=${application.id}`;
            document.getElementById('shareUrl').value = hrLink;

            // Generate email template
            const emailTemplate = generateEmailTemplate(application, hrLink);
            document.getElementById('shareEmail').value = emailTemplate;

            // Open modal
            openModal('shareModal');
        }

        function generateEmailTemplate(application, hrLink) {
            return `Betreff: Bewerbung für ${application.position} - Manuel Weiss

Sehr geehrte Damen und Herren,

vielen Dank für Ihr Interesse an meiner Bewerbung für die Position "${application.position}" bei ${application.company}.

Ich freue mich, Ihnen meine vollständige Bewerbungsunterlagen über den folgenden Link zur Verfügung zu stellen:

${hrLink}

Diese Seite enthält:
• Mein persönliches Anschreiben
• Detaillierte Informationen zu meiner Berufserfahrung
• Meine Qualifikationen und Kompetenzen
• Kontaktmöglichkeiten
• Download-Links für weitere Unterlagen

Die Seite ist speziell für HR-Mitarbeiter optimiert und bietet eine übersichtliche Darstellung aller relevanten Informationen.

Bei Fragen stehe ich Ihnen gerne zur Verfügung.

Mit freundlichen Grüßen
Manuel Weiss

---
Diese E-Mail wurde automatisch generiert. Für weitere Informationen besuchen Sie: ${hrLink}`;
        }

        function copyShareUrl() {
            const urlInput = document.getElementById('shareUrl');
            urlInput.select();
            urlInput.setSelectionRange(0, 99999); // For mobile devices
            
            navigator.clipboard.writeText(urlInput.value).then(() => {
                alert('HR-Link wurde in die Zwischenablage kopiert!');
            }).catch(() => {
                // Fallback
                document.execCommand('copy');
                alert('HR-Link wurde in die Zwischenablage kopiert!');
            });
        }

        function copyEmailTemplate() {
            const emailTextarea = document.getElementById('shareEmail');
            emailTextarea.select();
            emailTextarea.setSelectionRange(0, 99999);
            
            navigator.clipboard.writeText(emailTextarea.value).then(() => {
                alert('E-Mail-Vorlage wurde in die Zwischenablage kopiert!');
            }).catch(() => {
                // Fallback
                document.execCommand('copy');
                alert('E-Mail-Vorlage wurde in die Zwischenablage kopiert!');
            });
        }

        function openEmailClient() {
            const emailTemplate = document.getElementById('shareEmail').value;
            const subject = `Bewerbung für ${document.getElementById('shareApplicationTitle').textContent} - Manuel Weiss`;
            const body = encodeURIComponent(emailTemplate);
            
            const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${body}`;
            window.open(mailtoLink);
        }

        // Close modal when clicking outside
        window.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                e.target.style.display = 'none';
            }
        });

        // Smart Templates & Snippets
        function initializeSmartTemplates() {
            const templates = [
                {
                    title: "Erfahrung einleiten",
                    content: "Mit über 6 Jahren Erfahrung in der digitalen Transformation bringe ich umfassende Expertise in...",
                    category: "introduction"
                },
                {
                    title: "Skills hervorheben",
                    content: "Meine Kernkompetenzen umfassen strategische HR-Beratung, Prozessoptimierung und KI-Integration...",
                    category: "skills"
                },
                {
                    title: "Motivation ausdrücken",
                    content: "Besonders reizt mich an dieser Position die Möglichkeit, innovative Lösungen zu entwickeln...",
                    category: "motivation"
                },
                {
                    title: "Abschluss formulieren",
                    content: "Ich freue mich auf ein persönliches Gespräch und die Möglichkeit, Ihnen meine Qualifikationen im Detail vorstellen zu können.",
                    category: "closing"
                },
                {
                    title: "Projektmanagement",
                    content: "Erfolgreiche Leitung von Digitalisierungsprojekten mit Budgets bis zu 500.000€ und Teams von 15+ Personen.",
                    category: "achievements"
                },
                {
                    title: "KI-Expertise",
                    content: "Implementierung von KI-Tools in HR-Prozessen mit messbaren Effizienzsteigerungen von 40%.",
                    category: "achievements"
                }
            ];
            
            return templates;
        }

        function insertSnippet(snippet) {
            const coverLetterText = document.getElementById('coverLetterText');
            if (coverLetterText) {
                const cursorPos = coverLetterText.selectionStart;
                const textBefore = coverLetterText.value.substring(0, cursorPos);
                const textAfter = coverLetterText.value.substring(cursorPos);
                
                coverLetterText.value = textBefore + snippet + ' ' + textAfter;
                coverLetterText.focus();
                coverLetterText.setSelectionRange(cursorPos + snippet.length + 1, cursorPos + snippet.length + 1);
                
                // Trigger real-time feedback
                updateRealTimeFeedback();
            }
        }

        function showSmartTemplates() {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 800px;">
                    <div class="modal-header">
                        <h3><i class="fas fa-magic"></i> Smart Templates & Snippets</h3>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="smart-templates">
                            <h3><i class="fas fa-lightbulb"></i> Intelligente Textbausteine</h3>
                            <div class="template-snippets">
                                ${initializeSmartTemplates().map(template => `
                                    <div class="snippet-card" onclick="insertSnippet('${template.content.replace(/'/g, "\\'")}')">
                                        <div class="snippet-title">${template.title}</div>
                                        <div class="snippet-preview">${template.content.substring(0, 80)}...</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div class="batch-actions">
                            <h3><i class="fas fa-bolt"></i> Batch-Aktionen</h3>
                            <div class="batch-buttons">
                                <button class="batch-btn" onclick="createMultipleApplications()">
                                    <i class="fas fa-copy"></i>
                                    Mehrere Bewerbungen erstellen
                                </button>
                                <button class="batch-btn" onclick="exportAllApplications()">
                                    <i class="fas fa-download"></i>
                                    Alle Bewerbungen exportieren
                                </button>
                                <button class="batch-btn" onclick="scheduleFollowUps()">
                                    <i class="fas fa-calendar-check"></i>
                                    Follow-ups planen
                                </button>
                                <button class="batch-btn" onclick="generateReport()">
                                    <i class="fas fa-chart-line"></i>
                                    Erfolgsbericht erstellen
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Real-time Quality Feedback
        function updateRealTimeFeedback() {
            const coverLetterText = document.getElementById('coverLetterText');
            if (!coverLetterText) return;
            
            const text = coverLetterText.value;
            if (text.length < 50) return;
            
            const metrics = analyzeTextQuality(text);
            showQualityFeedback(metrics);
        }

        function analyzeTextQuality(text) {
            const wordCount = text.split(/\s+/).length;
            const sentenceCount = text.split(/[.!?]+/).length;
            const avgWordsPerSentence = wordCount / sentenceCount;
            
            // Keyword analysis
            const keywords = ['Projektmanagement', 'Digitalisierung', 'KI', 'HR', 'Strategie', 'Innovation', 'Leadership'];
            const keywordMatches = keywords.filter(keyword => 
                text.toLowerCase().includes(keyword.toLowerCase())
            ).length;
            
            // Readability score (simplified)
            const readabilityScore = Math.max(0, Math.min(100, 100 - (avgWordsPerSentence - 15) * 2));
            
            // ATS score (based on keyword density and structure)
            const atsScore = Math.min(100, 60 + (keywordMatches * 8) + (text.includes('•') ? 10 : 0));
            
            // Match score (simplified)
            const matchScore = Math.min(100, 70 + (keywordMatches * 5) + (wordCount > 200 ? 10 : 0));
            
            return {
                wordCount,
                readabilityScore: Math.round(readabilityScore),
                atsScore: Math.round(atsScore),
                matchScore: Math.round(matchScore),
                keywordMatches
            };
        }

        function showQualityFeedback(metrics) {
            let feedbackElement = document.getElementById('qualityFeedback');
            if (!feedbackElement) {
                feedbackElement = document.createElement('div');
                feedbackElement.id = 'qualityFeedback';
                feedbackElement.className = 'quality-feedback';
                document.body.appendChild(feedbackElement);
            }
            
            feedbackElement.innerHTML = `
                <div class="feedback-header">
                    <i class="fas fa-chart-line"></i>
                    <span class="feedback-title">Live-Qualitätsanalyse</span>
                </div>
                <div class="feedback-metrics">
                    <div class="feedback-metric">
                        <span class="metric-name">Wörter:</span>
                        <span class="metric-score ${getScoreClass(metrics.wordCount, 200, 400)}">${metrics.wordCount}</span>
                    </div>
                    <div class="feedback-metric">
                        <span class="metric-name">Readability:</span>
                        <span class="metric-score ${getScoreClass(metrics.readabilityScore, 70, 90)}">${metrics.readabilityScore}%</span>
                    </div>
                    <div class="feedback-metric">
                        <span class="metric-name">ATS-Score:</span>
                        <span class="metric-score ${getScoreClass(metrics.atsScore, 70, 90)}">${metrics.atsScore}%</span>
                    </div>
                    <div class="feedback-metric">
                        <span class="metric-name">Match-Score:</span>
                        <span class="metric-score ${getScoreClass(metrics.matchScore, 70, 90)}">${metrics.matchScore}%</span>
                    </div>
                </div>
            `;
            
            feedbackElement.classList.add('active');
            
            // Auto-hide after 5 seconds
            setTimeout(() => {
                feedbackElement.classList.remove('active');
            }, 5000);
        }

        function getScoreClass(score, goodThreshold, excellentThreshold) {
            if (score >= excellentThreshold) return 'excellent';
            if (score >= goodThreshold) return 'good';
            if (score >= goodThreshold - 20) return 'needs-improvement';
            return 'poor';
        }

        // Auto-save functionality
        function initializeAutoSave() {
            const coverLetterText = document.getElementById('coverLetterText');
            if (coverLetterText) {
                let saveTimeout;
                coverLetterText.addEventListener('input', () => {
                    clearTimeout(saveTimeout);
                    saveTimeout = setTimeout(() => {
                        autoSave();
                        updateRealTimeFeedback();
                    }, 2000);
                });
            }
        }

        function autoSave() {
            const coverLetterText = document.getElementById('coverLetterText');
            if (coverLetterText && coverLetterText.value.length > 10) {
                // Save to localStorage
                const autoSaveData = {
                    content: coverLetterText.value,
                    timestamp: new Date().toISOString(),
                    company: document.getElementById('aiCompanyName')?.value || '',
                    position: document.getElementById('aiPositionTitle')?.value || ''
                };
                
                localStorage.setItem('autoSaveCoverLetter', JSON.stringify(autoSaveData));
                showAutoSaveIndicator();
            }
        }

        function showAutoSaveIndicator() {
            let indicator = document.getElementById('autoSaveIndicator');
            if (!indicator) {
                indicator = document.createElement('div');
                indicator.id = 'autoSaveIndicator';
                indicator.className = 'auto-save-indicator';
                document.body.appendChild(indicator);
            }
            
            indicator.innerHTML = '<i class="fas fa-save"></i> Automatisch gespeichert';
            indicator.classList.add('active');
            
            setTimeout(() => {
                indicator.classList.remove('active');
            }, 3000);
        }

        // Batch processing functions
        function createMultipleApplications() {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 600px;">
                    <div class="modal-header">
                        <h3><i class="fas fa-copy"></i> Mehrere Bewerbungen erstellen</h3>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label>Unternehmen (durch Komma getrennt):</label>
                            <textarea id="batchCompanies" placeholder="SAP, Microsoft, Google, Apple..." rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Position:</label>
                            <input type="text" id="batchPosition" placeholder="HR Manager">
                        </div>
                        <div class="form-group">
                            <label>Anschreiben-Vorlage:</label>
                            <select id="batchTemplate">
                                <option value="formal">Formal</option>
                                <option value="modern">Modern</option>
                                <option value="creative">Kreativ</option>
                                <option value="ats">ATS-optimiert</option>
                            </select>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" onclick="this.closest('.modal').remove()">Abbrechen</button>
                        <button class="btn btn-primary" onclick="processBatchApplications()">
                            <i class="fas fa-rocket"></i>
                            Bewerbungen erstellen
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function processBatchApplications() {
            const companies = document.getElementById('batchCompanies').value.split(',').map(c => c.trim()).filter(c => c);
            const position = document.getElementById('batchPosition').value;
            const template = document.getElementById('batchTemplate').value;
            
            if (companies.length === 0 || !position) {
                alert('Bitte füllen Sie alle Felder aus.');
                return;
            }
            
            // Close modal
            document.querySelector('.modal').remove();
            
            // Show progress
            showBatchProgress(companies.length);
            
            // Create applications
            companies.forEach((company, index) => {
                setTimeout(() => {
                    const coverLetter = generateCoverLetterByStyle(template, company, position);
                    
                    const application = {
                        id: Date.now() + index,
                        company: company,
                        position: position,
                        status: 'In Bearbeitung',
                        coverLetter: coverLetter,
                        createdAt: new Date().toISOString(),
                        notes: `Batch-erstellt mit ${template} Template`
                    };
                    
                    applicationsManager.applications.push(application);
                    applicationsManager.saveApplications();
                    
                    updateBatchProgress(index + 1, companies.length);
                    
                    if (index === companies.length - 1) {
                        setTimeout(() => {
                            applicationsManager.renderApplications();
                            showBatchSuccess(companies.length);
                        }, 500);
                    }
                }, index * 1000);
            });
        }

        function showBatchProgress(total) {
            const progressModal = document.createElement('div');
            progressModal.className = 'modal';
            progressModal.style.display = 'block';
            progressModal.id = 'batchProgress';
            progressModal.innerHTML = `
                <div class="modal-content" style="max-width: 400px;">
                    <div class="modal-body" style="text-align: center; padding: 2rem;">
                        <i class="fas fa-copy fa-3x" style="color: #6366f1; margin-bottom: 1rem;"></i>
                        <h3>Erstelle ${total} Bewerbungen...</h3>
                        <p id="batchProgressText">Vorbereitung...</p>
                        <div class="progress-bar">
                            <div class="progress-fill" id="batchProgressFill"></div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(progressModal);
        }

        function updateBatchProgress(current, total) {
            const progressText = document.getElementById('batchProgressText');
            const progressFill = document.getElementById('batchProgressFill');
            
            if (progressText) {
                progressText.textContent = `Erstelle Bewerbung ${current} von ${total}...`;
            }
            
            if (progressFill) {
                progressFill.style.width = `${(current / total) * 100}%`;
            }
        }

        function showBatchSuccess(count) {
            const progressModal = document.getElementById('batchProgress');
            if (progressModal) {
                progressModal.remove();
            }
            
            const notification = document.createElement('div');
            notification.className = 'workflow-notification';
            notification.innerHTML = `
                <div class="notification-content">
                    <i class="fas fa-check-circle"></i>
                    <div class="notification-text">
                        ✅ ${count} Bewerbungen erfolgreich erstellt!<br><br>
                        🚀 Alle Bewerbungen sind bereit für:<br>
                        • Anpassungen im Designer<br>
                        • HR-Links generieren<br>
                        • Status-Updates<br>
                        • Follow-ups planen
                    </div>
                    <button class="notification-close" onclick="this.parentElement.parentElement.remove()">&times;</button>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 8000);
        }

        // Initialize advanced features when page loads
        setTimeout(() => {
            initializeAutoSave();
            
            // Add smart templates button to designer
            const coverLetterTab = document.querySelector('[onclick="switchTab(\'coverLetter\')"]');
            if (coverLetterTab) {
                const smartTemplatesBtn = document.createElement('button');
                smartTemplatesBtn.className = 'btn btn-secondary';
                smartTemplatesBtn.innerHTML = '<i class="fas fa-magic"></i> Smart Templates';
                smartTemplatesBtn.onclick = showSmartTemplates;
                smartTemplatesBtn.style.marginLeft = '1rem';
                coverLetterTab.parentElement.appendChild(smartTemplatesBtn);
            }
        }, 2000);
    </script>
</body>
</html>
