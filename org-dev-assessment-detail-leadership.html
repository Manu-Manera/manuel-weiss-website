<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leadership & Führung - Organisationsentwicklung Assessment - Manuel Weiss</title>
    
    <!-- Meta Tags -->
    <meta name="description" content="Detaillierte Bewertung der leadership & führung für Organisationsentwicklung.">
    <meta name="keywords" content="Leadership, Führung, Management, Organisationsentwicklung">
    <meta name="author" content="Manuel Weiss">
    
    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Custom Styles -->
    <link rel="stylesheet" href="css/ki-assessment-detail.css">
    <style>
        .detail-header {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        
        .criterion-icon {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        
        .detail-slider::-webkit-slider-thumb {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        
        .detail-slider::-moz-range-thumb {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        
        .sub-criterion-slider::-webkit-slider-thumb {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        
        .sub-criterion-slider::-moz-range-thumb {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        
        .slider-value-display {
            color: #d97706;
        }
        
        .sub-criterion-value {
            color: #d97706;
        }
        
        .criterion-average-value {
            color: #d97706;
        }
        
        .aggregated-score {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        
        .save-button {
            color: #d97706;
        }
        
        .criterion-examples {
            border-left: 4px solid #f59e0b;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <img src="manuel-weiss-photo.svg" alt="Manuel Weiss" class="nav-logo">
                <span class="nav-name">Manuel Weiss</span>
            </div>
            <div class="nav-links">
                <a href="index.html">Home</a>
                <a href="hr-transformation.html">HR-Transformation</a>
                <a href="index.html#about">Über mich</a>
                <a href="index.html#contact">Kontakt</a>
            </div>
        </div>
    </nav>
    
    <div class="detail-assessment-container">
        <div class="detail-header">
            <a href="organisationsentwicklung-workflow.html" class="back-button">
                <i class="fas fa-arrow-left"></i>
                Zurück zur Übersicht
            </a>
            <h1><i class="fas fa-crown"></i> Leadership & Führung</h1>
            <p>Bewerten Sie die Führungsqualität und Leadership-Fähigkeiten in Ihrer Organisation. Wissenschaftlich fundierte Bewertung basierend auf modernen Leadership-Prinzipien.</p>
        </div>
        
        <div id="criteriaContainer">
            <!-- Criteria will be dynamically loaded -->
        </div>
        
        <div class="aggregated-score">
            <h3>Gesamtbewertung</h3>
            <div class="score-display">
                <div class="score-circle-large" id="aggregatedScore">1.0</div>
                <div class="score-description" id="scoreDescription">Bewerten Sie die Kriterien, um Ihre Gesamtbewertung zu sehen</div>
            </div>
            <div style="display: flex; gap: 1rem; margin-top: 1.5rem; flex-wrap: wrap;">
                <button class="save-button" onclick="saveAndReturn()" style="flex: 1; min-width: 200px;">
                    <i class="fas fa-save"></i> Bewertung speichern und zurück
                </button>
                <button class="export-button excel" onclick="exportToExcel()" style="background: #217346; color: white; border: none; padding: 1rem 2rem; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; flex: 1; min-width: 150px;">
                    <i class="fas fa-file-excel"></i> Excel Export
                </button>
                <button class="export-button pdf" onclick="exportToPDF()" style="background: #dc3545; color: white; border: none; padding: 1rem 2rem; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; flex: 1; min-width: 150px;">
                    <i class="fas fa-file-pdf"></i> PDF Export
                </button>
            </div>
        </div>
    </div>
    
    <script>
        const leadershipCriteria = [            {
                id: 'visionaryLeadership',
                title: 'Visionäre Führung',
                description: 'Wie visionär ist die Führung?',
                icon: 'fa-lightbulb',
                subCriteria: [
                    { 
                        id: 'clearVision', 
                        title: 'Klare Vision und Strategie',
                        description: 'Gibt es eine klare Vision?',
                        examples: ['Vision dokumentiert', 'Strategische Ausrichtung', 'Langfristige Perspektive', 'Zukunftsbild']
                    },
                    { 
                        id: 'visionCommunication', 
                        title: 'Vision-Kommunikation',
                        description: 'Wird die Vision kommuniziert?',
                        examples: ['Regelmäßige Kommunikation', 'Vision vermittelt', 'Verständlichkeit', 'Engagement']
                    },
                    { 
                        id: 'strategicThinking', 
                        title: 'Strategisches Denken',
                        description: 'Gibt es strategisches Denken?',
                        examples: ['Big Picture', 'Strategische Planung', 'Zukunftsorientierung', 'Systemdenken']
                    },
                    { 
                        id: 'futureOrientation', 
                        title: 'Zukunftsorientierung',
                        description: 'Ist die Führung zukunftsorientiert?',
                        examples: ['Trend-Monitoring', 'Zukunftsszenarien', 'Vorausschau', 'Strategische Vorausschau']
                    },
                    { 
                        id: 'inspirationalLeadership', 
                        title: 'Inspirierende Führung',
                        description: 'Ist die Führung inspirierend?',
                        examples: ['Motivation', 'Inspiration', 'Begeisterung', 'Enthusiasmus']
                    }
                ]
            },
            {
                id: 'transformationalLeadership',
                title: 'Transformative Führung',
                description: 'Wie transformativ ist die Führung?',
                icon: 'fa-sync-alt',
                subCriteria: [
                    { 
                        id: 'changeLeadership', 
                        title: 'Change Leadership',
                        description: 'Führt die Führung Veränderungen?',
                        examples: ['Change Management', 'Transformation', 'Wandel', 'Innovation']
                    },
                    { 
                        id: 'innovationLeadership', 
                        title: 'Innovations-Führung',
                        description: 'Fördert die Führung Innovation?',
                        examples: ['Innovation', 'Kreativität', 'Experimente', 'Neue Ideen']
                    },
                    { 
                        id: 'digitalLeadership', 
                        title: 'Digitale Führung',
                        description: 'Ist die Führung digital?',
                        examples: ['Digital Mindset', 'Tech-Affinität', 'Digitale Transformation', 'Digital Literacy']
                    },
                    { 
                        id: 'agileLeadership', 
                        title: 'Agile Führung',
                        description: 'Ist die Führung agil?',
                        examples: ['Agilität', 'Flexibilität', 'Anpassungsfähigkeit', 'Schnelle Reaktion']
                    },
                    { 
                        id: 'culturalTransformation', 
                        title: 'Kulturelle Transformation',
                        description: 'Führt die Führung kulturelle Transformation?',
                        examples: ['Kulturwandel', 'Werte', 'Kulturelle Entwicklung', 'Change']
                    }
                ]
            },
            {
                id: 'servantLeadership',
                title: 'Servant Leadership',
                description: 'Wie stark ist Servant Leadership?',
                icon: 'fa-hands-helping',
                subCriteria: [
                    { 
                        id: 'teamSupport', 
                        title: 'Team-Unterstützung',
                        description: 'Unterstützt die Führung Teams?',
                        examples: ['Support', 'Hilfe', 'Unterstützung', 'Ressourcen']
                    },
                    { 
                        id: 'empowerment', 
                        title: 'Empowerment und Delegation',
                        description: 'Gibt es Empowerment?',
                        examples: ['Delegation', 'Verantwortung', 'Autonomie', 'Selbstbestimmung']
                    },
                    { 
                        id: 'developmentFocus', 
                        title: 'Entwicklungsfokus',
                        description: 'Fokussiert die Führung auf Entwicklung?',
                        examples: ['Entwicklung', 'Förderung', 'Wachstum', 'Potenzial']
                    },
                    { 
                        id: 'humility', 
                        title: 'Bescheidenheit und Demut',
                        description: 'Gibt es Bescheidenheit?',
                        examples: ['Demut', 'Bescheidenheit', 'Lernbereitschaft', 'Offenheit']
                    },
                    { 
                        id: 'serviceOrientation', 
                        title: 'Service-Orientierung',
                        description: 'Ist die Führung service-orientiert?',
                        examples: ['Service', 'Kundenfokus', 'Orientierung', 'Wertschöpfung']
                    }
                ]
            },
            {
                id: 'emotionalIntelligence',
                title: 'Emotionale Intelligenz',
                description: 'Wie stark ist die emotionale Intelligenz?',
                icon: 'fa-heart',
                subCriteria: [
                    { 
                        id: 'selfAwareness', 
                        title: 'Selbstbewusstsein',
                        description: 'Gibt es Selbstbewusstsein?',
                        examples: ['Selbsterkenntnis', 'Reflexion', 'Bewusstsein', 'Selbstreflexion']
                    },
                    { 
                        id: 'empathy', 
                        title: 'Empathie und Verständnis',
                        description: 'Gibt es Empathie?',
                        examples: ['Empathie', 'Verständnis', 'Mitgefühl', 'Emotionale Verbindung']
                    },
                    { 
                        id: 'socialSkills', 
                        title: 'Soziale Kompetenzen',
                        description: 'Gibt es soziale Kompetenzen?',
                        examples: ['Kommunikation', 'Beziehungen', 'Interaktion', 'Netzwerken']
                    },
                    { 
                        id: 'selfRegulation', 
                        title: 'Selbstregulation',
                        description: 'Gibt es Selbstregulation?',
                        examples: ['Selbstkontrolle', 'Emotionsregulation', 'Balance', 'Gelassenheit']
                    },
                    { 
                        id: 'motivation', 
                        title: 'Motivation und Antrieb',
                        description: 'Gibt es Motivation?',
                        examples: ['Antrieb', 'Motivation', 'Enthusiasmus', 'Leidenschaft']
                    }
                ]
            },
            {
                id: 'coachingMentoring',
                title: 'Coaching & Mentoring',
                description: 'Wie gut ist Coaching und Mentoring?',
                icon: 'fa-user-graduate',
                subCriteria: [
                    { 
                        id: 'coachingCulture', 
                        title: 'Coaching-Kultur',
                        description: 'Gibt es eine Coaching-Kultur?',
                        examples: ['Coaching', 'Entwicklung', 'Förderung', 'Unterstützung']
                    },
                    { 
                        id: 'mentoringPrograms', 
                        title: 'Mentoring-Programme',
                        description: 'Gibt es Mentoring-Programme?',
                        examples: ['Mentoring', 'Programme', 'Partnerschaften', 'Beziehungen']
                    },
                    { 
                        id: 'feedbackCulture', 
                        title: 'Feedback-Kultur',
                        description: 'Gibt es eine Feedback-Kultur?',
                        examples: ['Feedback', 'Rückmeldung', 'Kommunikation', 'Konstruktive Kritik']
                    },
                    { 
                        id: 'developmentPlans', 
                        title: 'Entwicklungspläne',
                        description: 'Gibt es Entwicklungspläne?',
                        examples: ['Pläne', 'Ziele', 'Entwicklung', 'Roadmaps']
                    },
                    { 
                        id: 'learningSupport', 
                        title: 'Lernunterstützung',
                        description: 'Gibt es Lernunterstützung?',
                        examples: ['Support', 'Ressourcen', 'Möglichkeiten', 'Förderung']
                    }
                ]
            },
            {
                id: 'decisionMaking',
                title: 'Entscheidungsfindung',
                description: 'Wie gut ist die Entscheidungsfindung?',
                icon: 'fa-gavel',
                subCriteria: [
                    { 
                        id: 'dataDriven', 
                        title: 'Datenbasierte Entscheidungen',
                        description: 'Werden Entscheidungen datenbasiert getroffen?',
                        examples: ['Daten', 'Analytics', 'Fakten', 'Evidence-Based']
                    },
                    { 
                        id: 'decisionSpeed', 
                        title: 'Entscheidungsgeschwindigkeit',
                        description: 'Wie schnell werden Entscheidungen getroffen?',
                        examples: ['Schnelligkeit', 'Effizienz', 'Zeit', 'Agilität']
                    },
                    { 
                        id: 'decisionQuality', 
                        title: 'Entscheidungsqualität',
                        description: 'Wie gut sind die Entscheidungen?',
                        examples: ['Qualität', 'Ergebnisse', 'Wirksamkeit', 'Impact']
                    },
                    { 
                        id: 'inclusiveDecisions', 
                        title: 'Inklusive Entscheidungsfindung',
                        description: 'Werden Entscheidungen inklusiv getroffen?',
                        examples: ['Einbindung', 'Partizipation', 'Konsens', 'Beteiligung']
                    },
                    { 
                        id: 'decisionTransparency', 
                        title: 'Entscheidungstransparenz',
                        description: 'Sind Entscheidungen transparent?',
                        examples: ['Transparenz', 'Kommunikation', 'Nachvollziehbarkeit', 'Offenheit']
                    }
                ]
            },
            {
                id: 'communicationLeadership',
                title: 'Kommunikations-Führung',
                description: 'Wie gut ist die Kommunikations-Führung?',
                icon: 'fa-comments',
                subCriteria: [
                    { 
                        id: 'openCommunication', 
                        title: 'Offene Kommunikation',
                        description: 'Gibt es offene Kommunikation?',
                        examples: ['Offenheit', 'Transparenz', 'Kommunikation', 'Dialog']
                    },
                    { 
                        id: 'regularUpdates', 
                        title: 'Regelmäßige Updates',
                        description: 'Gibt es regelmäßige Updates?',
                        examples: ['Updates', 'Information', 'Kommunikation', 'Newsletter']
                    },
                    { 
                        id: 'activeListening', 
                        title: 'Aktives Zuhören',
                        description: 'Gibt es aktives Zuhören?',
                        examples: ['Zuhören', 'Verständnis', 'Aufmerksamkeit', 'Empathie']
                    },
                    { 
                        id: 'clearMessages', 
                        title: 'Klare Botschaften',
                        description: 'Sind die Botschaften klar?',
                        examples: ['Klarheit', 'Verständlichkeit', 'Präzision', 'Eindeutigkeit']
                    },
                    { 
                        id: 'twoWayCommunication', 
                        title: 'Zwei-Wege-Kommunikation',
                        description: 'Gibt es Zwei-Wege-Kommunikation?',
                        examples: ['Dialog', 'Austausch', 'Interaktion', 'Feedback']
                    }
                ]
            },
            {
                id: 'teamLeadership',
                title: 'Team-Führung',
                description: 'Wie gut ist die Team-Führung?',
                icon: 'fa-users',
                subCriteria: [
                    { 
                        id: 'teamBuilding', 
                        title: 'Team-Building',
                        description: 'Gibt es Team-Building?',
                        examples: ['Team-Building', 'Zusammenhalt', 'Gemeinschaft', 'Kohäsion']
                    },
                    { 
                        id: 'conflictManagement', 
                        title: 'Konfliktmanagement',
                        description: 'Gibt es Konfliktmanagement?',
                        examples: ['Konflikte', 'Lösungen', 'Mediation', 'Konfliktlösung']
                    },
                    { 
                        id: 'teamPerformance', 
                        title: 'Team-Performance',
                        description: 'Wie gut ist die Team-Performance?',
                        examples: ['Performance', 'Ergebnisse', 'Effektivität', 'Exzellenz']
                    },
                    { 
                        id: 'teamDevelopment', 
                        title: 'Team-Entwicklung',
                        description: 'Gibt es Team-Entwicklung?',
                        examples: ['Entwicklung', 'Wachstum', 'Verbesserung', 'Lernen']
                    },
                    { 
                        id: 'teamRecognition', 
                        title: 'Team-Anerkennung',
                        description: 'Gibt es Team-Anerkennung?',
                        examples: ['Anerkennung', 'Wertschätzung', 'Recognition', 'Appreciation']
                    }
                ]
            },
            {
                id: 'ethicalLeadership',
                title: 'Ethische Führung',
                description: 'Wie ethisch ist die Führung?',
                icon: 'fa-balance-scale',
                subCriteria: [
                    { 
                        id: 'ethicalStandards', 
                        title: 'Ethische Standards',
                        description: 'Gibt es ethische Standards?',
                        examples: ['Standards', 'Werte', 'Prinzipien', 'Code of Conduct']
                    },
                    { 
                        id: 'integrity', 
                        title: 'Integrität und Ehrlichkeit',
                        description: 'Gibt es Integrität?',
                        examples: ['Integrität', 'Ehrlichkeit', 'Vertrauen', 'Glaubwürdigkeit']
                    },
                    { 
                        id: 'fairness', 
                        title: 'Fairness und Gerechtigkeit',
                        description: 'Gibt es Fairness?',
                        examples: ['Fairness', 'Gerechtigkeit', 'Gleichbehandlung', 'Equity']
                    },
                    { 
                        id: 'responsibility', 
                        title: 'Verantwortung und Accountability',
                        description: 'Gibt es Verantwortung?',
                        examples: ['Verantwortung', 'Accountability', 'Commitment', 'Ownership']
                    },
                    { 
                        id: 'sustainability', 
                        title: 'Nachhaltigkeit und Verantwortung',
                        description: 'Gibt es Nachhaltigkeit?',
                        examples: ['Nachhaltigkeit', 'Verantwortung', 'Zukunftsfähigkeit', 'ESG']
                    }
                ]
            },
            {
                id: 'leadershipDevelopment',
                title: 'Leadership-Entwicklung',
                description: 'Wie gut ist die Leadership-Entwicklung?',
                icon: 'fa-chart-line',
                subCriteria: [
                    { 
                        id: 'developmentPrograms', 
                        title: 'Entwicklungsprogramme',
                        description: 'Gibt es Entwicklungsprogramme?',
                        examples: ['Programme', 'Training', 'Bildung', 'Workshops']
                    },
                    { 
                        id: 'successionPlanning', 
                        title: 'Nachfolgeplanung',
                        description: 'Gibt es Nachfolgeplanung?',
                        examples: ['Planung', 'Nachfolge', 'Talent-Pipeline', 'Succession']
                    },
                    { 
                        id: 'leadershipPipeline', 
                        title: 'Leadership-Pipeline',
                        description: 'Gibt es eine Leadership-Pipeline?',
                        examples: ['Pipeline', 'Talent', 'Entwicklung', 'Karrierewege']
                    },
                    { 
                        id: 'leadershipAssessment', 
                        title: 'Leadership-Assessment',
                        description: 'Gibt es Leadership-Assessments?',
                        examples: ['Assessment', 'Bewertung', 'Feedback', '360° Feedback']
                    },
                    { 
                        id: 'continuousLearning', 
                        title: 'Kontinuierliches Lernen',
                        description: 'Gibt es kontinuierliches Lernen?',
                        examples: ['Lernen', 'Entwicklung', 'Wachstum', 'Weiterbildung']
                    }
                ]
            },
            {
                id: 'adaptiveLeadership',
                title: 'Adaptive Führung',
                description: 'Wie adaptiv ist die Führung?',
                icon: 'fa-adjust',
                subCriteria: [
                    { 
                        id: 'flexibility', 
                        title: 'Flexibilität und Anpassungsfähigkeit',
                        description: 'Gibt es Flexibilität?',
                        examples: ['Flexibilität', 'Anpassung', 'Agilität', 'Resilienz']
                    },
                    { 
                        id: 'resilience', 
                        title: 'Resilienz und Widerstandsfähigkeit',
                        description: 'Gibt es Resilienz?',
                        examples: ['Resilienz', 'Widerstandsfähigkeit', 'Stärke', 'Robustheit']
                    },
                    { 
                        id: 'learningFromFailure', 
                        title: 'Lernen aus Fehlern',
                        description: 'Wird aus Fehlern gelernt?',
                        examples: ['Fehleranalyse', 'Lernen', 'Verbesserung', 'Lessons Learned']
                    },
                    { 
                        id: 'changeReadiness', 
                        title: 'Change-Readiness',
                        description: 'Ist die Führung change-ready?',
                        examples: ['Change', 'Anpassung', 'Wandel', 'Transformation']
                    },
                    { 
                        id: 'experimentation', 
                        title: 'Experimentierfreude',
                        description: 'Gibt es Experimentierfreude?',
                        examples: ['Experimente', 'Innovation', 'Kreativität', 'Pilot-Projekte']
                    }
                ]
            }
        ];
        
        let assessmentData = {};
        let assessmentExporter = null;
        
        function initializeAssessment() {
            // Load saved data
            const saved = localStorage.getItem('orgDevDetailAssessments');
            if (saved) {
                const allAssessments = JSON.parse(saved);
                if (allAssessments.leadership) {
                    assessmentData = allAssessments.leadership;
                }
            }
            
            // Initialize assessment data structure
            leadershipCriteria.forEach(criterion => {
                if (!assessmentData[criterion.id]) {
                    assessmentData[criterion.id] = {};
                }
                criterion.subCriteria.forEach(subCriterion => {
                    if (!assessmentData[criterion.id][subCriterion.id]) {
                        assessmentData[criterion.id][subCriterion.id] = 1;
                    }
                });
            });
            
            renderCriteria();
            updateAggregatedScore();
            assessmentExporter = new AssessmentExporter();
        }
        
        function renderCriteria() {
            const container = document.getElementById('criteriaContainer');
            container.innerHTML = '';
            
            leadershipCriteria.forEach(criterion => {
                const criterionCard = document.createElement('div');
                criterionCard.className = 'criterion-card';
                
                const averageScore = calculateCriterionAverage(criterion.id);
                
                criterionCard.innerHTML = `
                    <div class="criterion-header">
                        <div class="criterion-icon">
                            <i class="fas ${criterion.icon}"></i>
                        </div>
                        <div class="criterion-title-section">
                            <h3 class="criterion-title">${criterion.title}</h3>
                            <p class="criterion-description">${criterion.description}</p>
                        </div>
                        <div class="criterion-average">
                            <div class="criterion-average-value">${averageScore.toFixed(1)}</div>
                            <div style="font-size: 0.75rem; color: #6b7280;">Durchschnitt</div>
                        </div>
                    </div>
                    
                    <div class="sub-criteria-container">
                        ${criterion.subCriteria.map(subCriterion => {
                            const value = assessmentData[criterion.id][subCriterion.id] || 1;
                            return `
                                <div class="sub-criterion-item">
                                    <div class="sub-criterion-label">
                                        <h4>${subCriterion.title}</h4>
                                        <p>${subCriterion.description}</p>
                                        <div class="criterion-examples">
                                            <strong>Beispiele:</strong>
                                            <ul>
                                                ${subCriterion.examples.map(ex => `<li>${ex}</li>`).join('')}
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="sub-criterion-slider-wrapper">
                                        <input type="range" min="1" max="5" value="${value}" 
                                               class="sub-criterion-slider" 
                                               id="${criterion.id}_${subCriterion.id}"
                                               oninput="updateSubCriterionValue('${criterion.id}', '${subCriterion.id}', this.value)">
                                        <div class="sub-criterion-value">${value}</div>
                                        <div class="sub-criterion-scale">
                                            <span>1</span>
                                            <span>2</span>
                                            <span>3</span>
                                            <span>4</span>
                                            <span>5</span>
                                        </div>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
                
                container.appendChild(criterionCard);
            });
        }
        
        function updateSubCriterionValue(criterionId, subCriterionId, value) {
            if (!assessmentData[criterionId]) {
                assessmentData[criterionId] = {};
            }
            assessmentData[criterionId][subCriterionId] = parseInt(value);
            
            const valueDisplay = document.querySelector(`#${criterionId}_${subCriterionId}`).nextElementSibling;
            if (valueDisplay) {
                valueDisplay.textContent = value;
            }
            
            updateCriterionAverage(criterionId);
            updateAggregatedScore();
            saveAssessment();
        }
        
        function calculateCriterionAverage(criterionId) {
            const criterion = leadershipCriteria.find(c => c.id === criterionId);
            if (!criterion || !assessmentData[criterionId]) return 1.0;
            
            const values = criterion.subCriteria.map(sub => 
                assessmentData[criterionId][sub.id] || 1
            );
            const sum = values.reduce((acc, val) => acc + val, 0);
            return sum / values.length;
        }
        
        function updateCriterionAverage(criterionId) {
            const average = calculateCriterionAverage(criterionId);
            const criterionCard = document.querySelector(`.criterion-card:has(#${criterionId}_${leadershipCriteria.find(c => c.id === criterionId).subCriteria[0].id})`);
            if (criterionCard) {
                const averageDisplay = criterionCard.querySelector('.criterion-average-value');
                if (averageDisplay) {
                    averageDisplay.textContent = average.toFixed(1);
                }
            }
        }
        
        function updateAggregatedScore() {
            const averages = leadershipCriteria.map(c => calculateCriterionAverage(c.id));
            const overallAverage = averages.reduce((acc, val) => acc + val, 0) / averages.length;
            
            const scoreDisplay = document.getElementById('aggregatedScore');
            const descriptionDisplay = document.getElementById('scoreDescription');
            
            if (scoreDisplay) {
                scoreDisplay.textContent = overallAverage.toFixed(1);
            }
            
            if (descriptionDisplay) {
                let description = '';
                if (overallAverage <= 1.5) {
                    description = 'Schwache Führung - Erhebliche Verbesserung der Leadership-Fähigkeiten nötig';
                } else if (overallAverage <= 2.5) {
                    description = 'Teilweise entwickelte Führung - Leadership-Verbesserungen erforderlich';
                } else if (overallAverage <= 3.5) {
                    description = 'Gute Führung - Weitere Leadership-Entwicklung möglich';
                } else if (overallAverage <= 4.5) {
                    description = 'Starke Führung - Kleine Verbesserungen möglich';
                } else {
                    description = 'Hervorragende Führung - Exzellente Leadership-Fähigkeiten';
                }
                descriptionDisplay.textContent = description;
            }
        }
        
        function saveAssessment() {
            const aggregated = parseFloat(leadershipCriteria.map(c => calculateCriterionAverage(c.id)).reduce((acc, val) => acc + val, 0) / leadershipCriteria.length).toFixed(1);
            const criterionAverages = leadershipCriteria.map(criterion => ({
                criterionId: criterion.id,
                average: calculateCriterionAverage(criterion.id)
            }));
            
            const allAssessments = JSON.parse(localStorage.getItem('orgDevDetailAssessments') || '{}');
            allAssessments.leadership = {
                aggregated: parseFloat(aggregated),
                details: assessmentData,
                criteria: assessmentData, // Legacy support
                criterionAverages: criterionAverages,
                timestamp: new Date().toISOString()
            };
            localStorage.setItem('orgDevDetailAssessments', JSON.stringify(allAssessments));
        }
        
        function saveAndReturn() {
            const aggregated = parseFloat(leadershipCriteria.map(c => calculateCriterionAverage(c.id)).reduce((acc, val) => acc + val, 0) / leadershipCriteria.length).toFixed(1);
            
            // Save detailed assessment
            saveAssessment();
            
            // Also update main workflow (analog zu HR-Strategieentwicklung)
            let workflowData = JSON.parse(localStorage.getItem('orgDevWorkflow') || '{}');
            if (!workflowData.orgDevMaturityData) workflowData.orgDevMaturityData = {};
            workflowData.orgDevMaturityData.leadership = parseFloat(aggregated);
            localStorage.setItem('orgDevWorkflow', JSON.stringify(workflowData));
            
            window.location.href = 'organisationsentwicklung-workflow.html';
        }
        
        async function exportToExcel() {
            if (!assessmentExporter) {
                assessmentExporter = new AssessmentExporter();
                await new Promise(resolve => setTimeout(resolve, 1000));
            }
            const data = prepareExportData();
            await assessmentExporter.exportToExcel(data, `Organisationsentwicklung-Leadership-&-Führung-Assessment-${new Date().toISOString().split('T')[0]}`);
        }
        
        async function exportToPDF() {
            if (!assessmentExporter) {
                assessmentExporter = new AssessmentExporter();
                await new Promise(resolve => setTimeout(resolve, 1000));
            }
            const data = prepareExportData();
            await assessmentExporter.exportToPDF(data, `Organisationsentwicklung-Leadership-&-Führung-Assessment-${new Date().toISOString().split('T')[0]}`);
        }
        
        function prepareExportData() {
            const aggregated = parseFloat(leadershipCriteria.map(c => calculateCriterionAverage(c.id)).reduce((acc, val) => acc + val, 0) / leadershipCriteria.length).toFixed(1);
            
            return {
                dimension: 'leadership',
                dimensionName: 'Leadership & Führung',
                overall: parseFloat(aggregated),
                criteria: leadershipCriteria.map(criterion => ({
                    id: criterion.id,
                    title: criterion.title,
                    description: criterion.description,
                    average: calculateCriterionAverage(criterion.id),
                    subCriteria: criterion.subCriteria.map(sub => ({
                        id: sub.id,
                        title: sub.title,
                        description: sub.description,
                        examples: sub.examples,
                        score: assessmentData[criterion.id][sub.id] || 1
                    }))
                })),
                timestamp: new Date().toISOString()
            };
        }
        
        // Initialize on load
        document.addEventListener('DOMContentLoaded', initializeAssessment);
    </script>
    
    <!-- Assessment Export Script -->
    <script src="js/assessment-export.js"></script>
</body>
</html>
